@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom components and utilities */
@layer components {
  /* Spinner animation */
  .spinner {
    @apply w-4 h-4 border-2 border-transparent border-t-blue-500 rounded-full animate-spin;
  }

  /* Method badges with proper colors */
  .method-badge {
    @apply px-2 py-1 rounded text-xs font-semibold uppercase text-white min-w-[40px] text-center;
  }

  .method-badge.get {
    @apply bg-green-600;
  }

  .method-badge.post {
    @apply bg-blue-600;
  }

  .method-badge.put {
    @apply bg-orange-600;
  }

  .method-badge.patch {
    @apply bg-purple-600;
  }

  .method-badge.delete {
    @apply bg-red-600;
  }

  /* Change indicators */
  .change-indicator {
    @apply ml-2 px-2 py-1 rounded text-xs font-bold;
  }

  .change-indicator.change-added {
    @apply bg-green-900/20 text-green-400 dark:bg-green-500/20 dark:text-green-300;
  }

  .change-indicator.change-removed {
    @apply bg-red-900/20 text-red-400 dark:bg-red-500/20 dark:text-red-300;
  }

  .change-indicator.change-modified {
    @apply bg-yellow-900/20 text-yellow-400 dark:bg-yellow-500/20 dark:text-yellow-300;
  }

  /* Custom toggle switch */
  .toggle-switch {
    @apply relative w-11 h-6 bg-zinc-600 rounded-full transition-colors duration-200 flex-shrink-0;
  }

  .toggle-switch.checked {
    @apply bg-green-600;
  }

  .toggle-slider {
    @apply absolute top-0.5 left-0.5 w-5 h-5 bg-zinc-400 rounded-full transition-all duration-200;
  }

  .toggle-switch.checked .toggle-slider {
    @apply translate-x-5 bg-white;
  }

  /* File status styles */
  .file-status {
    @apply text-sm px-3 py-2 rounded-md text-center border transition-colors duration-200;
  }

  .file-status.loading {
    @apply bg-yellow-500/10 text-yellow-500 border-yellow-500/30;
  }

  .file-status.success {
    @apply bg-green-500/10 text-green-500 border-green-500/30;
  }

  .file-status.error {
    @apply bg-red-500/10 text-red-500 border-red-500/30;
  }

  /* Export status styles */
  .export-status {
    @apply text-sm px-3 py-2 rounded text-center;
  }

  .export-status.loading {
    @apply bg-yellow-500/10 text-yellow-500 border border-yellow-500/30;
  }

  .export-status.success {
    @apply bg-green-500/10 text-green-500 border border-green-500/30;
  }

  .export-status.error {
    @apply bg-red-500/10 text-red-500 border border-red-500/30;
  }

  .export-status.info {
    @apply text-zinc-500 dark:text-zinc-400;
  }

  /* Stats badges */
  .stat {
    @apply px-3 py-1 rounded-full text-xs font-semibold;
  }

  .stat.added {
    @apply bg-green-500/15 text-green-500;
  }

  /* Diff viewer layout helpers */
  .diff-viewer .diff-header {
    @apply flex items-center justify-between mb-4; /* clearer gap before sections */
  }
  .diff-viewer .diff-stats {
    @apply flex gap-2; /* spacing between +/âˆ’/~ tags */
  }
  .diff-viewer,
  .diff-viewer .diff-content {
    min-width: 0; /* allow flex/grid to shrink this container */
  }
  .diff-viewer .diff-content {
    @apply overflow-auto; /* prevent overflow outside viewport */
  }

  .stat.removed {
    @apply bg-red-500/15 text-red-500;
  }

  .stat.modified {
    @apply bg-yellow-500/15 text-yellow-500;
  }

  /* Dark mode overrides for diff2html */
  .dark .d2h-wrapper {
    @apply bg-transparent;
  }

  .dark .d2h-file-header {
    @apply bg-zinc-800 border-zinc-700 text-zinc-100;
  }

  .dark .d2h-file-header:hover {
    @apply bg-zinc-700;
  }

  .dark .d2h-code-line {
    @apply bg-zinc-900 border-zinc-700;
  }
  
  /* Unchanged lines should also be dark */
  .dark .d2h-code-line-ctn {
    @apply bg-zinc-900 text-zinc-300;
  }
  
  .dark .d2h-code-line-prefix {
    @apply bg-zinc-800 text-zinc-500;
  }
  
  .dark .d2h-code-linenumber {
    @apply bg-zinc-800 text-zinc-500;
  }
  
  .dark .d2h-diff-tbody tr {
    @apply bg-zinc-900;
  }
  
  .dark .d2h-diff-tbody tr:hover {
    @apply bg-zinc-800;
  }
  
  .dark .d2h-file-diff {
    @apply bg-zinc-900;
  }
  
  .dark .d2h-file-side-diff {
    @apply bg-zinc-900;
  }

  .dark .d2h-ins, .dark tr.d2h-ins td {
    @apply bg-green-500/20 border-green-500 text-green-300;
  }

  .dark .d2h-del, .dark tr.d2h-del td {
    @apply bg-red-500/25 border-red-500 text-red-300;
  }
  
  .dark .d2h-ins .d2h-code-line {
    @apply bg-transparent;
  }
  
  .dark .d2h-del .d2h-code-line {
    @apply bg-transparent;
  }

  .dark .d2h-info {
    @apply bg-blue-500/15 border-blue-500 text-blue-400;
  }
  
  /* Context lines (unchanged code) */
  .dark .d2h-cntx {
    @apply bg-zinc-900 text-zinc-400;
  }
  
  .dark .d2h-cntx .d2h-code-line {
    @apply bg-transparent;
  }

  /* Light mode overrides for diff2html */
  .d2h-wrapper {
    @apply bg-transparent;
    max-width: 100%;
    overflow-x: auto; /* prevent content growing page width */
  }
  
  .d2h-file-header {
    @apply bg-zinc-100 border-zinc-300 text-zinc-900;
  }

  .d2h-file-header:hover {
    @apply bg-zinc-200;
  }

  .d2h-code-line {
    @apply bg-transparent border-zinc-300;
  }

  /* Preserve indentation and monospace rendering */
  .d2h-code-line,
  .d2h-code-line-ctn {
    white-space: pre; /* keep leading spaces */
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  }

  /* Slimmer left number/prefix column for simple lists */
  .d2h-code-linenumber {
    width: 64px !important;   /* extra room to avoid crowding */
    min-width: 64px !important;
    text-align: right;
    padding-right: 6px;
  }

  .d2h-ins, tr.d2h-ins td {
    @apply bg-green-100 border-green-400 text-green-900;
  }

  .d2h-del, tr.d2h-del td {
    @apply bg-red-100 border-red-400 text-red-900;
  }
  
  .d2h-ins .d2h-code-line {
    @apply bg-transparent;
  }
  
  .d2h-del .d2h-code-line {
    @apply bg-transparent;
  }

  .d2h-info {
    @apply bg-blue-100 border-blue-400 text-blue-600;
  }
  
  /* Context lines (unchanged code) in light mode */
  .d2h-cntx {
    @apply bg-transparent text-zinc-600;
  }
  
  .d2h-cntx .d2h-code-line {
    @apply bg-transparent;
  }
  
  /* Light mode file diff containers */
  .d2h-file-diff {
    @apply bg-transparent;
    overflow-x: auto; /* contain long lines horizontally */
    max-width: 100%;
  }

  /* Ensure diff table scrolls inside diff area instead of growing the page */
  .right-panel,
  .right-panel .panel-content,
  #diff-container {
    min-width: 0; /* critical for flex/grid overflow control */
  }
  .right-panel .panel-content {
    overflow-x: auto;
  }
  .d2h-diff-table {
    width: max-content; /* allow horizontal scroll for long lines */
  }
  .d2h-code-line-ctn {
    max-width: 100%;
  }
  
  .d2h-file-side-diff {
    @apply bg-transparent;
  }
  
  .d2h-diff-tbody tr {
    @apply bg-transparent;
  }
  
  .d2h-code-line-ctn {
    @apply bg-transparent;
  }

  /* Ensure both old/new line number cells are visible in our custom table */
  .d2h-diff-table td.d2h-code-linenumber {
    display: table-cell !important;
    visibility: visible !important;
    vertical-align: top;
    border-right: 1px solid rgba(0,0,0,0.08); /* subtle separator */
  }
  .dark .d2h-diff-table td.d2h-code-linenumber {
    border-right: 1px solid rgba(255,255,255,0.12);
  }

  /* Subtle zebra striping for readability (overlays on base colors) */
  /* Zebra striping only on neutral cells (not added/removed/info) */
  .d2h-diff-tbody tr:nth-child(even) td:not(.d2h-ins):not(.d2h-del):not(.d2h-info) {
    background-color: rgba(0, 0, 0, 0.02);
  }
  .dark .d2h-diff-tbody tr:nth-child(even) td:not(.d2h-ins):not(.d2h-del):not(.d2h-info) {
    background-color: rgba(255, 255, 255, 0.04);
  }
  /* keep code content transparent over td background */
  .d2h-diff-tbody tr:nth-child(even) td:not(.d2h-ins):not(.d2h-del):not(.d2h-info) .d2h-code-line,
  .dark .d2h-diff-tbody tr:nth-child(even) td:not(.d2h-ins):not(.d2h-del):not(.d2h-info) .d2h-code-line {
    background: transparent;
  }

  /* Modified endpoint header */
  .modified-endpoint-header {
    @apply bg-yellow-50 dark:bg-yellow-900/20 p-3 my-2 border-l-4 border-yellow-500 text-zinc-900 dark:text-zinc-100;
  }
  
  .path-hierarchy {
    @apply text-zinc-500 dark:text-zinc-400 text-sm;
  }
  
  .endpoint-info {
    @apply text-zinc-600 dark:text-zinc-300 font-mono text-sm opacity-70;
  }
  
  .change-summary {
    @apply text-yellow-700 dark:text-yellow-400 text-sm font-semibold ml-2;
  }
  
  /* Diff context controls */
  .d2h-context-control {
    @apply cursor-pointer select-none hover:bg-zinc-100 dark:hover:bg-zinc-800;
  }

  .d2h-context-control.expanded + .d2h-context-hidden {
    display: table-row !important;
  }

  .d2h-context-hidden {
    display: none;
  }
}

/* Custom utilities */
@layer utilities {
  html, body, #app { overflow-x: hidden; }
  .text-gradient {
    background: linear-gradient(135deg, #3b82f6 0%, #7c3aed 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .backdrop-blur-glass {
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }
}
