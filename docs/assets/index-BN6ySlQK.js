(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();class ue{element;onFileLoad;constructor(t,n){const e=document.getElementById(t);if(!e)throw new Error(`Container with id "${t}" not found`);this.element=this.createElement(n),e.appendChild(this.element)}createElement(t){const n=document.createElement("div");n.className="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-xl p-6 transition-all duration-300 hover:border-blue-500 dark:hover:border-blue-400 hover:shadow-lg",n.innerHTML=`
      <div class="flex flex-col gap-4">
        <label class="text-lg font-semibold text-zinc-900 dark:text-zinc-100">${t}</label>
        <input 
          type="file" 
          accept=".json" 
          class="w-full p-6 border-2 border-dashed border-zinc-300 dark:border-zinc-600 rounded-lg bg-zinc-50 dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100 cursor-pointer transition-all duration-300 hover:border-blue-500 dark:hover:border-blue-400 hover:bg-blue-50 dark:hover:bg-blue-950/20 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
        />
        <div class="file-status text-zinc-600 dark:text-zinc-400">No file selected</div>
      </div>
    `;const e=n.querySelector('input[type="file"]'),s=n.querySelector(".file-status");return e.addEventListener("change",i=>{const o=i.target.files?.[0];if(!o){s.textContent="No file selected",s.className="file-status text-zinc-600 dark:text-zinc-400";return}s.textContent=`Loading ${o.name}...`,s.className="file-status loading",this.loadFile(o).then(l=>{s.textContent=`‚úì ${o.name}`,s.className="file-status success",this.onFileLoad?.(l)}).catch(l=>{s.textContent=`‚úó Error: ${l.message}`,s.className="file-status error"})}),n}async loadFile(t){return new Promise((n,e)=>{const s=new FileReader;s.onload=i=>{try{const o=i.target?.result,l=JSON.parse(o);if(!l.info||!l.info.name)throw new Error("Invalid Postman collection format");n(l)}catch{e(new Error("Failed to parse JSON file"))}},s.onerror=()=>{e(new Error("Failed to read file"))},s.readAsText(t)})}onLoad(t){this.onFileLoad=t}}class $e{element;constructor(t){const n=document.getElementById(t);if(!n)throw new Error(`Container with id "${t}" not found`);this.element=this.createElement(),n.appendChild(this.element)}createElement(){const t=document.createElement("div");return t.className="diff-viewer",t.innerHTML=`
      <div class="diff-header">
        <h2>Collection Diff</h2>
        <div class="diff-stats"></div>
      </div>
      <div class="diff-content">
        <div class="diff-placeholder">
          Select two Postman collections to see the differences
        </div>
      </div>
    `,t}showDiff(t){const n=this.element.querySelector(".diff-content"),e=this.element.querySelector(".diff-stats"),s=this.calculateStats(t);e.innerHTML=`
      <a href="#added-section" class="stat added" style="text-decoration: none; cursor: pointer;">+${s.added} added</a>
      <a href="#removed-section" class="stat removed" style="text-decoration: none; cursor: pointer;">-${s.removed} removed</a>
      <a href="#modified-section" class="stat modified" style="text-decoration: none; cursor: pointer;">~${s.modified} modified</a>
    `,n.innerHTML=t.htmlDiff,this.enhanceDiffDisplay(n),e.querySelectorAll("a").forEach(i=>{i.addEventListener("click",o=>{o.preventDefault();const l=document.querySelector(i.getAttribute("href"));l&&l.scrollIntoView({behavior:"smooth",block:"start"})})})}calculateStats(t){const n={added:0,removed:0,modified:0};return t.patches.forEach(e=>{e.added?n.added++:e.removed?n.removed++:e.value.trim()&&n.modified++}),n}enhanceDiffDisplay(t){t.querySelectorAll("code").forEach(e=>{e.classList.contains("enhanced")||(e.classList.add("enhanced"),this.addLineNumbers(e))}),this.addCollapseFeature(t)}addLineNumbers(t){const e=t.innerHTML.split(`
`).map((s,i)=>`<span class="line-number">${i+1}</span>${s}`);t.innerHTML=e.join(`
`)}addCollapseFeature(t){t.querySelectorAll(".d2h-file-wrapper").forEach(e=>{const s=e.querySelector(".d2h-file-header");s&&s.addEventListener("click",()=>{const i=e.querySelector(".d2h-file-diff");i&&i.classList.toggle("collapsed")})})}clear(){const t=this.element.querySelector(".diff-content"),n=this.element.querySelector(".diff-stats");t.innerHTML='<div class="diff-placeholder">Select two Postman collections to see the differences</div>',n.innerHTML=""}}class Le{element;options;tree=[];selectedNode=null;constructor(t,n={}){const e=document.getElementById(t);if(!e)throw new Error(`Container with id "${t}" not found`);this.options={showChangeIndicators:!0,expandAll:!1,...n},this.element=this.createElement(),e.appendChild(this.element)}createElement(){const t=document.createElement("div");return t.className="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg overflow-hidden transition-colors duration-300",t.innerHTML=`
      <div class="bg-zinc-50 dark:bg-zinc-800 border-b border-zinc-200 dark:border-zinc-700 px-4 py-3 flex justify-between items-center transition-colors duration-300">
        <h3 class="font-semibold text-zinc-900 dark:text-zinc-100">Collection Structure</h3>
        <div class="flex gap-2">
          <button class="tree-control-btn px-2 py-1 text-xs bg-transparent border border-zinc-300 dark:border-zinc-600 text-zinc-600 dark:text-zinc-400 rounded hover:bg-zinc-100 dark:hover:bg-zinc-700 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors duration-200" data-action="expand-all" title="Expand All">
            <span class="icon">‚äû</span>
          </button>
          <button class="tree-control-btn px-2 py-1 text-xs bg-transparent border border-zinc-300 dark:border-zinc-600 text-zinc-600 dark:text-zinc-400 rounded hover:bg-zinc-100 dark:hover:bg-zinc-700 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors duration-200" data-action="collapse-all" title="Collapse All">
            <span class="icon">‚äü</span>
          </button>
        </div>
      </div>
      <div class="max-h-96 overflow-y-auto p-2">
        <div class="tree-placeholder text-center text-zinc-500 dark:text-zinc-400 py-8 italic">
          Load collections to see structure
        </div>
      </div>
    `,this.setupEventListeners(t),t}setupEventListeners(t){t.addEventListener("click",n=>{const e=n.target,s=e.closest(".tree-control-btn");if(s){const o=s.dataset.action;o==="expand-all"?this.expandAll():o==="collapse-all"&&this.collapseAll()}const i=e.closest(".tree-node");if(i){const o=i.dataset.nodeId,l=this.findNodeById(o);l&&(e.classList.contains("tree-toggle")?this.toggleNode(l):this.selectNode(l))}})}loadCollection(t,n="diff"){this.tree=this.buildTree(t,n),this.render()}updateWithDiff(t,n){const e=this.flattenItems(t.items),s=this.flattenItems(n.items),i=new Map(e.map(a=>[a.id,a])),o=new Map(s.map(a=>[a.id,a])),l=[];i.forEach((a,f)=>{o.has(f)||l.push({...a,changeType:"removed"})}),o.forEach((a,f)=>{if(!i.has(f))l.push({...a,changeType:"added"});else{const p=i.get(f);if(this.hasItemChanged(p,a)){const C=this.getItemChanges(p,a);l.push({...a,changeType:"modified",changeDetails:C})}}}),this.tree=this.buildTreeFromChangedItems(l,n.info.name),this.render()}buildTreeFromChangedItems(t,n){if(t.length===0)return[{id:"no-changes",name:"No changes detected",type:"collection",expanded:!0}];const e=new Map;t.forEach(a=>{const f=a.parentPath||"";e.has(f)||e.set(f,[]),e.get(f).push(a)});const s=t.filter(a=>a.changeType==="added").length,i=t.filter(a=>a.changeType==="removed").length,o=t.filter(a=>a.changeType==="modified").length,l={id:"changed-items",name:`${n} (+${s} -${i} ~${o})`,type:"collection",expanded:!0,children:[],changeType:"modified"};return e.forEach((a,f)=>{if(f){const p={id:`folder-${f}`,name:f,type:"folder",expanded:!0,children:a.map(C=>this.createTreeNode(C)),changeType:"modified"};l.children.push(p)}else a.forEach(p=>{l.children.push(this.createTreeNode(p))})}),[l]}createTreeNode(t){return{id:t.id,name:t.name,type:t.children?"folder":"request",method:t.method,changeType:t.changeType,changeDetails:t.changeDetails,expanded:!1}}flattenItems(t,n=""){const e=[];return t.forEach(s=>{const i=n?`${n}/${s.name}`:s.name;e.push({...s,path:i,parentPath:n}),s.children&&e.push(...this.flattenItems(s.children,i))}),e}hasItemChanged(t,n){const e=Array.isArray(t.tests)?t.tests.join(`
`):t.tests||"",s=Array.isArray(n.tests)?n.tests.join(`
`):n.tests||"",i=Array.isArray(t.prerequest)?t.prerequest.join(`
`):t.prerequest||"",o=Array.isArray(n.prerequest)?n.prerequest.join(`
`):n.prerequest||"";return t.children&&n.children?e!==s||i!==o:t.method!==n.method||t.url!==n.url||t.body!==n.body||JSON.stringify(t.headers||{})!==JSON.stringify(n.headers||{})||e!==s||i!==o}getItemChanges(t,n){const e=[],s=Array.isArray(t.tests)?t.tests.join(`
`):t.tests||"",i=Array.isArray(n.tests)?n.tests.join(`
`):n.tests||"",o=Array.isArray(t.prerequest)?t.prerequest.join(`
`):t.prerequest||"",l=Array.isArray(n.prerequest)?n.prerequest.join(`
`):n.prerequest||"";return t.url!==n.url&&e.push("URL"),t.method!==n.method&&e.push("Method"),t.body!==n.body&&e.push("Body"),JSON.stringify(t.headers||{})!==JSON.stringify(n.headers||{})&&e.push("Headers"),s!==i&&e.push("Tests"),o!==l&&e.push("Pre-request"),e.join(", ")}buildTree(t,n){return[{id:"collection-"+t.info.name.replace(/[^a-zA-Z0-9]/g,"-"),name:t.info.name,type:"collection",expanded:!0,children:this.buildItemNodes(t.items,n),changeType:n==="diff"?"unchanged":void 0}]}buildItemNodes(t,n){return t.map(e=>({id:e.id,name:e.name,type:e.children?"folder":"request",method:e.method,expanded:this.options.expandAll,children:e.children?this.buildItemNodes(e.children,n):void 0,changeType:n==="diff"?"unchanged":void 0}))}render(){const t=this.element.querySelector(".max-h-96");if(this.tree.length===0){t.innerHTML='<div class="tree-placeholder text-center text-zinc-500 dark:text-zinc-400 py-8 italic">Load collections to see structure</div>';return}t.innerHTML=this.renderNodes(this.tree)}renderNodes(t,n=0){return t.map(e=>this.renderNode(e,n)).join("")}renderNode(t,n){const e=t.children&&t.children.length>0,s=t.expanded,i=t.selected?"bg-blue-100 dark:bg-blue-900/30":"hover:bg-zinc-100 dark:hover:bg-zinc-800",o=n*16;let l="",a="";t.type==="collection"?(l="üìä",a="text-blue-600 dark:text-blue-400"):t.type==="folder"?(l="üìÅ",a="text-zinc-600 dark:text-zinc-400"):t.changeType==="added"?(a="text-green-600 dark:text-green-400",l="‚ûï"):t.changeType==="removed"?(a="text-red-600 dark:text-red-400",l="‚ûñ"):t.changeType==="modified"&&(a="text-yellow-600 dark:text-yellow-400",l="üîÑ");let f="";e&&(f=`<button class="tree-toggle w-4 h-4 flex items-center justify-center text-zinc-500 dark:text-zinc-400 hover:text-zinc-700 dark:hover:text-zinc-200 mr-2 text-xs transition-colors duration-200">${s?"‚ñº":"‚ñ∂"}</button>`);let p="";t.changeDetails&&(p=`<span class="text-xs text-zinc-500 dark:text-zinc-400 ml-2">(${t.changeDetails})</span>`);let C="";t.type==="request"&&t.method&&(C=`<span class="text-xs font-mono text-zinc-600 dark:text-zinc-400 ml-2">[${t.method}]</span>`);let N="";e&&s&&(N=`<div class="border-l border-zinc-200 dark:border-zinc-700 ml-3">${this.renderNodes(t.children,n+1)}</div>`);const c=t.changeType==="added"?"added-section":t.changeType==="removed"?"removed-section":t.changeType==="modified"?"modified-section":"";return`
      <div class="tree-node my-0.5 rounded transition-colors duration-150 ${i}" data-node-id="${t.id}" data-section="${c}">
        <div class="flex items-center py-1 px-2 cursor-pointer min-h-[28px]" style="padding-left: ${o+8}px">
          ${f}
          <span class="mr-2 text-sm flex-shrink-0 ${a}">${l}</span>
          <span class="flex-1 text-zinc-900 dark:text-zinc-100 text-sm truncate">${t.name}</span>
          ${C}
          ${p}
        </div>
        ${N}
      </div>
    `}findNodeById(t){const n=e=>{for(const s of e){if(s.id===t)return s;if(s.children){const i=n(s.children);if(i)return i}}return null};return n(this.tree)}toggleNode(t){t.expanded=!t.expanded,this.render(),this.options.onNodeToggle?.(t)}selectNode(t){let n="";if(t.changeType==="added"?n=`added-${t.id}`:t.changeType==="removed"?n=`removed-${t.id}`:t.changeType==="modified"&&(n=`modified-${t.id}`),n){const e=document.getElementById(n);e&&(e.scrollIntoView({behavior:"smooth",block:"start"}),e.style.backgroundColor="#fbbf24",setTimeout(()=>{e.style.backgroundColor=""},1e3))}this.selectedNode&&(this.selectedNode.selected=!1),t.selected=!0,this.selectedNode=t,this.render(),this.options.onNodeSelect?.(t)}expandAll(){const t=n=>{n.forEach(e=>{e.expanded=!0,e.children&&t(e.children)})};t(this.tree),this.render()}collapseAll(){const t=n=>{n.forEach(e=>{e.expanded=!1,e.children&&t(e.children)})};t(this.tree),this.render()}getSelectedNode(){return this.selectedNode}clear(){this.tree=[],this.selectedNode=null,this.render()}}class Se{element;options;toggleOptions;onOptionsChange;constructor(t,n={}){const e=document.getElementById(t);if(!e)throw new Error(`Container with id "${t}" not found`);this.onOptionsChange=n.onOptionsChange,this.toggleOptions=[{key:"ignoreOrder",label:"Ignore Order",description:"Ignore the order of items when comparing",defaultValue:!1},{key:"ignoreWhitespace",label:"Ignore Whitespace",description:"Normalize whitespace differences",defaultValue:!0},{key:"normalizeJson",label:"Normalize JSON",description:"Standardize JSON formatting before comparison",defaultValue:!0},{key:"sortKeys",label:"Sort Keys",description:"Sort object keys alphabetically",defaultValue:!0}],this.options=this.toggleOptions.reduce((s,i)=>(s[i.key]=i.defaultValue,s),{}),this.element=this.createElement(),e.appendChild(this.element)}createElement(){const t=document.createElement("div");return t.className="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg overflow-hidden transition-colors duration-300",t.innerHTML=`
      <div class="bg-zinc-50 dark:bg-zinc-800 border-b border-zinc-200 dark:border-zinc-700 px-4 py-3 flex justify-between items-center transition-colors duration-300">
        <h3 class="font-semibold text-zinc-900 dark:text-zinc-100">Comparison Options</h3>
        <button class="toggle-control-btn px-2 py-1 text-xs bg-transparent border border-zinc-300 dark:border-zinc-600 text-zinc-600 dark:text-zinc-400 rounded hover:bg-zinc-100 dark:hover:bg-zinc-700 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors duration-200" data-action="reset" title="Reset to Defaults">
          <span class="icon">‚Ü∫</span>
        </button>
      </div>
      <div class="p-4 space-y-4">
        ${this.renderToggles()}
      </div>
    `,this.setupEventListeners(t),t}renderToggles(){return this.toggleOptions.map(t=>{const n=this.options[t.key],e=n?"toggle-switch checked":"toggle-switch";return`
        <div class="toggle-option">
          <label class="flex items-center gap-3 cursor-pointer">
            <input 
              type="checkbox" 
              class="toggle-input sr-only" 
              data-option="${t.key}"
              ${n?"checked":""}
            >
            <span class="${e}">
              <span class="toggle-slider"></span>
            </span>
            <div class="flex-1">
              <span class="block text-zinc-900 dark:text-zinc-100 font-medium text-sm">${t.label}</span>
              <span class="block text-zinc-600 dark:text-zinc-400 text-xs mt-0.5">${t.description}</span>
            </div>
          </label>
        </div>
      `}).join("")}setupEventListeners(t){t.addEventListener("click",n=>{const s=n.target.closest(".toggle-control-btn");if(s){s.dataset.action==="reset"&&this.resetToDefaults();return}}),t.addEventListener("change",n=>{const e=n.target;if(e.classList.contains("toggle-input")){const s=e.dataset.option;s&&this.updateOption(s,e.checked)}})}updateOption(t,n){this.options[t]=n,this.updateToggleDisplay(t,n),this.onOptionsChange?.(this.options)}updateToggleDisplay(t,n){const e=this.element.querySelector(`[data-option="${t}"]`)?.closest(".toggle-option");e&&(n?e.classList.add("checked"):e.classList.remove("checked"))}resetToDefaults(){this.toggleOptions.forEach(t=>{this.options[t.key]=t.defaultValue;const n=this.element.querySelector(`[data-option="${t.key}"]`);n&&(n.checked=t.defaultValue,this.updateToggleDisplay(t.key,t.defaultValue))}),this.onOptionsChange?.(this.options)}getOptions(){return{...this.options}}setOptions(t){Object.entries(t).forEach(([n,e])=>{if(typeof e=="boolean"){this.updateOption(n,e);const s=this.element.querySelector(`[data-option="${n}"]`);s&&(s.checked=e)}})}setEnabled(t){const n=this.element.querySelectorAll(".toggle-input"),e=this.element.querySelector(".toggle-control-btn");n.forEach(s=>{s.disabled=!t}),e&&(e.disabled=!t),t?this.element.classList.remove("opacity-50","pointer-events-none"):this.element.classList.add("opacity-50","pointer-events-none")}}class ke{element;currentData={};onExport;constructor(t,n={}){const e=document.getElementById(t);if(!e)throw new Error(`Container with id "${t}" not found`);this.onExport=n.onExport,this.element=this.createElement(),e.appendChild(this.element)}createElement(){const t=document.createElement("div");return t.className="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg overflow-hidden min-w-[200px] transition-colors duration-300",t.innerHTML=`
      <div class="bg-zinc-50 dark:bg-zinc-800 border-b border-zinc-200 dark:border-zinc-700 px-4 py-3 transition-colors duration-300">
        <h3 class="font-semibold text-zinc-900 dark:text-zinc-100 text-sm">Export Results</h3>
      </div>
      <div class="p-4">
        <div class="flex flex-col gap-2 mb-4">
          <button class="export-btn flex items-center gap-2 bg-zinc-100 dark:bg-zinc-800 hover:bg-zinc-200 dark:hover:bg-zinc-700 border border-zinc-300 dark:border-zinc-600 text-zinc-900 dark:text-zinc-100 px-3 py-2 rounded-md cursor-pointer transition-all duration-200 text-sm disabled:opacity-50 disabled:cursor-not-allowed" data-format="markdown" title="Export as Markdown Report">
            <span class="text-base">üìÑ</span>
            <span class="font-medium">Markdown Report</span>
          </button>
          <button class="export-btn flex items-center gap-2 bg-zinc-100 dark:bg-zinc-800 hover:bg-zinc-200 dark:hover:bg-zinc-700 border border-zinc-300 dark:border-zinc-600 text-zinc-900 dark:text-zinc-100 px-3 py-2 rounded-md cursor-pointer transition-all duration-200 text-sm disabled:opacity-50 disabled:cursor-not-allowed" data-format="json" title="Export as JSON Data">
            <span class="text-base">üìã</span>
            <span class="font-medium">JSON Data</span>
          </button>
        </div>
        <div class="export-status info text-zinc-600 dark:text-zinc-400 text-xs">
          Ready to export when diff is available
        </div>
      </div>
    `,this.setupEventListeners(t),t}setupEventListeners(t){t.addEventListener("click",n=>{const s=n.target.closest(".export-btn");if(s){const i=s.dataset.format;i&&this.handleExport(i)}})}handleExport(t){if(!this.currentData.diffResult){this.showStatus("No diff data available to export","error");return}this.showStatus("Preparing export...","loading");try{this.onExport?.(t,this.currentData),t==="markdown"?this.exportMarkdown():t==="json"&&this.exportJson(),this.showStatus("Export completed successfully","success")}catch(n){this.showStatus("Export failed: "+n.message,"error")}}exportMarkdown(){const t=this.generateMarkdownReport();this.downloadFile(t,"postman-diff-report.md","text/markdown")}exportJson(){const t=JSON.stringify(this.currentData,null,2);this.downloadFile(t,"postman-diff-data.json","application/json")}generateMarkdownReport(){const{oldCollection:t,newCollection:n}=this.currentData;if(!t||!n)return`# Postman Collection Diff Report

Please load both collections to generate a report.`;const e=t?.info.name||"Old Collection",s=n?.info.name||"New Collection";let o=`# Postman Collection Diff Report

**Generated:** ${new Date().toISOString()}
**Comparing:** ${e} ‚Üí ${s}

## Summary

`;const l=this.compareCollections(t,n);return o+=`
- **Added:** ${l.added.length} items
- **Removed:** ${l.removed.length} items  
- **Modified:** ${l.modified.length} items

`,l.added.length>0&&(o+=`## ‚úÖ Added Items

`,l.added.forEach(a=>{o+=`- **${a.name}**`,a.method&&a.url&&(o+=` - \`${a.method} ${a.url}\``),o+=`
`}),o+=`
`),l.removed.length>0&&(o+=`## ‚ùå Removed Items

`,l.removed.forEach(a=>{o+=`- **${a.name}**`,a.method&&a.url&&(o+=` - \`${a.method} ${a.url}\``),o+=`
`}),o+=`
`),l.modified.length>0&&(o+=`## üîÑ Modified Items

`,l.modified.forEach(a=>{o+=`- **${a.name}**`,a.method&&a.url&&(o+=` - \`${a.method} ${a.url}\``),a.changes&&a.changes.length>0&&(o+=`
  Changes:
`,a.changes.forEach(f=>{o+=`  - ${f}
`})),o+=`
`}),o+=`
`),o+=`
---
*Report generated by Postman Collection Diff Viewer*
`,o}compareCollections(t,n){const e=[],s=[],i=[];if(!t||!n)return{added:e,removed:s,modified:i};const o=this.flattenItems(t.items||[]),l=this.flattenItems(n.items||[]),a=new Map(o.map(p=>[p.id,p])),f=new Map(l.map(p=>[p.id,p]));return a.forEach((p,C)=>{f.has(C)||s.push(p)}),f.forEach((p,C)=>{if(!a.has(C))e.push(p);else{const N=a.get(C),c=this.getItemChanges(N,p);c.length>0&&i.push({...p,changes:c})}}),{added:e,removed:s,modified:i}}flattenItems(t,n=[]){return t.forEach(e=>{n.push(e),e.children&&this.flattenItems(e.children,n)}),n}getItemChanges(t,n){const e=[];return t.method!==n.method&&e.push(`Method changed from ${t.method} to ${n.method}`),t.url!==n.url&&e.push(`URL changed from "${t.url}" to "${n.url}"`),JSON.stringify(t.headers)!==JSON.stringify(n.headers)&&e.push("Headers modified"),t.body!==n.body&&e.push("Body modified"),JSON.stringify(t.tests)!==JSON.stringify(n.tests)&&e.push("Tests modified"),e}downloadFile(t,n,e){const s=new Blob([t],{type:e}),i=URL.createObjectURL(s),o=document.createElement("a");o.href=i,o.download=n,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}showStatus(t,n="info"){const e=this.element.querySelector(".export-status");e&&(e.textContent=t,e.className=`export-status ${n}`,(n==="success"||n==="error")&&setTimeout(()=>{e.textContent="Ready to export when diff is available",e.className="export-status"},3e3))}updateData(t){this.currentData={...this.currentData,...t},this.updateButtonStates()}updateButtonStates(){const t=this.element.querySelectorAll(".export-btn"),n=!!this.currentData.diffResult;t.forEach(e=>{e.disabled=!n}),n?this.showStatus("Ready to export","success"):this.showStatus("Ready to export when diff is available","info")}setEnabled(t){this.element.querySelectorAll(".export-btn").forEach(e=>{e.disabled=!t||!this.currentData.diffResult}),t?this.element.classList.remove("opacity-50","pointer-events-none"):this.element.classList.add("opacity-50","pointer-events-none")}}var pe;(function(r){r.INSERT="insert",r.DELETE="delete",r.CONTEXT="context"})(pe||(pe={}));const Oe={LINE_BY_LINE:"line-by-line"},De={NONE:"none"},Ae={WORD:"word"};var ne;(function(r){r.AUTO="auto",r.DARK="dark",r.LIGHT="light"})(ne||(ne={}));function P(){}P.prototype={diff:function(t,n){var e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=s.callback;typeof s=="function"&&(i=s,s={});var o=this;function l(y){return y=o.postProcess(y,s),i?(setTimeout(function(){i(y)},0),!0):y}t=this.castInput(t,s),n=this.castInput(n,s),t=this.removeEmpty(this.tokenize(t,s)),n=this.removeEmpty(this.tokenize(n,s));var a=n.length,f=t.length,p=1,C=a+f;s.maxEditLength!=null&&(C=Math.min(C,s.maxEditLength));var N=(e=s.timeout)!==null&&e!==void 0?e:1/0,c=Date.now()+N,h=[{oldPos:-1,lastComponent:void 0}],g=this.extractCommon(h[0],n,t,0,s);if(h[0].oldPos+1>=f&&g+1>=a)return l(me(o,h[0].lastComponent,n,t,o.useLongestToken));var b=-1/0,v=1/0;function x(){for(var y=Math.max(b,-p);y<=Math.min(v,p);y+=2){var z=void 0,T=h[y-1],D=h[y+1];T&&(h[y-1]=void 0);var d=!1;if(D){var u=D.oldPos-y;d=D&&0<=u&&u<a}var m=T&&T.oldPos+1<f;if(!d&&!m){h[y]=void 0;continue}if(!m||d&&T.oldPos<D.oldPos?z=o.addToPath(D,!0,!1,0,s):z=o.addToPath(T,!1,!0,1,s),g=o.extractCommon(z,n,t,y,s),z.oldPos+1>=f&&g+1>=a)return l(me(o,z.lastComponent,n,t,o.useLongestToken));h[y]=z,z.oldPos+1>=f&&(v=Math.min(v,y-1)),g+1>=a&&(b=Math.max(b,y+1))}p++}if(i)(function y(){setTimeout(function(){if(p>C||Date.now()>c)return i();x()||y()},0)})();else for(;p<=C&&Date.now()<=c;){var w=x();if(w)return w}},addToPath:function(t,n,e,s,i){var o=t.lastComponent;return o&&!i.oneChangePerToken&&o.added===n&&o.removed===e?{oldPos:t.oldPos+s,lastComponent:{count:o.count+1,added:n,removed:e,previousComponent:o.previousComponent}}:{oldPos:t.oldPos+s,lastComponent:{count:1,added:n,removed:e,previousComponent:o}}},extractCommon:function(t,n,e,s,i){for(var o=n.length,l=e.length,a=t.oldPos,f=a-s,p=0;f+1<o&&a+1<l&&this.equals(e[a+1],n[f+1],i);)f++,a++,p++,i.oneChangePerToken&&(t.lastComponent={count:1,previousComponent:t.lastComponent,added:!1,removed:!1});return p&&!i.oneChangePerToken&&(t.lastComponent={count:p,previousComponent:t.lastComponent,added:!1,removed:!1}),t.oldPos=a,f},equals:function(t,n,e){return e.comparator?e.comparator(t,n):t===n||e.ignoreCase&&t.toLowerCase()===n.toLowerCase()},removeEmpty:function(t){for(var n=[],e=0;e<t.length;e++)t[e]&&n.push(t[e]);return n},castInput:function(t){return t},tokenize:function(t){return Array.from(t)},join:function(t){return t.join("")},postProcess:function(t){return t}};function me(r,t,n,e,s){for(var i=[],o;t;)i.push(t),o=t.previousComponent,delete t.previousComponent,t=o;i.reverse();for(var l=0,a=i.length,f=0,p=0;l<a;l++){var C=i[l];if(C.removed)C.value=r.join(e.slice(p,p+C.count)),p+=C.count;else{if(!C.added&&s){var N=n.slice(f,f+C.count);N=N.map(function(c,h){var g=e[p+h];return g.length>c.length?g:c}),C.value=r.join(N)}else C.value=r.join(n.slice(f,f+C.count));f+=C.count,C.added||(p+=C.count)}}return i}function be(r,t){var n;for(n=0;n<r.length&&n<t.length;n++)if(r[n]!=t[n])return r.slice(0,n);return r.slice(0,n)}function ge(r,t){var n;if(!r||!t||r[r.length-1]!=t[t.length-1])return"";for(n=0;n<r.length&&n<t.length;n++)if(r[r.length-(n+1)]!=t[t.length-(n+1)])return r.slice(-n);return r.slice(-n)}function se(r,t,n){if(r.slice(0,t.length)!=t)throw Error("string ".concat(JSON.stringify(r)," doesn't start with prefix ").concat(JSON.stringify(t),"; this is a bug"));return n+r.slice(t.length)}function re(r,t,n){if(!t)return r+n;if(r.slice(-t.length)!=t)throw Error("string ".concat(JSON.stringify(r)," doesn't end with suffix ").concat(JSON.stringify(t),"; this is a bug"));return r.slice(0,-t.length)+n}function _(r,t){return se(r,t,"")}function U(r,t){return re(r,t,"")}function ve(r,t){return t.slice(0,Me(r,t))}function Me(r,t){var n=0;r.length>t.length&&(n=r.length-t.length);var e=t.length;r.length<t.length&&(e=r.length);var s=Array(e),i=0;s[0]=0;for(var o=1;o<e;o++){for(t[o]==t[i]?s[o]=s[i]:s[o]=i;i>0&&t[o]!=t[i];)i=s[i];t[o]==t[i]&&i++}i=0;for(var l=n;l<r.length;l++){for(;i>0&&r[l]!=t[i];)i=s[i];r[l]==t[i]&&i++}return i}var W="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",Pe=new RegExp("[".concat(W,"]+|\\s+|[^").concat(W,"]"),"ug"),Y=new P;Y.equals=function(r,t,n){return n.ignoreCase&&(r=r.toLowerCase(),t=t.toLowerCase()),r.trim()===t.trim()};Y.tokenize=function(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;if(t.intlSegmenter){if(t.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');n=Array.from(t.intlSegmenter.segment(r),function(i){return i.segment})}else n=r.match(Pe)||[];var e=[],s=null;return n.forEach(function(i){/\s/.test(i)?s==null?e.push(i):e.push(e.pop()+i):/\s/.test(s)?e[e.length-1]==s?e.push(e.pop()+i):e.push(s+i):e.push(i),s=i}),e};Y.join=function(r){return r.map(function(t,n){return n==0?t:t.replace(/^\s+/,"")}).join("")};Y.postProcess=function(r,t){if(!r||t.oneChangePerToken)return r;var n=null,e=null,s=null;return r.forEach(function(i){i.added?e=i:i.removed?s=i:((e||s)&&ye(n,s,e,i),n=i,e=null,s=null)}),(e||s)&&ye(n,s,e,null),r};function ye(r,t,n,e){if(t&&n){var s=t.value.match(/^\s*/)[0],i=t.value.match(/\s*$/)[0],o=n.value.match(/^\s*/)[0],l=n.value.match(/\s*$/)[0];if(r){var a=be(s,o);r.value=re(r.value,o,a),t.value=_(t.value,a),n.value=_(n.value,a)}if(e){var f=ge(i,l);e.value=se(e.value,l,f),t.value=U(t.value,f),n.value=U(n.value,f)}}else if(n)r&&(n.value=n.value.replace(/^\s*/,"")),e&&(e.value=e.value.replace(/^\s*/,""));else if(r&&e){var p=e.value.match(/^\s*/)[0],C=t.value.match(/^\s*/)[0],N=t.value.match(/\s*$/)[0],c=be(p,C);t.value=_(t.value,c);var h=ge(_(p,c),N);t.value=U(t.value,h),e.value=se(e.value,p,h),r.value=re(r.value,p,p.slice(0,p.length-h.length))}else if(e){var g=e.value.match(/^\s*/)[0],b=t.value.match(/\s*$/)[0],v=ve(b,g);t.value=U(t.value,v)}else if(r){var x=r.value.match(/\s*$/)[0],w=t.value.match(/^\s*/)[0],y=ve(x,w);t.value=_(t.value,y)}}var qe=new P;qe.tokenize=function(r){var t=new RegExp("(\\r?\\n)|[".concat(W,"]+|[^\\S\\n\\r]+|[^").concat(W,"]"),"ug");return r.match(t)||[]};var de=new P;de.tokenize=function(r,t){t.stripTrailingCr&&(r=r.replace(/\r\n/g,`
`));var n=[],e=r.split(/(\n|\r\n)/);e[e.length-1]||e.pop();for(var s=0;s<e.length;s++){var i=e[s];s%2&&!t.newlineIsToken?n[n.length-1]+=i:n.push(i)}return n};de.equals=function(r,t,n){return n.ignoreWhitespace?((!n.newlineIsToken||!r.includes(`
`))&&(r=r.trim()),(!n.newlineIsToken||!t.includes(`
`))&&(t=t.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(r.endsWith(`
`)&&(r=r.slice(0,-1)),t.endsWith(`
`)&&(t=t.slice(0,-1))),P.prototype.equals.call(this,r,t,n)};var Re=new P;Re.tokenize=function(r){return r.split(/(\S.+?[.!?])(?=\s+|$)/)};var Fe=new P;Fe.tokenize=function(r){return r.split(/([{}:;,]|\s+)/)};function ie(r){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ie(r)}var G=new P;G.useLongestToken=!0;G.tokenize=de.tokenize;G.castInput=function(r,t){var n=t.undefinedReplacement,e=t.stringifyReplacer,s=e===void 0?function(i,o){return typeof o>"u"?n:o}:e;return typeof r=="string"?r:JSON.stringify(oe(r,null,null,s),s,"  ")};G.equals=function(r,t,n){return P.prototype.equals.call(G,r.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"),n)};function oe(r,t,n,e,s){t=t||[],n=n||[],e&&(r=e(s,r));var i;for(i=0;i<t.length;i+=1)if(t[i]===r)return n[i];var o;if(Object.prototype.toString.call(r)==="[object Array]"){for(t.push(r),o=new Array(r.length),n.push(o),i=0;i<r.length;i+=1)o[i]=oe(r[i],t,n,e,s);return t.pop(),n.pop(),o}if(r&&r.toJSON&&(r=r.toJSON()),ie(r)==="object"&&r!==null){t.push(r),o={},n.push(o);var l=[],a;for(a in r)Object.prototype.hasOwnProperty.call(r,a)&&l.push(a);for(l.sort(),i=0;i<l.length;i+=1)a=l[i],o[a]=oe(r[a],t,n,e,a);t.pop(),n.pop()}else o=r;return o}var ae=new P;ae.tokenize=function(r){return r.slice()};ae.join=ae.removeEmpty=function(r){return r};const ce={matching:De.NONE,matchWordsThreshold:.25,maxLineLengthHighlight:1e4,diffStyle:Ae.WORD,colorScheme:ne.LIGHT};ce.colorScheme;const Je=Object.assign(Object.assign({},ce),{renderNothingWhenEmpty:!1,matchingMaxComparisons:2500,maxLineSizeInBlockForComparison:200}),He=Object.assign(Object.assign({},ce),{renderNothingWhenEmpty:!1,matchingMaxComparisons:2500,maxLineSizeInBlockForComparison:200});var K={},xe;function Be(){return xe||(xe=1,(function(r){(function(t){var n=/\S/,e=/\"/g,s=/\n/g,i=/\r/g,o=/\\/g,l=/\u2028/,a=/\u2029/;t.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},t.scan=function(u,m){var E=u.length,k=0,A=1,V=2,$=k,I=null,Q=null,J="",O=[],j=!1,L=0,X=0,H="{{",F="}}";function he(){J.length>0&&(O.push({tag:"_t",text:new String(J)}),J="")}function Te(){for(var q=!0,M=X;M<O.length;M++)if(q=t.tags[O[M].tag]<t.tags._v||O[M].tag=="_t"&&O[M].text.match(n)===null,!q)return!1;return q}function fe(q,M){if(he(),q&&Te())for(var R=X,B;R<O.length;R++)O[R].text&&((B=O[R+1])&&B.tag==">"&&(B.indent=O[R].text.toString()),O.splice(R,1));else M||O.push({tag:`
`});j=!1,X=O.length}function Ne(q,M){var R="="+F,B=q.indexOf(R,M),Z=p(q.substring(q.indexOf("=",M)+1,B)).split(" ");return H=Z[0],F=Z[Z.length-1],B+R.length-1}for(m&&(m=m.split(" "),H=m[0],F=m[1]),L=0;L<E;L++)$==k?C(H,u,L)?(--L,he(),$=A):u.charAt(L)==`
`?fe(j):J+=u.charAt(L):$==A?(L+=H.length-1,Q=t.tags[u.charAt(L+1)],I=Q?u.charAt(L+1):"_v",I=="="?(L=Ne(u,L),$=k):(Q&&L++,$=V),j=L):C(F,u,L)?(O.push({tag:I,n:p(J),otag:H,ctag:F,i:I=="/"?j-H.length:L+F.length}),J="",L+=F.length-1,$=k,I=="{"&&(F=="}}"?L++:f(O[O.length-1]))):J+=u.charAt(L);return fe(j,!0),O};function f(d){d.n.substr(d.n.length-1)==="}"&&(d.n=d.n.substring(0,d.n.length-1))}function p(d){return d.trim?d.trim():d.replace(/^\s*|\s*$/g,"")}function C(d,u,m){if(u.charAt(m)!=d.charAt(0))return!1;for(var E=1,k=d.length;E<k;E++)if(u.charAt(m+E)!=d.charAt(E))return!1;return!0}var N={_t:!0,"\n":!0,$:!0,"/":!0};function c(d,u,m,E){var k=[],A=null,V=null,$=null;for(V=m[m.length-1];d.length>0;){if($=d.shift(),V&&V.tag=="<"&&!($.tag in N))throw new Error("Illegal content in < super tag.");if(t.tags[$.tag]<=t.tags.$||h($,E))m.push($),$.nodes=c(d,$.tag,m,E);else if($.tag=="/"){if(m.length===0)throw new Error("Closing tag without opener: /"+$.n);if(A=m.pop(),$.n!=A.n&&!g($.n,A.n,E))throw new Error("Nesting error: "+A.n+" vs. "+$.n);return A.end=$.i,k}else $.tag==`
`&&($.last=d.length==0||d[0].tag==`
`);k.push($)}if(m.length>0)throw new Error("missing closing tag: "+m.pop().n);return k}function h(d,u){for(var m=0,E=u.length;m<E;m++)if(u[m].o==d.n)return d.tag="#",!0}function g(d,u,m){for(var E=0,k=m.length;E<k;E++)if(m[E].c==d&&m[E].o==u)return!0}function b(d){var u=[];for(var m in d)u.push('"'+w(m)+'": function(c,p,t,i) {'+d[m]+"}");return"{ "+u.join(",")+" }"}function v(d){var u=[];for(var m in d.partials)u.push('"'+w(m)+'":{name:"'+w(d.partials[m].name)+'", '+v(d.partials[m])+"}");return"partials: {"+u.join(",")+"}, subs: "+b(d.subs)}t.stringify=function(d,u,m){return"{code: function (c,p,i) { "+t.wrapMain(d.code)+" },"+v(d)+"}"};var x=0;t.generate=function(d,u,m){x=0;var E={code:"",subs:{},partials:{}};return t.walk(d,E),m.asString?this.stringify(E,u,m):this.makeTemplate(E,u,m)},t.wrapMain=function(d){return'var t=this;t.b(i=i||"");'+d+"return t.fl();"},t.template=t.Template,t.makeTemplate=function(d,u,m){var E=this.makePartials(d);return E.code=new Function("c","p","i",this.wrapMain(d.code)),new this.template(E,u,this,m)},t.makePartials=function(d){var u,m={subs:{},partials:d.partials,name:d.name};for(u in m.partials)m.partials[u]=this.makePartials(m.partials[u]);for(u in d.subs)m.subs[u]=new Function("c","p","t","i",d.subs[u]);return m};function w(d){return d.replace(o,"\\\\").replace(e,'\\"').replace(s,"\\n").replace(i,"\\r").replace(l,"\\u2028").replace(a,"\\u2029")}function y(d){return~d.indexOf(".")?"d":"f"}function z(d,u){var m="<"+(u.prefix||""),E=m+d.n+x++;return u.partials[E]={name:d.n,partials:{}},u.code+='t.b(t.rp("'+w(E)+'",c,p,"'+(d.indent||"")+'"));',E}t.codegen={"#":function(d,u){u.code+="if(t.s(t."+y(d.n)+'("'+w(d.n)+'",c,p,1),c,p,0,'+d.i+","+d.end+',"'+d.otag+" "+d.ctag+'")){t.rs(c,p,function(c,p,t){',t.walk(d.nodes,u),u.code+="});c.pop();}"},"^":function(d,u){u.code+="if(!t.s(t."+y(d.n)+'("'+w(d.n)+'",c,p,1),c,p,1,0,0,"")){',t.walk(d.nodes,u),u.code+="};"},">":z,"<":function(d,u){var m={partials:{},code:"",subs:{},inPartial:!0};t.walk(d.nodes,m);var E=u.partials[z(d,u)];E.subs=m.subs,E.partials=m.partials},$:function(d,u){var m={subs:{},code:"",partials:u.partials,prefix:d.n};t.walk(d.nodes,m),u.subs[d.n]=m.code,u.inPartial||(u.code+='t.sub("'+w(d.n)+'",c,p,i);')},"\n":function(d,u){u.code+=D('"\\n"'+(d.last?"":" + i"))},_v:function(d,u){u.code+="t.b(t.v(t."+y(d.n)+'("'+w(d.n)+'",c,p,0)));'},_t:function(d,u){u.code+=D('"'+w(d.text)+'"')},"{":T,"&":T};function T(d,u){u.code+="t.b(t.t(t."+y(d.n)+'("'+w(d.n)+'",c,p,0)));'}function D(d){return"t.b("+d+");"}t.walk=function(d,u){for(var m,E=0,k=d.length;E<k;E++)m=t.codegen[d[E].tag],m&&m(d[E],u);return u},t.parse=function(d,u,m){return m=m||{},c(d,"",[],m.sectionTags||[])},t.cache={},t.cacheKey=function(d,u){return[d,!!u.asString,!!u.disableLambda,u.delimiters,!!u.modelGet].join("||")},t.compile=function(d,u){u=u||{};var m=t.cacheKey(d,u),E=this.cache[m];if(E){var k=E.partials;for(var A in k)delete k[A].instance;return E}return E=this.generate(this.parse(this.scan(d,u.delimiters),d,u),d,u),this.cache[m]=E}})(r)})(K)),K}var ee={},we;function Ve(){return we||(we=1,(function(r){(function(t){t.Template=function(c,h,g,b){c=c||{},this.r=c.code||this.r,this.c=g,this.options=b||{},this.text=h||"",this.partials=c.partials||{},this.subs=c.subs||{},this.buf=""},t.Template.prototype={r:function(c,h,g){return""},v:C,t:p,render:function(h,g,b){return this.ri([h],g||{},b)},ri:function(c,h,g){return this.r(c,h,g)},ep:function(c,h){var g=this.partials[c],b=h[g.name];if(g.instance&&g.base==b)return g.instance;if(typeof b=="string"){if(!this.c)throw new Error("No compiler available.");b=this.c.compile(b,this.options)}if(!b)return null;if(this.partials[c].base=b,g.subs){h.stackText||(h.stackText={});for(key in g.subs)h.stackText[key]||(h.stackText[key]=this.activeSub!==void 0&&h.stackText[this.activeSub]?h.stackText[this.activeSub]:this.text);b=e(b,g.subs,g.partials,this.stackSubs,this.stackPartials,h.stackText)}return this.partials[c].instance=b,b},rp:function(c,h,g,b){var v=this.ep(c,g);return v?v.ri(h,g,b):""},rs:function(c,h,g){var b=c[c.length-1];if(!N(b)){g(c,h,this);return}for(var v=0;v<b.length;v++)c.push(b[v]),g(c,h,this),c.pop()},s:function(c,h,g,b,v,x,w){var y;return N(c)&&c.length===0?!1:(typeof c=="function"&&(c=this.ms(c,h,g,b,v,x,w)),y=!!c,!b&&y&&h&&h.push(typeof c=="object"?c:h[h.length-1]),y)},d:function(c,h,g,b){var v,x=c.split("."),w=this.f(x[0],h,g,b),y=this.options.modelGet,z=null;if(c==="."&&N(h[h.length-2]))w=h[h.length-1];else for(var T=1;T<x.length;T++)v=n(x[T],w,y),v!==void 0?(z=w,w=v):w="";return b&&!w?!1:(!b&&typeof w=="function"&&(h.push(z),w=this.mv(w,h,g),h.pop()),w)},f:function(c,h,g,b){for(var v=!1,x=null,w=!1,y=this.options.modelGet,z=h.length-1;z>=0;z--)if(x=h[z],v=n(c,x,y),v!==void 0){w=!0;break}return w?(!b&&typeof v=="function"&&(v=this.mv(v,h,g)),v):b?!1:""},ls:function(c,h,g,b,v){var x=this.options.delimiters;return this.options.delimiters=v,this.b(this.ct(p(c.call(h,b)),h,g)),this.options.delimiters=x,!1},ct:function(c,h,g){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(c,this.options).render(h,g)},b:function(c){this.buf+=c},fl:function(){var c=this.buf;return this.buf="",c},ms:function(c,h,g,b,v,x,w){var y,z=h[h.length-1],T=c.call(z);return typeof T=="function"?b?!0:(y=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(T,z,g,y.substring(v,x),w)):T},mv:function(c,h,g){var b=h[h.length-1],v=c.call(b);return typeof v=="function"?this.ct(p(v.call(b)),b,g):v},sub:function(c,h,g,b){var v=this.subs[c];v&&(this.activeSub=c,v(h,g,this,b),this.activeSub=!1)}};function n(c,h,g){var b;return h&&typeof h=="object"&&(h[c]!==void 0?b=h[c]:g&&h.get&&typeof h.get=="function"&&(b=h.get(c))),b}function e(c,h,g,b,v,x){function w(){}w.prototype=c;function y(){}y.prototype=c.subs;var z,T=new w;T.subs=new y,T.subsText={},T.buf="",b=b||{},T.stackSubs=b,T.subsText=x;for(z in h)b[z]||(b[z]=h[z]);for(z in b)T.subs[z]=b[z];v=v||{},T.stackPartials=v;for(z in g)v[z]||(v[z]=g[z]);for(z in v)T.partials[z]=v[z];return T}var s=/&/g,i=/</g,o=/>/g,l=/\'/g,a=/\"/g,f=/[&<>\"\']/;function p(c){return String(c??"")}function C(c){return c=p(c),f.test(c)?c.replace(s,"&amp;").replace(i,"&lt;").replace(o,"&gt;").replace(l,"&#39;").replace(a,"&quot;"):c}var N=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"}})(r)})(ee)),ee}var te,Ce;function Ie(){if(Ce)return te;Ce=1;var r=Be();return r.Template=Ve().Template,r.template=r.Template,te=r,te}var S=Ie();new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<li class="d2h-file-list-line">'),e.b(`
`+n),e.b('    <span class="d2h-file-name-wrapper">'),e.b(`
`+n),e.b(e.rp("<fileIcon0",r,t,"      ")),e.b('      <a href="#'),e.b(e.v(e.f("fileHtmlId",r,t,0))),e.b('" class="d2h-file-name">'),e.b(e.v(e.f("fileName",r,t,0))),e.b("</a>"),e.b(`
`+n),e.b('      <span class="d2h-file-stats">'),e.b(`
`+n),e.b('          <span class="d2h-lines-added">'),e.b(e.v(e.f("addedLines",r,t,0))),e.b("</span>"),e.b(`
`+n),e.b('          <span class="d2h-lines-deleted">'),e.b(e.v(e.f("deletedLines",r,t,0))),e.b("</span>"),e.b(`
`+n),e.b("      </span>"),e.b(`
`+n),e.b("    </span>"),e.b(`
`+n),e.b("</li>"),e.fl()},partials:{"<fileIcon0":{name:"fileIcon",partials:{},subs:{}}},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<div class="d2h-file-list-wrapper '),e.b(e.v(e.f("colorScheme",r,t,0))),e.b('">'),e.b(`
`+n),e.b('    <div class="d2h-file-list-header">'),e.b(`
`+n),e.b('        <span class="d2h-file-list-title">Files changed ('),e.b(e.v(e.f("filesNumber",r,t,0))),e.b(")</span>"),e.b(`
`+n),e.b('        <a class="d2h-file-switch d2h-hide">hide</a>'),e.b(`
`+n),e.b('        <a class="d2h-file-switch d2h-show">show</a>'),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b('    <ol class="d2h-file-list">'),e.b(`
`+n),e.b("    "),e.b(e.t(e.f("files",r,t,0))),e.b(`
`+n),e.b("    </ol>"),e.b(`
`+n),e.b("</div>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b("<tr>"),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.f("lineClass",r,t,0))),e.b(" "),e.b(e.v(e.d("CSSLineClass.INFO",r,t,0))),e.b('"></td>'),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.d("CSSLineClass.INFO",r,t,0))),e.b('">'),e.b(`
`+n),e.b('        <div class="'),e.b(e.v(e.f("contentClass",r,t,0))),e.b('">'),e.s(e.f("blockHeader",r,t,1),r,t,0,156,173,"{{ }}")&&(e.rs(r,t,function(s,i,o){o.b(o.t(o.f("blockHeader",s,i,0)))}),r.pop()),e.s(e.f("blockHeader",r,t,1),r,t,1,0,0,"")||e.b("&nbsp;"),e.b("</div>"),e.b(`
`+n),e.b("    </td>"),e.b(`
`+n),e.b("</tr>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b("<tr>"),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.d("CSSLineClass.INFO",r,t,0))),e.b('">'),e.b(`
`+n),e.b('        <div class="'),e.b(e.v(e.f("contentClass",r,t,0))),e.b('">'),e.b(`
`+n),e.b("            File without changes"),e.b(`
`+n),e.b("        </div>"),e.b(`
`+n),e.b("    </td>"),e.b(`
`+n),e.b("</tr>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-file-name-wrapper">'),e.b(`
`+n),e.b(e.rp("<fileIcon0",r,t,"    ")),e.b('    <span class="d2h-file-name">'),e.b(e.v(e.f("fileDiffName",r,t,0))),e.b("</span>"),e.b(`
`+n),e.b(e.rp("<fileTag1",r,t,"    ")),e.b("</span>"),e.b(`
`+n),e.b('<label class="d2h-file-collapse">'),e.b(`
`+n),e.b('    <input class="d2h-file-collapse-input" type="checkbox" name="viewed" value="viewed">'),e.b(`
`+n),e.b("    Viewed"),e.b(`
`+n),e.b("</label>"),e.fl()},partials:{"<fileIcon0":{name:"fileIcon",partials:{},subs:{}},"<fileTag1":{name:"fileTag",partials:{},subs:{}}},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b("<tr>"),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.f("lineClass",r,t,0))),e.b(" "),e.b(e.v(e.f("type",r,t,0))),e.b('">'),e.b(`
`+n),e.b("      "),e.b(e.t(e.f("lineNumber",r,t,0))),e.b(`
`+n),e.b("    </td>"),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.f("type",r,t,0))),e.b('">'),e.b(`
`+n),e.b('        <div class="'),e.b(e.v(e.f("contentClass",r,t,0))),e.b('">'),e.b(`
`+n),e.s(e.f("prefix",r,t,1),r,t,0,162,238,"{{ }}")&&(e.rs(r,t,function(s,i,o){o.b('            <span class="d2h-code-line-prefix">'),o.b(o.t(o.f("prefix",s,i,0))),o.b("</span>"),o.b(`
`+n)}),r.pop()),e.s(e.f("prefix",r,t,1),r,t,1,0,0,"")||(e.b('            <span class="d2h-code-line-prefix">&nbsp;</span>'),e.b(`
`+n)),e.s(e.f("content",r,t,1),r,t,0,371,445,"{{ }}")&&(e.rs(r,t,function(s,i,o){o.b('            <span class="d2h-code-line-ctn">'),o.b(o.t(o.f("content",s,i,0))),o.b("</span>"),o.b(`
`+n)}),r.pop()),e.s(e.f("content",r,t,1),r,t,1,0,0,"")||(e.b('            <span class="d2h-code-line-ctn"><br></span>'),e.b(`
`+n)),e.b("        </div>"),e.b(`
`+n),e.b("    </td>"),e.b(`
`+n),e.b("</tr>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<div class="d2h-wrapper '),e.b(e.v(e.f("colorScheme",r,t,0))),e.b('">'),e.b(`
`+n),e.b("    "),e.b(e.t(e.f("content",r,t,0))),e.b(`
`+n),e.b("</div>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-added" height="16" title="added" version="1.1" viewBox="0 0 14 16"'),e.b(`
`+n),e.b('     width="14">'),e.b(`
`+n),e.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM6 9H3V7h3V4h2v3h3v2H8v3H6V9z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-changed" height="16" title="modified" version="1.1"'),e.b(`
`+n),e.b('     viewBox="0 0 14 16" width="14">'),e.b(`
`+n),e.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM4 8c0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3-3-1.34-3-3z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-deleted" height="16" title="removed" version="1.1"'),e.b(`
`+n),e.b('     viewBox="0 0 14 16" width="14">'),e.b(`
`+n),e.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM11 9H3V7h8v2z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-moved" height="16" title="renamed" version="1.1"'),e.b(`
`+n),e.b('     viewBox="0 0 14 16" width="14">'),e.b(`
`+n),e.b('    <path d="M6 9H3V7h3V4l5 4-5 4V9z m8-7v12c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h12c0.55 0 1 0.45 1 1z m-1 0H1v12h12V2z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">'),e.b(`
`+n),e.b('    <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<div id="'),e.b(e.v(e.f("fileHtmlId",r,t,0))),e.b('" class="d2h-file-wrapper" data-lang="'),e.b(e.v(e.d("file.language",r,t,0))),e.b('">'),e.b(`
`+n),e.b('    <div class="d2h-file-header">'),e.b(`
`+n),e.b("    "),e.b(e.t(e.f("filePath",r,t,0))),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b('    <div class="d2h-file-diff">'),e.b(`
`+n),e.b('        <div class="d2h-code-wrapper">'),e.b(`
`+n),e.b('            <table class="d2h-diff-table">'),e.b(`
`+n),e.b('                <tbody class="d2h-diff-tbody">'),e.b(`
`+n),e.b("                "),e.b(e.t(e.f("diffs",r,t,0))),e.b(`
`+n),e.b("                </tbody>"),e.b(`
`+n),e.b("            </table>"),e.b(`
`+n),e.b("        </div>"),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b("</div>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<div class="line-num1">'),e.b(e.v(e.f("oldNumber",r,t,0))),e.b("</div>"),e.b(`
`+n),e.b('<div class="line-num2">'),e.b(e.v(e.f("newNumber",r,t,0))),e.b("</div>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<div id="'),e.b(e.v(e.f("fileHtmlId",r,t,0))),e.b('" class="d2h-file-wrapper" data-lang="'),e.b(e.v(e.d("file.language",r,t,0))),e.b('">'),e.b(`
`+n),e.b('    <div class="d2h-file-header">'),e.b(`
`+n),e.b("      "),e.b(e.t(e.f("filePath",r,t,0))),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b('    <div class="d2h-files-diff">'),e.b(`
`+n),e.b('        <div class="d2h-file-side-diff">'),e.b(`
`+n),e.b('            <div class="d2h-code-wrapper">'),e.b(`
`+n),e.b('                <table class="d2h-diff-table">'),e.b(`
`+n),e.b('                    <tbody class="d2h-diff-tbody">'),e.b(`
`+n),e.b("                    "),e.b(e.t(e.d("diffs.left",r,t,0))),e.b(`
`+n),e.b("                    </tbody>"),e.b(`
`+n),e.b("                </table>"),e.b(`
`+n),e.b("            </div>"),e.b(`
`+n),e.b("        </div>"),e.b(`
`+n),e.b('        <div class="d2h-file-side-diff">'),e.b(`
`+n),e.b('            <div class="d2h-code-wrapper">'),e.b(`
`+n),e.b('                <table class="d2h-diff-table">'),e.b(`
`+n),e.b('                    <tbody class="d2h-diff-tbody">'),e.b(`
`+n),e.b("                    "),e.b(e.t(e.d("diffs.right",r,t,0))),e.b(`
`+n),e.b("                    </tbody>"),e.b(`
`+n),e.b("                </table>"),e.b(`
`+n),e.b("            </div>"),e.b(`
`+n),e.b("        </div>"),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b("</div>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-tag d2h-added d2h-added-tag">ADDED</span>'),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-tag d2h-changed d2h-changed-tag">CHANGED</span>'),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-tag d2h-deleted d2h-deleted-tag">DELETED</span>'),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-tag d2h-moved d2h-moved-tag">RENAMED</span>'),e.fl()},partials:{},subs:{}});Object.assign(Object.assign(Object.assign({},Je),He),{outputFormat:Oe.LINE_BY_LINE,drawFileList:!0});class le{static normalize(t){return{info:{name:t.info.name,version:t.info.version},items:this.normalizeItems(t.item)}}static normalizeItems(t){return t.map(n=>this.normalizeItem(n))}static normalizeItem(t){const n={id:t.id||this.generateId(t.name),name:t.name};return t.request&&(n.method=t.request.method,n.url=this.normalizeUrl(t.request.url),n.headers=this.normalizeHeaders(t.request.header),n.body=this.normalizeBody(t.request.body)),t.item&&Array.isArray(t.item)&&(n.children=this.normalizeItems(t.item)),t.event&&(n.tests=this.normalizeEvents(t.event)),n}static normalizeUrl(t){return typeof t=="string"?t:t?.raw||""}static normalizeHeaders(t){return t?t.filter(n=>!n.disabled).reduce((n,e)=>(n[e.key]=e.value,n),{}):{}}static normalizeBody(t){if(!t)return"";switch(t.mode){case"raw":return t.raw||"";case"urlencoded":return this.formatUrlEncoded(t.urlencoded);case"formdata":return this.formatFormData(t.formdata);default:return JSON.stringify(t)}}static normalizeEvents(t){return t.filter(n=>n.script?.exec).map(n=>n.script.exec.join(`
`))}static formatUrlEncoded(t){return t?t.filter(n=>!n.disabled).map(n=>`${n.key}=${n.value}`).join("&"):""}static formatFormData(t){return t?t.filter(n=>!n.disabled).map(n=>`${n.key}: ${n.value}`).join(`
`):""}static generateId(t){return t.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")}}class je{diff(t,n,e={}){let s;typeof e=="function"?(s=e,e={}):"callback"in e&&(s=e.callback);const i=this.castInput(t,e),o=this.castInput(n,e),l=this.removeEmpty(this.tokenize(i,e)),a=this.removeEmpty(this.tokenize(o,e));return this.diffWithOptionsObj(l,a,e,s)}diffWithOptionsObj(t,n,e,s){var i;const o=x=>{if(x=this.postProcess(x,e),s){setTimeout(function(){s(x)},0);return}else return x},l=n.length,a=t.length;let f=1,p=l+a;e.maxEditLength!=null&&(p=Math.min(p,e.maxEditLength));const C=(i=e.timeout)!==null&&i!==void 0?i:1/0,N=Date.now()+C,c=[{oldPos:-1,lastComponent:void 0}];let h=this.extractCommon(c[0],n,t,0,e);if(c[0].oldPos+1>=a&&h+1>=l)return o(this.buildValues(c[0].lastComponent,n,t));let g=-1/0,b=1/0;const v=()=>{for(let x=Math.max(g,-f);x<=Math.min(b,f);x+=2){let w;const y=c[x-1],z=c[x+1];y&&(c[x-1]=void 0);let T=!1;if(z){const d=z.oldPos-x;T=z&&0<=d&&d<l}const D=y&&y.oldPos+1<a;if(!T&&!D){c[x]=void 0;continue}if(!D||T&&y.oldPos<z.oldPos?w=this.addToPath(z,!0,!1,0,e):w=this.addToPath(y,!1,!0,1,e),h=this.extractCommon(w,n,t,x,e),w.oldPos+1>=a&&h+1>=l)return o(this.buildValues(w.lastComponent,n,t))||!0;c[x]=w,w.oldPos+1>=a&&(b=Math.min(b,x-1)),h+1>=l&&(g=Math.max(g,x+1))}f++};if(s)(function x(){setTimeout(function(){if(f>p||Date.now()>N)return s(void 0);v()||x()},0)})();else for(;f<=p&&Date.now()<=N;){const x=v();if(x)return x}}addToPath(t,n,e,s,i){const o=t.lastComponent;return o&&!i.oneChangePerToken&&o.added===n&&o.removed===e?{oldPos:t.oldPos+s,lastComponent:{count:o.count+1,added:n,removed:e,previousComponent:o.previousComponent}}:{oldPos:t.oldPos+s,lastComponent:{count:1,added:n,removed:e,previousComponent:o}}}extractCommon(t,n,e,s,i){const o=n.length,l=e.length;let a=t.oldPos,f=a-s,p=0;for(;f+1<o&&a+1<l&&this.equals(e[a+1],n[f+1],i);)f++,a++,p++,i.oneChangePerToken&&(t.lastComponent={count:1,previousComponent:t.lastComponent,added:!1,removed:!1});return p&&!i.oneChangePerToken&&(t.lastComponent={count:p,previousComponent:t.lastComponent,added:!1,removed:!1}),t.oldPos=a,f}equals(t,n,e){return e.comparator?e.comparator(t,n):t===n||!!e.ignoreCase&&t.toLowerCase()===n.toLowerCase()}removeEmpty(t){const n=[];for(let e=0;e<t.length;e++)t[e]&&n.push(t[e]);return n}castInput(t,n){return t}tokenize(t,n){return Array.from(t)}join(t){return t.join("")}postProcess(t,n){return t}get useLongestToken(){return!1}buildValues(t,n,e){const s=[];let i;for(;t;)s.push(t),i=t.previousComponent,delete t.previousComponent,t=i;s.reverse();const o=s.length;let l=0,a=0,f=0;for(;l<o;l++){const p=s[l];if(p.removed)p.value=this.join(e.slice(f,f+p.count)),f+=p.count;else{if(!p.added&&this.useLongestToken){let C=n.slice(a,a+p.count);C=C.map(function(N,c){const h=e[f+c];return h.length>N.length?h:N}),p.value=this.join(C)}else p.value=this.join(n.slice(a,a+p.count));a+=p.count,p.added||(f+=p.count)}}return s}}class _e extends je{constructor(){super(...arguments),this.tokenize=Ue}equals(t,n,e){return e.ignoreWhitespace?((!e.newlineIsToken||!t.includes(`
`))&&(t=t.trim()),(!e.newlineIsToken||!n.includes(`
`))&&(n=n.trim())):e.ignoreNewlineAtEof&&!e.newlineIsToken&&(t.endsWith(`
`)&&(t=t.slice(0,-1)),n.endsWith(`
`)&&(n=n.slice(0,-1))),super.equals(t,n,e)}}const Ge=new _e;function Ee(r,t,n){return Ge.diff(r,t,n)}function Ue(r,t){t.stripTrailingCr&&(r=r.replace(/\r\n/g,`
`));const n=[],e=r.split(/(\n|\r\n)/);e[e.length-1]||e.pop();for(let s=0;s<e.length;s++){const i=e[s];s%2&&!t.newlineIsToken?n[n.length-1]+=i:n.push(i)}return n}class ze{constructor(){}diff(t,n){const e=le.normalize(t),s=le.normalize(n),i=this.createItemDiffs(e,s),o=this.generateItemBasedHtml(i),l=[];return i.forEach(a=>{a.type==="added"?l.push({added:!0,removed:!1,value:a.item.name,count:1}):a.type==="removed"?l.push({added:!1,removed:!0,value:a.item.name,count:1}):a.type==="modified"&&l.push({added:!1,removed:!1,value:a.item.name,count:1})}),{oldCollection:JSON.stringify({name:e.info.name,itemCount:e.items?.length||0}),newCollection:JSON.stringify({name:s.info.name,itemCount:s.items?.length||0}),patches:l,htmlDiff:o}}createItemDiffs(t,n){const e=[],s=this.flattenItems(t.items||[]),i=this.flattenItems(n.items||[]),o=new Map(s.map(a=>[a.id,a])),l=new Map(i.map(a=>[a.id,a]));return o.forEach((a,f)=>{l.has(f)||e.push({type:"removed",item:a})}),l.forEach((a,f)=>{if(!o.has(f))e.push({type:"added",item:a});else{const p=o.get(f);this.hasItemChanged(p,a)&&e.push({type:"modified",item:a,oldItem:p,changes:this.getItemChanges(p,a)})}}),e}flattenItems(t,n=[],e=""){return t.forEach(s=>{const i=e?`${e}/${s.name}`:s.name,o={...s,path:i,parentPath:e};n.push(o),s.children&&this.flattenItems(s.children,n,i)}),n}hasItemChanged(t,n){return t.method!==n.method||t.url!==n.url||t.body!==n.body||JSON.stringify(t.headers)!==JSON.stringify(n.headers)||JSON.stringify(t.tests)!==JSON.stringify(n.tests)}getItemChanges(t,n){const e=[];return t.method!==n.method&&e.push(`Method: ${t.method} ‚Üí ${n.method}`),t.url!==n.url&&e.push(`URL: ${t.url} ‚Üí ${n.url}`),t.body!==n.body&&e.push("Body modified"),JSON.stringify(t.headers)!==JSON.stringify(n.headers)&&e.push("Headers modified"),JSON.stringify(t.tests)!==JSON.stringify(n.tests)&&e.push("Tests modified"),e}generateItemBasedHtml(t){let n='<div class="d2h-wrapper">';const e=t.filter(o=>o.type==="added"),s=t.filter(o=>o.type==="removed"),i=t.filter(o=>o.type==="modified");return s.length>0&&(n+=this.createSection("Removed Endpoints",s,"removed","removed-section")),e.length>0&&(n+=this.createSection("Added Endpoints",e,"added","added-section")),i.length>0&&(n+='<div class="d2h-file-wrapper" id="modified-section">',n+='<div class="d2h-file-header">',n+='<span class="d2h-file-name">Modified Endpoints</span>',n+="</div>",i.forEach(o=>{n+=`<div class="d2h-file-diff" id="modified-${o.item.id}">`,n+='<div class="modified-endpoint-header">',o.item.parentPath&&(n+=`<span class="path-hierarchy">${this.escapeHtml(o.item.parentPath)} ‚Ä∫ </span>`),n+=`<strong>${this.escapeHtml(o.item.name)}</strong>`,o.item.method&&o.item.url&&(n+=` <span class="endpoint-info">[${o.item.method} ${this.escapeHtml(o.item.url)}]</span>`);const l=this.getChangeTypes(o.oldItem,o.item);l.length>0&&(n+=` <span class="change-summary">(${l.join(", ")})</span>`),n+="</div>",o.oldItem&&o.item&&(n+=this.generateDetailedChanges(o.oldItem,o.item)),n+="</div>"}),n+="</div>"),n+="</div>",n}createSection(t,n,e,s){let i=`<div class="d2h-file-wrapper" id="${s}">`;return i+='<div class="d2h-file-header">',i+=`<span class="d2h-file-name">${t}</span>`,i+="</div>",i+='<div class="d2h-file-diff">',i+='<table class="d2h-diff-table">',i+='<tbody class="d2h-diff-tbody">',n.forEach(o=>{const l=e==="added"?"d2h-ins":"d2h-del",a=e==="added"?"+":"-",f=e==="added"?`added-${o.item.id}`:`removed-${o.item.id}`;this.getItemPath(o.item),i+=`<tr id="${f}">`,i+=`<td class="d2h-code-linenumber ${l}">${a}</td>`,i+=`<td class="${l}"><div class="d2h-code-line">`,o.item.parentPath&&(i+=`${a} ${this.escapeHtml(o.item.parentPath)} ‚Ä∫ `),i+=`<strong>${this.escapeHtml(o.item.name)}</strong>`,o.item.method&&o.item.url?i+=` <span style="opacity: 0.7;">[${o.item.method} ${this.escapeHtml(o.item.url)}]</span>`:o.item.children&&(i+=" üìÅ"),i+="</div></td>",i+="</tr>"}),i+="</tbody></table></div></div>",i}getItemPath(t){return t.path||t.name||"Unnamed"}getChangeTypes(t,n){const e=[];return t.url!==n.url&&e.push("URL"),t.method!==n.method&&e.push("Method"),JSON.stringify(t.headers)!==JSON.stringify(n.headers)&&e.push("Headers"),t.body!==n.body&&e.push("Body"),t.prerequest!==n.prerequest&&e.push("Pre-request"),t.tests!==n.tests&&e.push("Tests"),e}generateDetailedChanges(t,n){let e='<table class="d2h-diff-table"><tbody class="d2h-diff-tbody">';return t.url!==n.url&&(e+=this.createDiffRow("URL",t.url,n.url)),t.method!==n.method&&(e+=this.createDiffRow("Method",t.method,n.method)),JSON.stringify(t.headers)!==JSON.stringify(n.headers)&&(e+=this.createHeadersDiff(t.headers,n.headers)),t.body!==n.body&&(e+=this.createBodyDiff(t.body,n.body)),t.prerequest!==n.prerequest&&(e+=this.createScriptDiff("Pre-request Script",t.prerequest,n.prerequest)),t.tests!==n.tests&&(e+=this.createScriptDiff("Test Script",t.tests,n.tests)),e+="</tbody></table>",e}createDiffRow(t,n,e){let s="";return n&&e?(s+="<tr>",s+='<td class="d2h-code-linenumber d2h-del">-</td>',s+=`<td class="d2h-del"><div class="d2h-code-line">- ${t}: ${n}</div></td>`,s+="</tr>",s+="<tr>",s+='<td class="d2h-code-linenumber d2h-ins">+</td>',s+=`<td class="d2h-ins"><div class="d2h-code-line">+ ${t}: ${e}</div></td>`,s+="</tr>"):n?(s+="<tr>",s+='<td class="d2h-code-linenumber d2h-del">-</td>',s+=`<td class="d2h-del"><div class="d2h-code-line">- ${t}: ${n}</div></td>`,s+="</tr>"):e&&(s+="<tr>",s+='<td class="d2h-code-linenumber d2h-ins">+</td>',s+=`<td class="d2h-ins"><div class="d2h-code-line">+ ${t}: ${e}</div></td>`,s+="</tr>"),s}createHeadersDiff(t,n){let e="";const s=t||{},i=n||{};return new Set([...Object.keys(s),...Object.keys(i)]).forEach(l=>{s[l]!==i[l]&&(e+=this.createDiffRow(`Header[${l}]`,s[l],i[l]))}),e}createBodyDiff(t,n){if(!t&&!n)return"";let e='<tr><td colspan="2" style="background: #f8f8f8; padding: 4px; font-weight: bold;">Request Body:</td></tr>',s=t,i=n;try{t&&(s=JSON.stringify(JSON.parse(t),null,2))}catch{}try{n&&(i=JSON.stringify(JSON.parse(n),null,2))}catch{}const o=Ee(s||"",i||"");return e+=this.renderDiffWithContext(o,3),e}createScriptDiff(t,n,e){if(!n&&!e)return"";let s=`<tr><td colspan="2" style="background: #f8f8f8; padding: 4px; font-weight: bold;">${t}:</td></tr>`;const i=Array.isArray(n)?n.join(`
`):n||"",o=Array.isArray(e)?e.join(`
`):e||"",l=Ee(i,o);return s+=this.renderDiffWithContext(l,3),s}renderDiffWithContext(t,n=3){let e="",s=1,i=1;return t.forEach(o=>{if(!o.added&&!o.removed){const l=o.value.split(`
`).filter(a=>a!=="");if(l.length>n*2){for(let f=0;f<n;f++)l[f]&&(e+="<tr>",e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">${s++}</td>`,e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">${i++}</td>`,e+=`<td><div class="d2h-code-line">${this.highlightCode(l[f])}</div></td>`,e+="</tr>");const a=l.length-n*2;if(a>0){e+='<tr class="d2h-context-control">',e+='<td class="d2h-code-linenumber" style="text-align: center;">...</td>',e+='<td class="d2h-code-linenumber" style="text-align: center;">...</td>',e+=`<td><div class="d2h-code-line" style="color: #999; cursor: pointer;" onclick="this.parentElement.parentElement.classList.toggle('expanded')">`,e+=`‚Üï ${a} unchanged lines hidden (click to expand)`,e+="</div></td>",e+="</tr>",e+='<tr class="d2h-context-hidden" style="display: none;">',e+='<td colspan="3"><div style="max-height: 200px; overflow-y: auto;">';for(let f=n;f<l.length-n;f++)l[f]&&(e+=`<div class="d2h-code-line"><span style="color: #999; margin-right: 10px;">${s++}</span>${this.highlightCode(l[f])}</div>`,i++);e+="</div></td></tr>"}for(let f=Math.max(0,l.length-n);f<l.length;f++)l[f]&&(e+="<tr>",e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">${s++}</td>`,e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">${i++}</td>`,e+=`<td><div class="d2h-code-line">${this.highlightCode(l[f])}</div></td>`,e+="</tr>")}else l.forEach(a=>{a&&(e+="<tr>",e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">${s++}</td>`,e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">${i++}</td>`,e+=`<td><div class="d2h-code-line">${this.highlightCode(a)}</div></td>`,e+="</tr>")})}else o.removed?o.value.split(`
`).filter(a=>a!=="").forEach(a=>{e+='<tr class="d2h-del">',e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right;">${s++}</td>`,e+='<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">-</td>',e+=`<td><div class="d2h-code-line">${this.highlightCode(a)}</div></td>`,e+="</tr>"}):o.added&&o.value.split(`
`).filter(a=>a!=="").forEach(a=>{e+='<tr class="d2h-ins">',e+='<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">-</td>',e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right;">${i++}</td>`,e+=`<td><div class="d2h-code-line">${this.highlightCode(a)}</div></td>`,e+="</tr>"})}),e}highlightCode(t){return this.escapeHtml(t)}escapeHtml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}getChangeSummary(t){let n=0,e=0,s=0;return t.forEach(i=>{i.added?n++:i.removed?e++:s++}),{added:n,removed:e,modified:s}}}class We{state={};components={};differ={};constructor(){this.initializeState(),this.initializeComponents(),this.setupEventHandlers(),console.log("Postman Diff App initialized")}initializeState(){this.state={oldCollection:null,newCollection:null,normalizedOld:null,normalizedNew:null,diffResult:null,diffOptions:{ignoreOrder:!1,ignoreWhitespace:!0,normalizeJson:!0,sortKeys:!0},isProcessing:!1,error:null}}initializeComponents(){try{this.createFileInputContainer(),this.components={oldFileInput:new ue("old-file-input","Old Collection"),newFileInput:new ue("new-file-input","New Collection"),diffViewer:new $e("diff-container"),treeView:new Le("tree-view-container",{onNodeSelect:t=>this.handleNodeSelection(t),onNodeToggle:t=>this.handleNodeToggle(t)}),optionToggles:new Se("option-toggles-container",{onOptionsChange:t=>this.handleOptionsChange(t)}),exportControls:new ke("export-controls-container",{onExport:(t,n)=>this.handleExport(t,n)})},this.differ=new ze,console.log("All components initialized successfully")}catch(t){this.handleError("Failed to initialize components: "+t.message)}}createFileInputContainer(){const t=document.getElementById("file-inputs-container");t&&(t.innerHTML=`
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 min-w-0 lg:min-w-[500px]">
          <div id="old-file-input"></div>
          <div id="new-file-input"></div>
        </div>
      `)}setupEventHandlers(){this.components.oldFileInput.onLoad(t=>{this.handleFileLoad("old",t)}),this.components.newFileInput.onLoad(t=>{this.handleFileLoad("new",t)}),this.components.optionToggles.setOptions(this.state.diffOptions)}async handleFileLoad(t,n){try{this.setProcessing(!0),this.clearError(),t==="old"?this.state.oldCollection=n:this.state.newCollection=n;const e=le.normalize(n);t==="old"?this.state.normalizedOld=e:this.state.normalizedNew=e,this.components.treeView.loadCollection(e,t),await this.tryGenerateDiff()}catch(e){this.handleError(`Failed to load ${t} collection: `+e.message)}finally{this.setProcessing(!1)}}async handleOptionsChange(t){try{this.state.diffOptions=t,this.differ=new ze,this.state.oldCollection&&this.state.newCollection&&await this.tryGenerateDiff()}catch(n){this.handleError("Failed to update options: "+n.message)}}handleNodeSelection(t){console.log("Node selected:",t)}handleNodeToggle(t){console.log("Node toggled:",t)}handleExport(t,n){console.log(`Exporting as ${t}:`,n)}async tryGenerateDiff(){if(!(!this.state.oldCollection||!this.state.newCollection))try{this.setProcessing(!0),this.clearError();const t=this.differ.diff(this.state.oldCollection,this.state.newCollection);this.state.diffResult=t,this.components.diffViewer.showDiff(t),this.state.normalizedOld&&this.state.normalizedNew&&this.components.treeView.updateWithDiff(this.state.normalizedOld,this.state.normalizedNew),this.components.exportControls.updateData({oldCollection:this.state.normalizedOld||void 0,newCollection:this.state.normalizedNew||void 0,diffResult:t,options:this.state.diffOptions}),console.log("Diff generated successfully")}catch(t){this.handleError("Failed to generate diff: "+t.message)}finally{this.setProcessing(!1)}}setProcessing(t){this.state.isProcessing=t;const n=document.getElementById("loading-indicator");n&&(t?n.classList.remove("hidden"):n.classList.add("hidden")),this.components.optionToggles.setEnabled(!t),this.components.exportControls.setEnabled(!t)}handleError(t){this.state.error=t,console.error("App Error:",t),this.showErrorMessage(t)}clearError(){this.state.error=null,this.hideErrorMessage()}showErrorMessage(t){let n=document.getElementById("error-message");if(!n){n=document.createElement("div"),n.id="error-message",n.className="error-message";const e=document.querySelector(".right-panel .panel-content");e&&e.insertBefore(n,e.firstChild)}n.innerHTML=`
      <div class="error-content">
        <span class="error-icon">‚ö†Ô∏è</span>
        <span class="error-text">${t}</span>
        <button class="error-close" onclick="this.parentElement.parentElement.style.display='none'">√ó</button>
      </div>
    `,n.style.display="block"}hideErrorMessage(){const t=document.getElementById("error-message");t&&(t.style.display="none")}getState(){return{...this.state}}reset(){this.initializeState(),this.components.diffViewer.clear(),this.components.treeView.clear(),this.components.optionToggles.setOptions(this.state.diffOptions),this.components.exportControls.updateData({}),this.clearError(),this.setProcessing(!1)}}const Ye=new We;window.postmanDiffApp=Ye;
