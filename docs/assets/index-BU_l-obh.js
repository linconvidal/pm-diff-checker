(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();class Pe{element;onFileLoad;constructor(t,n){const e=document.getElementById(t);if(!e)throw new Error(`Container with id "${t}" not found`);this.element=this.createElement(n),e.appendChild(this.element)}createElement(t){const n=document.createElement("div");n.className="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-xl p-6 transition-all duration-300 hover:border-blue-500 dark:hover:border-blue-400 hover:shadow-lg",n.innerHTML=`
      <div class="flex flex-col gap-4">
        <label class="text-lg font-semibold text-zinc-900 dark:text-zinc-100">${t}</label>
        <input 
          type="file" 
          accept=".json" 
          class="w-full p-6 border-2 border-dashed border-zinc-300 dark:border-zinc-600 rounded-lg bg-zinc-50 dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100 cursor-pointer transition-all duration-300 hover:border-blue-500 dark:hover:border-blue-400 hover:bg-blue-50 dark:hover:bg-blue-950/20 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
        />
        <div class="file-status text-zinc-600 dark:text-zinc-400">No file selected</div>
      </div>
    `;const e=n.querySelector('input[type="file"]'),s=n.querySelector(".file-status");return e.addEventListener("change",r=>{const o=r.target.files?.[0];if(!o){s.textContent="No file selected",s.className="file-status text-zinc-600 dark:text-zinc-400";return}s.textContent=`Loading ${o.name}...`,s.className="file-status loading",this.loadFile(o).then(a=>{s.textContent=`‚úì ${o.name}`,s.className="file-status success",this.onFileLoad?.(a)}).catch(a=>{s.textContent=`‚úó Error: ${a.message}`,s.className="file-status error"})}),n}async loadFile(t){return new Promise((n,e)=>{const s=new FileReader;s.onload=r=>{try{const o=r.target?.result,a=JSON.parse(o);if(!a.info||!a.info.name)throw new Error("Invalid Postman collection format");n(a)}catch{e(new Error("Failed to parse JSON file"))}},s.onerror=()=>{e(new Error("Failed to read file"))},s.readAsText(t)})}onLoad(t){this.onFileLoad=t}}class rt{element;constructor(t){const n=document.getElementById(t);if(!n)throw new Error(`Container with id "${t}" not found`);this.element=this.createElement(),n.appendChild(this.element)}createElement(){const t=document.createElement("div");return t.className="diff-viewer",t.innerHTML=`
      <div class="diff-header">
        <h2>Collection Diff</h2>
        <div class="diff-stats"></div>
      </div>
      <div class="diff-content">
        <div class="diff-placeholder">
          Select two Postman collections to see the differences
        </div>
      </div>
    `,t}showDiff(t){const n=this.element.querySelector(".diff-content"),e=this.element.querySelector(".diff-stats"),s=this.calculateStats(t);e.innerHTML=`
      <span class="stat added">+${s.added} added</span>
      <span class="stat removed">-${s.removed} removed</span>
      <span class="stat modified">~${s.modified} modified</span>
    `,n.innerHTML=t.htmlDiff,this.enhanceDiffDisplay(n)}calculateStats(t){const n={added:0,removed:0,modified:0};return t.patches.forEach(e=>{e.added?n.added++:e.removed?n.removed++:e.value.trim()&&n.modified++}),n}enhanceDiffDisplay(t){t.querySelectorAll("code").forEach(e=>{e.classList.contains("enhanced")||(e.classList.add("enhanced"),this.addLineNumbers(e))}),this.addCollapseFeature(t)}addLineNumbers(t){const e=t.innerHTML.split(`
`).map((s,r)=>`<span class="line-number">${r+1}</span>${s}`);t.innerHTML=e.join(`
`)}addCollapseFeature(t){t.querySelectorAll(".d2h-file-wrapper").forEach(e=>{const s=e.querySelector(".d2h-file-header");s&&s.addEventListener("click",()=>{const r=e.querySelector(".d2h-file-diff");r&&r.classList.toggle("collapsed")})})}clear(){const t=this.element.querySelector(".diff-content"),n=this.element.querySelector(".diff-stats");t.innerHTML='<div class="diff-placeholder">Select two Postman collections to see the differences</div>',n.innerHTML=""}}class ot{element;options;tree=[];selectedNode=null;constructor(t,n={}){const e=document.getElementById(t);if(!e)throw new Error(`Container with id "${t}" not found`);this.options={showChangeIndicators:!0,expandAll:!1,...n},this.element=this.createElement(),e.appendChild(this.element)}createElement(){const t=document.createElement("div");return t.className="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg overflow-hidden transition-colors duration-300",t.innerHTML=`
      <div class="bg-zinc-50 dark:bg-zinc-800 border-b border-zinc-200 dark:border-zinc-700 px-4 py-3 flex justify-between items-center transition-colors duration-300">
        <h3 class="font-semibold text-zinc-900 dark:text-zinc-100">Collection Structure</h3>
        <div class="flex gap-2">
          <button class="tree-control-btn px-2 py-1 text-xs bg-transparent border border-zinc-300 dark:border-zinc-600 text-zinc-600 dark:text-zinc-400 rounded hover:bg-zinc-100 dark:hover:bg-zinc-700 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors duration-200" data-action="expand-all" title="Expand All">
            <span class="icon">‚äû</span>
          </button>
          <button class="tree-control-btn px-2 py-1 text-xs bg-transparent border border-zinc-300 dark:border-zinc-600 text-zinc-600 dark:text-zinc-400 rounded hover:bg-zinc-100 dark:hover:bg-zinc-700 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors duration-200" data-action="collapse-all" title="Collapse All">
            <span class="icon">‚äü</span>
          </button>
        </div>
      </div>
      <div class="max-h-96 overflow-y-auto p-2">
        <div class="tree-placeholder text-center text-zinc-500 dark:text-zinc-400 py-8 italic">
          Load collections to see structure
        </div>
      </div>
    `,this.setupEventListeners(t),t}setupEventListeners(t){t.addEventListener("click",n=>{const e=n.target,s=e.closest(".tree-control-btn");if(s){const o=s.dataset.action;o==="expand-all"?this.expandAll():o==="collapse-all"&&this.collapseAll()}const r=e.closest(".tree-node");if(r){const o=r.dataset.nodeId,a=this.findNodeById(o);a&&(e.classList.contains("tree-toggle")?this.toggleNode(a):this.selectNode(a))}})}loadCollection(t,n="diff"){this.tree=this.buildTree(t,n),this.render()}updateWithDiff(t,n){const e=this.buildTree(t,"old"),s=this.buildTree(n,"new");this.tree=this.mergeTrees(e,s),this.render()}buildTree(t,n){return[{id:"collection-"+t.info.name.replace(/[^a-zA-Z0-9]/g,"-"),name:t.info.name,type:"collection",expanded:!0,children:this.buildItemNodes(t.items,n),changeType:n==="diff"?"unchanged":void 0}]}buildItemNodes(t,n){return t.map(e=>({id:e.id,name:e.name,type:e.children?"folder":"request",method:e.method,expanded:this.options.expandAll,children:e.children?this.buildItemNodes(e.children,n):void 0,changeType:n==="diff"?"unchanged":void 0}))}mergeTrees(t,n){const e=[],s=new Set;return n.forEach(r=>{e.push({...r,changeType:"added"}),s.add(r.id)}),t.forEach(r=>{s.has(r.id)||e.push({...r,changeType:"removed"})}),e}render(){const t=this.element.querySelector(".max-h-96");if(this.tree.length===0){t.innerHTML='<div class="tree-placeholder text-center text-zinc-500 dark:text-zinc-400 py-8 italic">Load collections to see structure</div>';return}t.innerHTML=this.renderNodes(this.tree)}renderNodes(t,n=0){return t.map(e=>this.renderNode(e,n)).join("")}renderNode(t,n){const e=t.children&&t.children.length>0,s=t.expanded,r=t.selected?"bg-blue-100 dark:bg-blue-900/30":"hover:bg-zinc-100 dark:hover:bg-zinc-800",o=n*16;let a="";t.type==="collection"?a="üìÅ":t.type==="folder"?a="üìÇ":t.type==="request"&&(a=`<span class="${t.method?`method-badge ${t.method.toLowerCase()}`:"method-badge get"}">${t.method||"GET"}</span>`);let l="";e&&(l=`<button class="tree-toggle w-4 h-4 flex items-center justify-center text-zinc-500 dark:text-zinc-400 hover:text-zinc-700 dark:hover:text-zinc-200 mr-2 text-xs transition-colors duration-200">${s?"‚ñº":"‚ñ∂"}</button>`);let d="";if(this.options.showChangeIndicators&&t.changeType){const b={added:"+",removed:"-",modified:"~",unchanged:""};b[t.changeType]&&(d=`<span class="change-indicator change-${t.changeType}">${b[t.changeType]}</span>`)}let h="";return e&&s&&(h=`<div class="border-l border-zinc-200 dark:border-zinc-700 ml-3">${this.renderNodes(t.children,n+1)}</div>`),`
      <div class="my-0.5 rounded transition-colors duration-150 ${r}" data-node-id="${t.id}">
        <div class="flex items-center py-1 px-2 cursor-pointer min-h-[28px]" style="padding-left: ${o+8}px">
          ${l}
          <span class="mr-2 text-sm flex-shrink-0">${a}</span>
          <span class="flex-1 text-zinc-900 dark:text-zinc-100 text-sm truncate">${t.name}</span>
          ${d}
        </div>
        ${h}
      </div>
    `}findNodeById(t){const n=e=>{for(const s of e){if(s.id===t)return s;if(s.children){const r=n(s.children);if(r)return r}}return null};return n(this.tree)}toggleNode(t){t.expanded=!t.expanded,this.render(),this.options.onNodeToggle?.(t)}selectNode(t){this.selectedNode&&(this.selectedNode.selected=!1),t.selected=!0,this.selectedNode=t,this.render(),this.options.onNodeSelect?.(t)}expandAll(){const t=n=>{n.forEach(e=>{e.expanded=!0,e.children&&t(e.children)})};t(this.tree),this.render()}collapseAll(){const t=n=>{n.forEach(e=>{e.expanded=!1,e.children&&t(e.children)})};t(this.tree),this.render()}getSelectedNode(){return this.selectedNode}clear(){this.tree=[],this.selectedNode=null,this.render()}}class at{element;options;toggleOptions;onOptionsChange;constructor(t,n={}){const e=document.getElementById(t);if(!e)throw new Error(`Container with id "${t}" not found`);this.onOptionsChange=n.onOptionsChange,this.toggleOptions=[{key:"ignoreOrder",label:"Ignore Order",description:"Ignore the order of items when comparing",defaultValue:!1},{key:"ignoreWhitespace",label:"Ignore Whitespace",description:"Normalize whitespace differences",defaultValue:!0},{key:"normalizeJson",label:"Normalize JSON",description:"Standardize JSON formatting before comparison",defaultValue:!0},{key:"sortKeys",label:"Sort Keys",description:"Sort object keys alphabetically",defaultValue:!0}],this.options=this.toggleOptions.reduce((s,r)=>(s[r.key]=r.defaultValue,s),{}),this.element=this.createElement(),e.appendChild(this.element)}createElement(){const t=document.createElement("div");return t.className="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg overflow-hidden transition-colors duration-300",t.innerHTML=`
      <div class="bg-zinc-50 dark:bg-zinc-800 border-b border-zinc-200 dark:border-zinc-700 px-4 py-3 flex justify-between items-center transition-colors duration-300">
        <h3 class="font-semibold text-zinc-900 dark:text-zinc-100">Comparison Options</h3>
        <button class="toggle-control-btn px-2 py-1 text-xs bg-transparent border border-zinc-300 dark:border-zinc-600 text-zinc-600 dark:text-zinc-400 rounded hover:bg-zinc-100 dark:hover:bg-zinc-700 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors duration-200" data-action="reset" title="Reset to Defaults">
          <span class="icon">‚Ü∫</span>
        </button>
      </div>
      <div class="p-4 space-y-4">
        ${this.renderToggles()}
      </div>
    `,this.setupEventListeners(t),t}renderToggles(){return this.toggleOptions.map(t=>{const n=this.options[t.key],e=n?"toggle-switch checked":"toggle-switch";return`
        <div class="toggle-option">
          <label class="flex items-center gap-3 cursor-pointer">
            <input 
              type="checkbox" 
              class="toggle-input sr-only" 
              data-option="${t.key}"
              ${n?"checked":""}
            >
            <span class="${e}">
              <span class="toggle-slider"></span>
            </span>
            <div class="flex-1">
              <span class="block text-zinc-900 dark:text-zinc-100 font-medium text-sm">${t.label}</span>
              <span class="block text-zinc-600 dark:text-zinc-400 text-xs mt-0.5">${t.description}</span>
            </div>
          </label>
        </div>
      `}).join("")}setupEventListeners(t){t.addEventListener("click",n=>{const s=n.target.closest(".toggle-control-btn");if(s){s.dataset.action==="reset"&&this.resetToDefaults();return}}),t.addEventListener("change",n=>{const e=n.target;if(e.classList.contains("toggle-input")){const s=e.dataset.option;s&&this.updateOption(s,e.checked)}})}updateOption(t,n){this.options[t]=n,this.updateToggleDisplay(t,n),this.onOptionsChange?.(this.options)}updateToggleDisplay(t,n){const e=this.element.querySelector(`[data-option="${t}"]`)?.closest(".toggle-option");e&&(n?e.classList.add("checked"):e.classList.remove("checked"))}resetToDefaults(){this.toggleOptions.forEach(t=>{this.options[t.key]=t.defaultValue;const n=this.element.querySelector(`[data-option="${t.key}"]`);n&&(n.checked=t.defaultValue,this.updateToggleDisplay(t.key,t.defaultValue))}),this.onOptionsChange?.(this.options)}getOptions(){return{...this.options}}setOptions(t){Object.entries(t).forEach(([n,e])=>{if(typeof e=="boolean"){this.updateOption(n,e);const s=this.element.querySelector(`[data-option="${n}"]`);s&&(s.checked=e)}})}setEnabled(t){const n=this.element.querySelectorAll(".toggle-input"),e=this.element.querySelector(".toggle-control-btn");n.forEach(s=>{s.disabled=!t}),e&&(e.disabled=!t),t?this.element.classList.remove("opacity-50","pointer-events-none"):this.element.classList.add("opacity-50","pointer-events-none")}}class lt{element;currentData={};onExport;constructor(t,n={}){const e=document.getElementById(t);if(!e)throw new Error(`Container with id "${t}" not found`);this.onExport=n.onExport,this.element=this.createElement(),e.appendChild(this.element)}createElement(){const t=document.createElement("div");return t.className="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg overflow-hidden min-w-[200px] transition-colors duration-300",t.innerHTML=`
      <div class="bg-zinc-50 dark:bg-zinc-800 border-b border-zinc-200 dark:border-zinc-700 px-4 py-3 transition-colors duration-300">
        <h3 class="font-semibold text-zinc-900 dark:text-zinc-100 text-sm">Export Results</h3>
      </div>
      <div class="p-4">
        <div class="flex flex-col gap-2 mb-4">
          <button class="export-btn flex items-center gap-2 bg-zinc-100 dark:bg-zinc-800 hover:bg-zinc-200 dark:hover:bg-zinc-700 border border-zinc-300 dark:border-zinc-600 text-zinc-900 dark:text-zinc-100 px-3 py-2 rounded-md cursor-pointer transition-all duration-200 text-sm disabled:opacity-50 disabled:cursor-not-allowed" data-format="markdown" title="Export as Markdown Report">
            <span class="text-base">üìÑ</span>
            <span class="font-medium">Markdown Report</span>
          </button>
          <button class="export-btn flex items-center gap-2 bg-zinc-100 dark:bg-zinc-800 hover:bg-zinc-200 dark:hover:bg-zinc-700 border border-zinc-300 dark:border-zinc-600 text-zinc-900 dark:text-zinc-100 px-3 py-2 rounded-md cursor-pointer transition-all duration-200 text-sm disabled:opacity-50 disabled:cursor-not-allowed" data-format="json" title="Export as JSON Data">
            <span class="text-base">üìã</span>
            <span class="font-medium">JSON Data</span>
          </button>
        </div>
        <div class="export-status info text-zinc-600 dark:text-zinc-400 text-xs">
          Ready to export when diff is available
        </div>
      </div>
    `,this.setupEventListeners(t),t}setupEventListeners(t){t.addEventListener("click",n=>{const s=n.target.closest(".export-btn");if(s){const r=s.dataset.format;r&&this.handleExport(r)}})}handleExport(t){if(!this.currentData.diffResult){this.showStatus("No diff data available to export","error");return}this.showStatus("Preparing export...","loading");try{this.onExport?.(t,this.currentData),t==="markdown"?this.exportMarkdown():t==="json"&&this.exportJson(),this.showStatus("Export completed successfully","success")}catch(n){this.showStatus("Export failed: "+n.message,"error")}}exportMarkdown(){const t=this.generateMarkdownReport();this.downloadFile(t,"postman-diff-report.md","text/markdown")}exportJson(){const t=JSON.stringify(this.currentData,null,2);this.downloadFile(t,"postman-diff-data.json","application/json")}generateMarkdownReport(){const{diffResult:t,oldCollection:n,newCollection:e}=this.currentData;if(!t)return`# Postman Collection Diff Report

No diff data available.`;const s=n?.info.name||"Old Collection",r=e?.info.name||"New Collection";let a=`# Postman Collection Diff Report

**Generated:** ${new Date().toISOString()}
**Comparing:** ${s} ‚Üí ${r}

## Summary

`;if(t.patches){const l=this.calculateStats(t.patches);a+=`
- **Added:** ${l.added} items
- **Removed:** ${l.removed} items  
- **Modified:** ${l.modified} items

`}return a+=`## Detailed Changes

\`\`\`diff
${t.oldCollection}
---
${t.newCollection}
\`\`\`

## Change Patches

`,t.patches&&t.patches.forEach((l,d)=>{const h=l.added?"Added":l.removed?"Removed":"Modified";a+=`### Change ${d+1}: ${h}

\`\`\`
${l.value}
\`\`\`

`}),a+=`
---
*Report generated by Postman Collection Diff Viewer*
`,a}calculateStats(t){let n=0,e=0,s=0;return t.forEach(r=>{r.added?n++:r.removed?e++:s++}),{added:n,removed:e,modified:s}}downloadFile(t,n,e){const s=new Blob([t],{type:e}),r=URL.createObjectURL(s),o=document.createElement("a");o.href=r,o.download=n,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}showStatus(t,n="info"){const e=this.element.querySelector(".export-status");e&&(e.textContent=t,e.className=`export-status ${n}`,(n==="success"||n==="error")&&setTimeout(()=>{e.textContent="Ready to export when diff is available",e.className="export-status"},3e3))}updateData(t){this.currentData={...this.currentData,...t},this.updateButtonStates()}updateButtonStates(){const t=this.element.querySelectorAll(".export-btn"),n=!!this.currentData.diffResult;t.forEach(e=>{e.disabled=!n}),n?this.showStatus("Ready to export","success"):this.showStatus("Ready to export when diff is available","info")}setEnabled(t){this.element.querySelectorAll(".export-btn").forEach(e=>{e.disabled=!t||!this.currentData.diffResult}),t?this.element.classList.remove("opacity-50","pointer-events-none"):this.element.classList.add("opacity-50","pointer-events-none")}}var D;(function(i){i.INSERT="insert",i.DELETE="delete",i.CONTEXT="context"})(D||(D={}));const ct={LINE_BY_LINE:"line-by-line"},dt={NONE:"none"},ft={WORD:"word"};var ee;(function(i){i.AUTO="auto",i.DARK="dark",i.LIGHT="light"})(ee||(ee={}));const ut=["-","[","]","/","{","}","(",")","*","+","?",".","\\","^","$","|"],ht=RegExp("["+ut.join("\\")+"]","g");function pt(i){return i.replace(ht,"\\$&")}function $e(i){return i&&i.replace(/\\/g,"/")}function mt(i){let t,n,e,s=0;for(t=0,e=i.length;t<e;t++)n=i.charCodeAt(t),s=(s<<5)-s+n,s|=0;return s}function Ye(i){const t=i.length;let n=-1/0;for(let e=0;e<t;e++)n=Math.max(n,i[e]);return n}function Fe(i,t){const n=i.split(".");return n.length>1?n[n.length-1]:t}function Me(i,t){return t.reduce((n,e)=>n||i.startsWith(e),!1)}const Ae=["a/","b/","i/","w/","c/","o/"];function X(i,t,n){const e=n!==void 0?[...Ae,n]:Ae,s=t?new RegExp(`^${pt(t)} "?(.+?)"?$`):new RegExp('^"?(.+?)"?$'),[,r=""]=s.exec(i)||[],o=e.find(l=>r.indexOf(l)===0);return(o?r.slice(o.length):r).replace(/\s+\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}(?:\.\d+)? [+-]\d{4}.*$/,"")}function gt(i,t){return X(i,"---",t)}function bt(i,t){return X(i,"+++",t)}function vt(i,t={}){const n=[];let e=null,s=null,r=null,o=null,a=null,l=null,d=null;const h="--- ",b="+++ ",z="@@",c=/^old mode (\d{6})/,f=/^new mode (\d{6})/,g=/^deleted file mode (\d{6})/,p=/^new file mode (\d{6})/,C=/^copy from "?(.+)"?/,E=/^copy to "?(.+)"?/,w=/^rename from "?(.+)"?/,N=/^rename to "?(.+)"?/,T=/^similarity index (\d+)%/,S=/^dissimilarity index (\d+)%/,M=/^index ([\da-z]+)\.\.([\da-z]+)\s*(\d{6})?/,u=/^Binary files (.*) and (.*) differ/,m=/^GIT binary patch/,y=/^index ([\da-z]+),([\da-z]+)\.\.([\da-z]+)/,L=/^mode (\d{6}),(\d{6})\.\.(\d{6})/,$=/^new file mode (\d{6})/,R=/^deleted file mode (\d{6}),(\d{6})/,H=i.replace(/\\ No newline at end of file/g,"").replace(/\r\n?/g,`
`).split(`
`);function k(){s!==null&&e!==null&&(e.blocks.push(s),s=null)}function _(){e!==null&&(!e.oldName&&l!==null&&(e.oldName=l),!e.newName&&d!==null&&(e.newName=d),e.newName&&(n.push(e),e=null)),l=null,d=null}function Y(){k(),_(),e={blocks:[],deletedLines:0,addedLines:0}}function B(v){k();let O;e!==null&&((O=/^@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@.*/.exec(v))?(e.isCombined=!1,r=parseInt(O[1],10),a=parseInt(O[2],10)):(O=/^@@@ -(\d+)(?:,\d+)? -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@@.*/.exec(v))?(e.isCombined=!0,r=parseInt(O[1],10),o=parseInt(O[2],10),a=parseInt(O[3],10)):(v.startsWith(z)&&console.error("Failed to parse lines, starting in 0!"),r=0,a=0,e.isCombined=!1)),s={lines:[],oldStartLine:r,oldStartLine2:o,newStartLine:a,header:v}}function F(v){if(e===null||s===null||r===null||a===null)return;const O={content:v},x=e.isCombined?["+ "," +","++"]:["+"],W=e.isCombined?["- "," -","--"]:["-"];Me(v,x)?(e.addedLines++,O.type=D.INSERT,O.oldNumber=void 0,O.newNumber=a++):Me(v,W)?(e.deletedLines++,O.type=D.DELETE,O.oldNumber=r++,O.newNumber=void 0):(O.type=D.CONTEXT,O.oldNumber=r++,O.newNumber=a++),s.lines.push(O)}function Q(v,O){let x=O;for(;x<H.length-3;){if(v.startsWith("diff"))return!1;if(H[x].startsWith(h)&&H[x+1].startsWith(b)&&H[x+2].startsWith(z))return!0;x++}return!1}return H.forEach((v,O)=>{if(!v||v.startsWith("*"))return;let x;const W=H[O-1],ne=H[O+1],pe=H[O+2];if(v.startsWith("diff --git")||v.startsWith("diff --combined")){if(Y(),(x=/^diff --git "?([a-ciow]\/.+)"? "?([a-ciow]\/.+)"?/.exec(v))&&(l=X(x[1],void 0,t.dstPrefix),d=X(x[2],void 0,t.srcPrefix)),e===null)throw new Error("Where is my file !!!");e.isGitDiff=!0;return}if(v.startsWith("Binary files")&&!e?.isGitDiff){if(Y(),(x=/^Binary files "?([a-ciow]\/.+)"? and "?([a-ciow]\/.+)"? differ/.exec(v))&&(l=X(x[1],void 0,t.dstPrefix),d=X(x[2],void 0,t.srcPrefix)),e===null)throw new Error("Where is my file !!!");e.isBinary=!0;return}if((!e||!e.isGitDiff&&e&&v.startsWith(h)&&ne.startsWith(b)&&pe.startsWith(z))&&Y(),e?.isTooBig)return;if(e&&(typeof t.diffMaxChanges=="number"&&e.addedLines+e.deletedLines>t.diffMaxChanges||typeof t.diffMaxLineLength=="number"&&v.length>t.diffMaxLineLength)){e.isTooBig=!0,e.addedLines=0,e.deletedLines=0,e.blocks=[],s=null;const ie=typeof t.diffTooBigMessage=="function"?t.diffTooBigMessage(n.length):"Diff too big to be displayed";B(ie);return}if(v.startsWith(h)&&ne.startsWith(b)||v.startsWith(b)&&W.startsWith(h)){if(e&&!e.oldName&&v.startsWith("--- ")&&(x=gt(v,t.srcPrefix))){e.oldName=x,e.language=Fe(e.oldName,e.language);return}if(e&&!e.newName&&v.startsWith("+++ ")&&(x=bt(v,t.dstPrefix))){e.newName=x,e.language=Fe(e.newName,e.language);return}}if(e&&(v.startsWith(z)||e.isGitDiff&&e.oldName&&e.newName&&!s)){B(v);return}if(s&&(v.startsWith("+")||v.startsWith("-")||v.startsWith(" "))){F(v);return}const Z=!Q(v,O);if(e===null)throw new Error("Where is my file !!!");(x=c.exec(v))?e.oldMode=x[1]:(x=f.exec(v))?e.newMode=x[1]:(x=g.exec(v))?(e.deletedFileMode=x[1],e.isDeleted=!0):(x=p.exec(v))?(e.newFileMode=x[1],e.isNew=!0):(x=C.exec(v))?(Z&&(e.oldName=x[1]),e.isCopy=!0):(x=E.exec(v))?(Z&&(e.newName=x[1]),e.isCopy=!0):(x=w.exec(v))?(Z&&(e.oldName=x[1]),e.isRename=!0):(x=N.exec(v))?(Z&&(e.newName=x[1]),e.isRename=!0):(x=u.exec(v))?(e.isBinary=!0,e.oldName=X(x[1],void 0,t.srcPrefix),e.newName=X(x[2],void 0,t.dstPrefix),B("Binary file")):m.test(v)?(e.isBinary=!0,B(v)):(x=T.exec(v))?e.unchangedPercentage=parseInt(x[1],10):(x=S.exec(v))?e.changedPercentage=parseInt(x[1],10):(x=M.exec(v))?(e.checksumBefore=x[1],e.checksumAfter=x[2],x[3]&&(e.mode=x[3])):(x=y.exec(v))?(e.checksumBefore=[x[2],x[3]],e.checksumAfter=x[1]):(x=L.exec(v))?(e.oldMode=[x[2],x[3]],e.newMode=x[1]):(x=$.exec(v))?(e.newFileMode=x[1],e.isNew=!0):(x=R.exec(v))&&(e.deletedFileMode=x[1],e.isDeleted=!0)}),k(),_(),n}function q(){}q.prototype={diff:function(t,n){var e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=s.callback;typeof s=="function"&&(r=s,s={});var o=this;function a(N){return N=o.postProcess(N,s),r?(setTimeout(function(){r(N)},0),!0):N}t=this.castInput(t,s),n=this.castInput(n,s),t=this.removeEmpty(this.tokenize(t,s)),n=this.removeEmpty(this.tokenize(n,s));var l=n.length,d=t.length,h=1,b=l+d;s.maxEditLength!=null&&(b=Math.min(b,s.maxEditLength));var z=(e=s.timeout)!==null&&e!==void 0?e:1/0,c=Date.now()+z,f=[{oldPos:-1,lastComponent:void 0}],g=this.extractCommon(f[0],n,t,0,s);if(f[0].oldPos+1>=d&&g+1>=l)return a(He(o,f[0].lastComponent,n,t,o.useLongestToken));var p=-1/0,C=1/0;function E(){for(var N=Math.max(p,-h);N<=Math.min(C,h);N+=2){var T=void 0,S=f[N-1],M=f[N+1];S&&(f[N-1]=void 0);var u=!1;if(M){var m=M.oldPos-N;u=M&&0<=m&&m<l}var y=S&&S.oldPos+1<d;if(!u&&!y){f[N]=void 0;continue}if(!y||u&&S.oldPos<M.oldPos?T=o.addToPath(M,!0,!1,0,s):T=o.addToPath(S,!1,!0,1,s),g=o.extractCommon(T,n,t,N,s),T.oldPos+1>=d&&g+1>=l)return a(He(o,T.lastComponent,n,t,o.useLongestToken));f[N]=T,T.oldPos+1>=d&&(C=Math.min(C,N-1)),g+1>=l&&(p=Math.max(p,N+1))}h++}if(r)(function N(){setTimeout(function(){if(h>b||Date.now()>c)return r();E()||N()},0)})();else for(;h<=b&&Date.now()<=c;){var w=E();if(w)return w}},addToPath:function(t,n,e,s,r){var o=t.lastComponent;return o&&!r.oneChangePerToken&&o.added===n&&o.removed===e?{oldPos:t.oldPos+s,lastComponent:{count:o.count+1,added:n,removed:e,previousComponent:o.previousComponent}}:{oldPos:t.oldPos+s,lastComponent:{count:1,added:n,removed:e,previousComponent:o}}},extractCommon:function(t,n,e,s,r){for(var o=n.length,a=e.length,l=t.oldPos,d=l-s,h=0;d+1<o&&l+1<a&&this.equals(e[l+1],n[d+1],r);)d++,l++,h++,r.oneChangePerToken&&(t.lastComponent={count:1,previousComponent:t.lastComponent,added:!1,removed:!1});return h&&!r.oneChangePerToken&&(t.lastComponent={count:h,previousComponent:t.lastComponent,added:!1,removed:!1}),t.oldPos=l,d},equals:function(t,n,e){return e.comparator?e.comparator(t,n):t===n||e.ignoreCase&&t.toLowerCase()===n.toLowerCase()},removeEmpty:function(t){for(var n=[],e=0;e<t.length;e++)t[e]&&n.push(t[e]);return n},castInput:function(t){return t},tokenize:function(t){return Array.from(t)},join:function(t){return t.join("")},postProcess:function(t){return t}};function He(i,t,n,e,s){for(var r=[],o;t;)r.push(t),o=t.previousComponent,delete t.previousComponent,t=o;r.reverse();for(var a=0,l=r.length,d=0,h=0;a<l;a++){var b=r[a];if(b.removed)b.value=i.join(e.slice(h,h+b.count)),h+=b.count;else{if(!b.added&&s){var z=n.slice(d,d+b.count);z=z.map(function(c,f){var g=e[h+f];return g.length>c.length?g:c}),b.value=i.join(z)}else b.value=i.join(n.slice(d,d+b.count));d+=b.count,b.added||(h+=b.count)}}return r}var wt=new q;function yt(i,t,n){return wt.diff(i,t,n)}function Re(i,t){var n;for(n=0;n<i.length&&n<t.length;n++)if(i[n]!=t[n])return i.slice(0,n);return i.slice(0,n)}function Be(i,t){var n;if(!i||!t||i[i.length-1]!=t[t.length-1])return"";for(n=0;n<i.length&&n<t.length;n++)if(i[i.length-(n+1)]!=t[t.length-(n+1)])return i.slice(-n);return i.slice(-n)}function ye(i,t,n){if(i.slice(0,t.length)!=t)throw Error("string ".concat(JSON.stringify(i)," doesn't start with prefix ").concat(JSON.stringify(t),"; this is a bug"));return n+i.slice(t.length)}function xe(i,t,n){if(!t)return i+n;if(i.slice(-t.length)!=t)throw Error("string ".concat(JSON.stringify(i)," doesn't end with suffix ").concat(JSON.stringify(t),"; this is a bug"));return i.slice(0,-t.length)+n}function se(i,t){return ye(i,t,"")}function le(i,t){return xe(i,t,"")}function We(i,t){return t.slice(0,xt(i,t))}function xt(i,t){var n=0;i.length>t.length&&(n=i.length-t.length);var e=t.length;i.length<t.length&&(e=i.length);var s=Array(e),r=0;s[0]=0;for(var o=1;o<e;o++){for(t[o]==t[r]?s[o]=s[r]:s[o]=r;r>0&&t[o]!=t[r];)r=s[r];t[o]==t[r]&&r++}r=0;for(var a=n;a<i.length;a++){for(;r>0&&i[a]!=t[r];)r=s[r];i[a]==t[r]&&r++}return r}var ce="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",Ct=new RegExp("[".concat(ce,"]+|\\s+|[^").concat(ce,"]"),"ug"),fe=new q;fe.equals=function(i,t,n){return n.ignoreCase&&(i=i.toLowerCase(),t=t.toLowerCase()),i.trim()===t.trim()};fe.tokenize=function(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;if(t.intlSegmenter){if(t.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');n=Array.from(t.intlSegmenter.segment(i),function(r){return r.segment})}else n=i.match(Ct)||[];var e=[],s=null;return n.forEach(function(r){/\s/.test(r)?s==null?e.push(r):e.push(e.pop()+r):/\s/.test(s)?e[e.length-1]==s?e.push(e.pop()+r):e.push(s+r):e.push(r),s=r}),e};fe.join=function(i){return i.map(function(t,n){return n==0?t:t.replace(/^\s+/,"")}).join("")};fe.postProcess=function(i,t){if(!i||t.oneChangePerToken)return i;var n=null,e=null,s=null;return i.forEach(function(r){r.added?e=r:r.removed?s=r:((e||s)&&qe(n,s,e,r),n=r,e=null,s=null)}),(e||s)&&qe(n,s,e,null),i};function qe(i,t,n,e){if(t&&n){var s=t.value.match(/^\s*/)[0],r=t.value.match(/\s*$/)[0],o=n.value.match(/^\s*/)[0],a=n.value.match(/\s*$/)[0];if(i){var l=Re(s,o);i.value=xe(i.value,o,l),t.value=se(t.value,l),n.value=se(n.value,l)}if(e){var d=Be(r,a);e.value=ye(e.value,a,d),t.value=le(t.value,d),n.value=le(n.value,d)}}else if(n)i&&(n.value=n.value.replace(/^\s*/,"")),e&&(e.value=e.value.replace(/^\s*/,""));else if(i&&e){var h=e.value.match(/^\s*/)[0],b=t.value.match(/^\s*/)[0],z=t.value.match(/\s*$/)[0],c=Re(h,b);t.value=se(t.value,c);var f=Be(se(h,c),z);t.value=le(t.value,f),e.value=ye(e.value,h,f),i.value=xe(i.value,h,h.slice(0,h.length-f.length))}else if(e){var g=e.value.match(/^\s*/)[0],p=t.value.match(/\s*$/)[0],C=We(p,g);t.value=le(t.value,C)}else if(i){var E=i.value.match(/\s*$/)[0],w=t.value.match(/^\s*/)[0],N=We(E,w);t.value=se(t.value,N)}}var Qe=new q;Qe.tokenize=function(i){var t=new RegExp("(\\r?\\n)|[".concat(ce,"]+|[^\\S\\n\\r]+|[^").concat(ce,"]"),"ug");return i.match(t)||[]};function Et(i,t,n){return Qe.diff(i,t,n)}var Le=new q;Le.tokenize=function(i,t){t.stripTrailingCr&&(i=i.replace(/\r\n/g,`
`));var n=[],e=i.split(/(\n|\r\n)/);e[e.length-1]||e.pop();for(var s=0;s<e.length;s++){var r=e[s];s%2&&!t.newlineIsToken?n[n.length-1]+=r:n.push(r)}return n};Le.equals=function(i,t,n){return n.ignoreWhitespace?((!n.newlineIsToken||!i.includes(`
`))&&(i=i.trim()),(!n.newlineIsToken||!t.includes(`
`))&&(t=t.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(i.endsWith(`
`)&&(i=i.slice(0,-1)),t.endsWith(`
`)&&(t=t.slice(0,-1))),q.prototype.equals.call(this,i,t,n)};var Nt=new q;Nt.tokenize=function(i){return i.split(/(\S.+?[.!?])(?=\s+|$)/)};var Tt=new q;Tt.tokenize=function(i){return i.split(/([{}:;,]|\s+)/)};function Ce(i){"@babel/helpers - typeof";return Ce=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ce(i)}var ae=new q;ae.useLongestToken=!0;ae.tokenize=Le.tokenize;ae.castInput=function(i,t){var n=t.undefinedReplacement,e=t.stringifyReplacer,s=e===void 0?function(r,o){return typeof o>"u"?n:o}:e;return typeof i=="string"?i:JSON.stringify(Ee(i,null,null,s),s,"  ")};ae.equals=function(i,t,n){return q.prototype.equals.call(ae,i.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"),n)};function Ee(i,t,n,e,s){t=t||[],n=n||[],e&&(i=e(s,i));var r;for(r=0;r<t.length;r+=1)if(t[r]===i)return n[r];var o;if(Object.prototype.toString.call(i)==="[object Array]"){for(t.push(i),o=new Array(i.length),n.push(o),r=0;r<i.length;r+=1)o[r]=Ee(i[r],t,n,e,s);return t.pop(),n.pop(),o}if(i&&i.toJSON&&(i=i.toJSON()),Ce(i)==="object"&&i!==null){t.push(i),o={},n.push(o);var a=[],l;for(l in i)Object.prototype.hasOwnProperty.call(i,l)&&a.push(l);for(a.sort(),r=0;r<a.length;r+=1)l=a[r],o[l]=Ee(i[l],t,n,e,l);t.pop(),n.pop()}else o=i;return o}var Ne=new q;Ne.tokenize=function(i){return i.slice()};Ne.join=Ne.removeEmpty=function(i){return i};function zt(i,t){if(i.length===0)return t.length;if(t.length===0)return i.length;const n=[];let e;for(e=0;e<=t.length;e++)n[e]=[e];let s;for(s=0;s<=i.length;s++)n[0][s]=s;for(e=1;e<=t.length;e++)for(s=1;s<=i.length;s++)t.charAt(e-1)===i.charAt(s-1)?n[e][s]=n[e-1][s-1]:n[e][s]=Math.min(n[e-1][s-1]+1,Math.min(n[e][s-1]+1,n[e-1][s]+1));return n[t.length][i.length]}function Se(i){return(t,n)=>{const e=i(t).trim(),s=i(n).trim();return zt(e,s)/(e.length+s.length)}}function Oe(i){function t(e,s,r=new Map){let o=1/0,a;for(let l=0;l<e.length;++l)for(let d=0;d<s.length;++d){const h=JSON.stringify([e[l],s[d]]);let b;r.has(h)&&(b=r.get(h))||(b=i(e[l],s[d]),r.set(h,b)),b<o&&(o=b,a={indexA:l,indexB:d,score:o})}return a}function n(e,s,r=0,o=new Map){const a=t(e,s,o);if(!a||e.length+s.length<3)return[[e,s]];const l=e.slice(0,a.indexA),d=s.slice(0,a.indexB),h=[e[a.indexA]],b=[s[a.indexB]],z=a.indexA+1,c=a.indexB+1,f=e.slice(z),g=s.slice(c),p=n(l,d,r+1,o),C=n(h,b,r+1,o),E=n(f,g,r+1,o);let w=C;return(a.indexA>0||a.indexB>0)&&(w=p.concat(w)),(e.length>z||s.length>c)&&(w=w.concat(E)),w}return n}const A={INSERTS:"d2h-ins",DELETES:"d2h-del",CONTEXT:"d2h-cntx",INFO:"d2h-info",INSERT_CHANGES:"d2h-ins d2h-change",DELETE_CHANGES:"d2h-del d2h-change"},ue={matching:dt.NONE,matchWordsThreshold:.25,maxLineLengthHighlight:1e4,diffStyle:ft.WORD,colorScheme:ee.LIGHT},V="/",Ze=Se(i=>i.value),Lt=Oe(Ze);function ge(i){return i.indexOf("dev/null")!==-1}function St(i){return i.replace(/(<ins[^>]*>((.|\n)*?)<\/ins>)/g,"")}function Ot(i){return i.replace(/(<del[^>]*>((.|\n)*?)<\/del>)/g,"")}function de(i){switch(i){case D.CONTEXT:return A.CONTEXT;case D.INSERT:return A.INSERTS;case D.DELETE:return A.DELETES}}function ke(i){switch(i){case ee.DARK:return"d2h-dark-color-scheme";case ee.AUTO:return"d2h-auto-color-scheme";case ee.LIGHT:default:return"d2h-light-color-scheme"}}function kt(i){return i?2:1}function te(i){return i.slice(0).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}function U(i,t,n=!0){const e=kt(t);return{prefix:i.substring(0,e),content:n?te(i.substring(e)):i.substring(e)}}function he(i){const t=$e(i.oldName),n=$e(i.newName);if(t!==n&&!ge(t)&&!ge(n)){const e=[],s=[],r=t.split(V),o=n.split(V),a=r.length,l=o.length;let d=0,h=a-1,b=l-1;for(;d<h&&d<b&&r[d]===o[d];)e.push(o[d]),d+=1;for(;h>d&&b>d&&r[h]===o[b];)s.unshift(o[b]),h-=1,b-=1;const z=e.join(V),c=s.join(V),f=r.slice(d,h+1).join(V),g=o.slice(d,b+1).join(V);return z.length&&c.length?z+V+"{"+f+" ‚Üí "+g+"}"+V+c:z.length?z+V+"{"+f+" ‚Üí "+g+"}":c.length?"{"+f+" ‚Üí "+g+"}"+V+c:t+" ‚Üí "+n}else return ge(n)?t:n}function Ie(i){return`d2h-${mt(he(i)).toString().slice(-6)}`}function De(i){let t="file-changed";return i.isRename||i.isCopy?t="file-renamed":i.isNew?t="file-added":i.isDeleted?t="file-deleted":i.newName!==i.oldName&&(t="file-renamed"),t}function Ke(i,t,n,e={}){const{matching:s,maxLineLengthHighlight:r,matchWordsThreshold:o,diffStyle:a}=Object.assign(Object.assign({},ue),e),l=U(i,n,!1),d=U(t,n,!1);if(l.content.length>r||d.content.length>r)return{oldLine:{prefix:l.prefix,content:te(l.content)},newLine:{prefix:d.prefix,content:te(d.content)}};const h=a==="char"?yt(l.content,d.content):Et(l.content,d.content),b=[];if(a==="word"&&s==="words"){const c=h.filter(p=>p.removed),f=h.filter(p=>p.added);Lt(f,c).forEach(p=>{p[0].length===1&&p[1].length===1&&Ze(p[0][0],p[1][0])<o&&(b.push(p[0][0]),b.push(p[1][0]))})}const z=h.reduce((c,f)=>{const g=f.added?"ins":f.removed?"del":null,p=b.indexOf(f)>-1?' class="d2h-change"':"",C=te(f.value);return g!==null?`${c}<${g}${p}>${C}</${g}>`:`${c}${C}`},"");return{oldLine:{prefix:l.prefix,content:St(z)},newLine:{prefix:d.prefix,content:Ot(z)}}}const je="file-summary",It="icon",Dt={colorScheme:ue.colorScheme};class Pt{constructor(t,n={}){this.hoganUtils=t,this.config=Object.assign(Object.assign({},Dt),n)}render(t){const n=t.map(e=>this.hoganUtils.render(je,"line",{fileHtmlId:Ie(e),oldName:e.oldName,newName:e.newName,fileName:he(e),deletedLines:"-"+e.deletedLines,addedLines:"+"+e.addedLines},{fileIcon:this.hoganUtils.template(It,De(e))})).join(`
`);return this.hoganUtils.render(je,"wrapper",{colorScheme:ke(this.config.colorScheme),filesNumber:t.length,files:n})}}const et=Object.assign(Object.assign({},ue),{renderNothingWhenEmpty:!1,matchingMaxComparisons:2500,maxLineSizeInBlockForComparison:200}),re="generic",Ve="line-by-line",$t="icon",Ft="tag";class Mt{constructor(t,n={}){this.hoganUtils=t,this.config=Object.assign(Object.assign({},et),n)}render(t){const n=t.map(e=>{let s;return e.blocks.length?s=this.generateFileHtml(e):s=this.generateEmptyDiff(),this.makeFileDiffHtml(e,s)}).join(`
`);return this.hoganUtils.render(re,"wrapper",{colorScheme:ke(this.config.colorScheme),content:n})}makeFileDiffHtml(t,n){if(this.config.renderNothingWhenEmpty&&Array.isArray(t.blocks)&&t.blocks.length===0)return"";const e=this.hoganUtils.template(Ve,"file-diff"),s=this.hoganUtils.template(re,"file-path"),r=this.hoganUtils.template($t,"file"),o=this.hoganUtils.template(Ft,De(t));return e.render({file:t,fileHtmlId:Ie(t),diffs:n,filePath:s.render({fileDiffName:he(t)},{fileIcon:r,fileTag:o})})}generateEmptyDiff(){return this.hoganUtils.render(re,"empty-diff",{contentClass:"d2h-code-line",CSSLineClass:A})}generateFileHtml(t){const n=Oe(Se(e=>U(e.content,t.isCombined).content));return t.blocks.map(e=>{let s=this.hoganUtils.render(re,"block-header",{CSSLineClass:A,blockHeader:t.isTooBig?e.header:te(e.header),lineClass:"d2h-code-linenumber",contentClass:"d2h-code-line"});return this.applyLineGroupping(e).forEach(([r,o,a])=>{if(o.length&&a.length&&!r.length)this.applyRematchMatching(o,a,n).map(([l,d])=>{const{left:h,right:b}=this.processChangedLines(t,t.isCombined,l,d);s+=h,s+=b});else if(r.length)r.forEach(l=>{const{prefix:d,content:h}=U(l.content,t.isCombined);s+=this.generateSingleLineHtml(t,{type:A.CONTEXT,prefix:d,content:h,oldNumber:l.oldNumber,newNumber:l.newNumber})});else if(o.length||a.length){const{left:l,right:d}=this.processChangedLines(t,t.isCombined,o,a);s+=l,s+=d}else console.error("Unknown state reached while processing groups of lines",r,o,a)}),s}).join(`
`)}applyLineGroupping(t){const n=[];let e=[],s=[];for(let r=0;r<t.lines.length;r++){const o=t.lines[r];(o.type!==D.INSERT&&s.length||o.type===D.CONTEXT&&e.length>0)&&(n.push([[],e,s]),e=[],s=[]),o.type===D.CONTEXT?n.push([[o],[],[]]):o.type===D.INSERT&&e.length===0?n.push([[],[],[o]]):o.type===D.INSERT&&e.length>0?s.push(o):o.type===D.DELETE&&e.push(o)}return(e.length||s.length)&&(n.push([[],e,s]),e=[],s=[]),n}applyRematchMatching(t,n,e){const s=t.length*n.length,r=Ye(t.concat(n).map(a=>a.content.length));return s<this.config.matchingMaxComparisons&&r<this.config.maxLineSizeInBlockForComparison&&(this.config.matching==="lines"||this.config.matching==="words")?e(t,n):[[t,n]]}processChangedLines(t,n,e,s){const r={right:"",left:""},o=Math.max(e.length,s.length);for(let a=0;a<o;a++){const l=e[a],d=s[a],h=l!==void 0&&d!==void 0?Ke(l.content,d.content,n,this.config):void 0,b=l!==void 0&&l.oldNumber!==void 0?Object.assign(Object.assign({},h!==void 0?{prefix:h.oldLine.prefix,content:h.oldLine.content,type:A.DELETE_CHANGES}:Object.assign(Object.assign({},U(l.content,n)),{type:de(l.type)})),{oldNumber:l.oldNumber,newNumber:l.newNumber}):void 0,z=d!==void 0&&d.newNumber!==void 0?Object.assign(Object.assign({},h!==void 0?{prefix:h.newLine.prefix,content:h.newLine.content,type:A.INSERT_CHANGES}:Object.assign(Object.assign({},U(d.content,n)),{type:de(d.type)})),{oldNumber:d.oldNumber,newNumber:d.newNumber}):void 0,{left:c,right:f}=this.generateLineHtml(t,b,z);r.left+=c,r.right+=f}return r}generateLineHtml(t,n,e){return{left:this.generateSingleLineHtml(t,n),right:this.generateSingleLineHtml(t,e)}}generateSingleLineHtml(t,n){if(n===void 0)return"";const e=this.hoganUtils.render(Ve,"numbers",{oldNumber:n.oldNumber||"",newNumber:n.newNumber||""});return this.hoganUtils.render(re,"line",{type:n.type,lineClass:"d2h-code-linenumber",contentClass:"d2h-code-line",prefix:n.prefix===" "?"&nbsp;":n.prefix,content:n.content,lineNumber:e,line:n,file:t})}}const tt=Object.assign(Object.assign({},ue),{renderNothingWhenEmpty:!1,matchingMaxComparisons:2500,maxLineSizeInBlockForComparison:200}),oe="generic",At="side-by-side",Ht="icon",Rt="tag";class Bt{constructor(t,n={}){this.hoganUtils=t,this.config=Object.assign(Object.assign({},tt),n)}render(t){const n=t.map(e=>{let s;return e.blocks.length?s=this.generateFileHtml(e):s=this.generateEmptyDiff(),this.makeFileDiffHtml(e,s)}).join(`
`);return this.hoganUtils.render(oe,"wrapper",{colorScheme:ke(this.config.colorScheme),content:n})}makeFileDiffHtml(t,n){if(this.config.renderNothingWhenEmpty&&Array.isArray(t.blocks)&&t.blocks.length===0)return"";const e=this.hoganUtils.template(At,"file-diff"),s=this.hoganUtils.template(oe,"file-path"),r=this.hoganUtils.template(Ht,"file"),o=this.hoganUtils.template(Rt,De(t));return e.render({file:t,fileHtmlId:Ie(t),diffs:n,filePath:s.render({fileDiffName:he(t)},{fileIcon:r,fileTag:o})})}generateEmptyDiff(){return{right:"",left:this.hoganUtils.render(oe,"empty-diff",{contentClass:"d2h-code-side-line",CSSLineClass:A})}}generateFileHtml(t){const n=Oe(Se(e=>U(e.content,t.isCombined).content));return t.blocks.map(e=>{const s={left:this.makeHeaderHtml(e.header,t),right:this.makeHeaderHtml("")};return this.applyLineGroupping(e).forEach(([r,o,a])=>{if(o.length&&a.length&&!r.length)this.applyRematchMatching(o,a,n).map(([l,d])=>{const{left:h,right:b}=this.processChangedLines(t.isCombined,l,d);s.left+=h,s.right+=b});else if(r.length)r.forEach(l=>{const{prefix:d,content:h}=U(l.content,t.isCombined),{left:b,right:z}=this.generateLineHtml({type:A.CONTEXT,prefix:d,content:h,number:l.oldNumber},{type:A.CONTEXT,prefix:d,content:h,number:l.newNumber});s.left+=b,s.right+=z});else if(o.length||a.length){const{left:l,right:d}=this.processChangedLines(t.isCombined,o,a);s.left+=l,s.right+=d}else console.error("Unknown state reached while processing groups of lines",r,o,a)}),s}).reduce((e,s)=>({left:e.left+s.left,right:e.right+s.right}),{left:"",right:""})}applyLineGroupping(t){const n=[];let e=[],s=[];for(let r=0;r<t.lines.length;r++){const o=t.lines[r];(o.type!==D.INSERT&&s.length||o.type===D.CONTEXT&&e.length>0)&&(n.push([[],e,s]),e=[],s=[]),o.type===D.CONTEXT?n.push([[o],[],[]]):o.type===D.INSERT&&e.length===0?n.push([[],[],[o]]):o.type===D.INSERT&&e.length>0?s.push(o):o.type===D.DELETE&&e.push(o)}return(e.length||s.length)&&(n.push([[],e,s]),e=[],s=[]),n}applyRematchMatching(t,n,e){const s=t.length*n.length,r=Ye(t.concat(n).map(a=>a.content.length));return s<this.config.matchingMaxComparisons&&r<this.config.maxLineSizeInBlockForComparison&&(this.config.matching==="lines"||this.config.matching==="words")?e(t,n):[[t,n]]}makeHeaderHtml(t,n){return this.hoganUtils.render(oe,"block-header",{CSSLineClass:A,blockHeader:n?.isTooBig?t:te(t),lineClass:"d2h-code-side-linenumber",contentClass:"d2h-code-side-line"})}processChangedLines(t,n,e){const s={right:"",left:""},r=Math.max(n.length,e.length);for(let o=0;o<r;o++){const a=n[o],l=e[o],d=a!==void 0&&l!==void 0?Ke(a.content,l.content,t,this.config):void 0,h=a!==void 0&&a.oldNumber!==void 0?Object.assign(Object.assign({},d!==void 0?{prefix:d.oldLine.prefix,content:d.oldLine.content,type:A.DELETE_CHANGES}:Object.assign(Object.assign({},U(a.content,t)),{type:de(a.type)})),{number:a.oldNumber}):void 0,b=l!==void 0&&l.newNumber!==void 0?Object.assign(Object.assign({},d!==void 0?{prefix:d.newLine.prefix,content:d.newLine.content,type:A.INSERT_CHANGES}:Object.assign(Object.assign({},U(l.content,t)),{type:de(l.type)})),{number:l.newNumber}):void 0,{left:z,right:c}=this.generateLineHtml(h,b);s.left+=z,s.right+=c}return s}generateLineHtml(t,n){return{left:this.generateSingleHtml(t),right:this.generateSingleHtml(n)}}generateSingleHtml(t){const n="d2h-code-side-linenumber",e="d2h-code-side-line";return this.hoganUtils.render(oe,"line",{type:t?.type||`${A.CONTEXT} d2h-emptyplaceholder`,lineClass:t!==void 0?n:`${n} d2h-code-side-emptyplaceholder`,contentClass:t!==void 0?e:`${e} d2h-code-side-emptyplaceholder`,prefix:t?.prefix===" "?"&nbsp;":t?.prefix,content:t?.content,lineNumber:t?.number})}}var be={},Ue;function Wt(){return Ue||(Ue=1,(function(i){(function(t){var n=/\S/,e=/\"/g,s=/\n/g,r=/\r/g,o=/\\/g,a=/\u2028/,l=/\u2029/;t.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},t.scan=function(m,y){var L=m.length,$=0,R=1,H=2,k=$,_=null,Y=null,B="",F=[],Q=!1,v=0,O=0,x="{{",W="}}";function ne(){B.length>0&&(F.push({tag:"_t",text:new String(B)}),B="")}function pe(){for(var G=!0,j=O;j<F.length;j++)if(G=t.tags[F[j].tag]<t.tags._v||F[j].tag=="_t"&&F[j].text.match(n)===null,!G)return!1;return G}function Z(G,j){if(ne(),G&&pe())for(var J=O,K;J<F.length;J++)F[J].text&&((K=F[J+1])&&K.tag==">"&&(K.indent=F[J].text.toString()),F.splice(J,1));else j||F.push({tag:`
`});Q=!1,O=F.length}function ie(G,j){var J="="+W,K=G.indexOf(J,j),me=h(G.substring(G.indexOf("=",j)+1,K)).split(" ");return x=me[0],W=me[me.length-1],K+J.length-1}for(y&&(y=y.split(" "),x=y[0],W=y[1]),v=0;v<L;v++)k==$?b(x,m,v)?(--v,ne(),k=R):m.charAt(v)==`
`?Z(Q):B+=m.charAt(v):k==R?(v+=x.length-1,Y=t.tags[m.charAt(v+1)],_=Y?m.charAt(v+1):"_v",_=="="?(v=ie(m,v),k=$):(Y&&v++,k=H),Q=v):b(W,m,v)?(F.push({tag:_,n:h(B),otag:x,ctag:W,i:_=="/"?Q-x.length:v+W.length}),B="",v+=W.length-1,k=$,_=="{"&&(W=="}}"?v++:d(F[F.length-1]))):B+=m.charAt(v);return Z(Q,!0),F};function d(u){u.n.substr(u.n.length-1)==="}"&&(u.n=u.n.substring(0,u.n.length-1))}function h(u){return u.trim?u.trim():u.replace(/^\s*|\s*$/g,"")}function b(u,m,y){if(m.charAt(y)!=u.charAt(0))return!1;for(var L=1,$=u.length;L<$;L++)if(m.charAt(y+L)!=u.charAt(L))return!1;return!0}var z={_t:!0,"\n":!0,$:!0,"/":!0};function c(u,m,y,L){var $=[],R=null,H=null,k=null;for(H=y[y.length-1];u.length>0;){if(k=u.shift(),H&&H.tag=="<"&&!(k.tag in z))throw new Error("Illegal content in < super tag.");if(t.tags[k.tag]<=t.tags.$||f(k,L))y.push(k),k.nodes=c(u,k.tag,y,L);else if(k.tag=="/"){if(y.length===0)throw new Error("Closing tag without opener: /"+k.n);if(R=y.pop(),k.n!=R.n&&!g(k.n,R.n,L))throw new Error("Nesting error: "+R.n+" vs. "+k.n);return R.end=k.i,$}else k.tag==`
`&&(k.last=u.length==0||u[0].tag==`
`);$.push(k)}if(y.length>0)throw new Error("missing closing tag: "+y.pop().n);return $}function f(u,m){for(var y=0,L=m.length;y<L;y++)if(m[y].o==u.n)return u.tag="#",!0}function g(u,m,y){for(var L=0,$=y.length;L<$;L++)if(y[L].c==u&&y[L].o==m)return!0}function p(u){var m=[];for(var y in u)m.push('"'+w(y)+'": function(c,p,t,i) {'+u[y]+"}");return"{ "+m.join(",")+" }"}function C(u){var m=[];for(var y in u.partials)m.push('"'+w(y)+'":{name:"'+w(u.partials[y].name)+'", '+C(u.partials[y])+"}");return"partials: {"+m.join(",")+"}, subs: "+p(u.subs)}t.stringify=function(u,m,y){return"{code: function (c,p,i) { "+t.wrapMain(u.code)+" },"+C(u)+"}"};var E=0;t.generate=function(u,m,y){E=0;var L={code:"",subs:{},partials:{}};return t.walk(u,L),y.asString?this.stringify(L,m,y):this.makeTemplate(L,m,y)},t.wrapMain=function(u){return'var t=this;t.b(i=i||"");'+u+"return t.fl();"},t.template=t.Template,t.makeTemplate=function(u,m,y){var L=this.makePartials(u);return L.code=new Function("c","p","i",this.wrapMain(u.code)),new this.template(L,m,this,y)},t.makePartials=function(u){var m,y={subs:{},partials:u.partials,name:u.name};for(m in y.partials)y.partials[m]=this.makePartials(y.partials[m]);for(m in u.subs)y.subs[m]=new Function("c","p","t","i",u.subs[m]);return y};function w(u){return u.replace(o,"\\\\").replace(e,'\\"').replace(s,"\\n").replace(r,"\\r").replace(a,"\\u2028").replace(l,"\\u2029")}function N(u){return~u.indexOf(".")?"d":"f"}function T(u,m){var y="<"+(m.prefix||""),L=y+u.n+E++;return m.partials[L]={name:u.n,partials:{}},m.code+='t.b(t.rp("'+w(L)+'",c,p,"'+(u.indent||"")+'"));',L}t.codegen={"#":function(u,m){m.code+="if(t.s(t."+N(u.n)+'("'+w(u.n)+'",c,p,1),c,p,0,'+u.i+","+u.end+',"'+u.otag+" "+u.ctag+'")){t.rs(c,p,function(c,p,t){',t.walk(u.nodes,m),m.code+="});c.pop();}"},"^":function(u,m){m.code+="if(!t.s(t."+N(u.n)+'("'+w(u.n)+'",c,p,1),c,p,1,0,0,"")){',t.walk(u.nodes,m),m.code+="};"},">":T,"<":function(u,m){var y={partials:{},code:"",subs:{},inPartial:!0};t.walk(u.nodes,y);var L=m.partials[T(u,m)];L.subs=y.subs,L.partials=y.partials},$:function(u,m){var y={subs:{},code:"",partials:m.partials,prefix:u.n};t.walk(u.nodes,y),m.subs[u.n]=y.code,m.inPartial||(m.code+='t.sub("'+w(u.n)+'",c,p,i);')},"\n":function(u,m){m.code+=M('"\\n"'+(u.last?"":" + i"))},_v:function(u,m){m.code+="t.b(t.v(t."+N(u.n)+'("'+w(u.n)+'",c,p,0)));'},_t:function(u,m){m.code+=M('"'+w(u.text)+'"')},"{":S,"&":S};function S(u,m){m.code+="t.b(t.t(t."+N(u.n)+'("'+w(u.n)+'",c,p,0)));'}function M(u){return"t.b("+u+");"}t.walk=function(u,m){for(var y,L=0,$=u.length;L<$;L++)y=t.codegen[u[L].tag],y&&y(u[L],m);return m},t.parse=function(u,m,y){return y=y||{},c(u,"",[],y.sectionTags||[])},t.cache={},t.cacheKey=function(u,m){return[u,!!m.asString,!!m.disableLambda,m.delimiters,!!m.modelGet].join("||")},t.compile=function(u,m){m=m||{};var y=t.cacheKey(u,m),L=this.cache[y];if(L){var $=L.partials;for(var R in $)delete $[R].instance;return L}return L=this.generate(this.parse(this.scan(u,m.delimiters),u,m),u,m),this.cache[y]=L}})(i)})(be)),be}var ve={},Ge;function qt(){return Ge||(Ge=1,(function(i){(function(t){t.Template=function(c,f,g,p){c=c||{},this.r=c.code||this.r,this.c=g,this.options=p||{},this.text=f||"",this.partials=c.partials||{},this.subs=c.subs||{},this.buf=""},t.Template.prototype={r:function(c,f,g){return""},v:b,t:h,render:function(f,g,p){return this.ri([f],g||{},p)},ri:function(c,f,g){return this.r(c,f,g)},ep:function(c,f){var g=this.partials[c],p=f[g.name];if(g.instance&&g.base==p)return g.instance;if(typeof p=="string"){if(!this.c)throw new Error("No compiler available.");p=this.c.compile(p,this.options)}if(!p)return null;if(this.partials[c].base=p,g.subs){f.stackText||(f.stackText={});for(key in g.subs)f.stackText[key]||(f.stackText[key]=this.activeSub!==void 0&&f.stackText[this.activeSub]?f.stackText[this.activeSub]:this.text);p=e(p,g.subs,g.partials,this.stackSubs,this.stackPartials,f.stackText)}return this.partials[c].instance=p,p},rp:function(c,f,g,p){var C=this.ep(c,g);return C?C.ri(f,g,p):""},rs:function(c,f,g){var p=c[c.length-1];if(!z(p)){g(c,f,this);return}for(var C=0;C<p.length;C++)c.push(p[C]),g(c,f,this),c.pop()},s:function(c,f,g,p,C,E,w){var N;return z(c)&&c.length===0?!1:(typeof c=="function"&&(c=this.ms(c,f,g,p,C,E,w)),N=!!c,!p&&N&&f&&f.push(typeof c=="object"?c:f[f.length-1]),N)},d:function(c,f,g,p){var C,E=c.split("."),w=this.f(E[0],f,g,p),N=this.options.modelGet,T=null;if(c==="."&&z(f[f.length-2]))w=f[f.length-1];else for(var S=1;S<E.length;S++)C=n(E[S],w,N),C!==void 0?(T=w,w=C):w="";return p&&!w?!1:(!p&&typeof w=="function"&&(f.push(T),w=this.mv(w,f,g),f.pop()),w)},f:function(c,f,g,p){for(var C=!1,E=null,w=!1,N=this.options.modelGet,T=f.length-1;T>=0;T--)if(E=f[T],C=n(c,E,N),C!==void 0){w=!0;break}return w?(!p&&typeof C=="function"&&(C=this.mv(C,f,g)),C):p?!1:""},ls:function(c,f,g,p,C){var E=this.options.delimiters;return this.options.delimiters=C,this.b(this.ct(h(c.call(f,p)),f,g)),this.options.delimiters=E,!1},ct:function(c,f,g){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(c,this.options).render(f,g)},b:function(c){this.buf+=c},fl:function(){var c=this.buf;return this.buf="",c},ms:function(c,f,g,p,C,E,w){var N,T=f[f.length-1],S=c.call(T);return typeof S=="function"?p?!0:(N=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(S,T,g,N.substring(C,E),w)):S},mv:function(c,f,g){var p=f[f.length-1],C=c.call(p);return typeof C=="function"?this.ct(h(C.call(p)),p,g):C},sub:function(c,f,g,p){var C=this.subs[c];C&&(this.activeSub=c,C(f,g,this,p),this.activeSub=!1)}};function n(c,f,g){var p;return f&&typeof f=="object"&&(f[c]!==void 0?p=f[c]:g&&f.get&&typeof f.get=="function"&&(p=f.get(c))),p}function e(c,f,g,p,C,E){function w(){}w.prototype=c;function N(){}N.prototype=c.subs;var T,S=new w;S.subs=new N,S.subsText={},S.buf="",p=p||{},S.stackSubs=p,S.subsText=E;for(T in f)p[T]||(p[T]=f[T]);for(T in p)S.subs[T]=p[T];C=C||{},S.stackPartials=C;for(T in g)C[T]||(C[T]=g[T]);for(T in C)S.partials[T]=C[T];return S}var s=/&/g,r=/</g,o=/>/g,a=/\'/g,l=/\"/g,d=/[&<>\"\']/;function h(c){return String(c??"")}function b(c){return c=h(c),d.test(c)?c.replace(s,"&amp;").replace(r,"&lt;").replace(o,"&gt;").replace(a,"&#39;").replace(l,"&quot;"):c}var z=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"}})(i)})(ve)),ve}var we,Je;function jt(){if(Je)return we;Je=1;var i=Wt();return i.Template=qt().Template,i.template=i.Template,we=i,we}var I=jt();const P={};P["file-summary-line"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<li class="d2h-file-list-line">'),e.b(`
`+n),e.b('    <span class="d2h-file-name-wrapper">'),e.b(`
`+n),e.b(e.rp("<fileIcon0",i,t,"      ")),e.b('      <a href="#'),e.b(e.v(e.f("fileHtmlId",i,t,0))),e.b('" class="d2h-file-name">'),e.b(e.v(e.f("fileName",i,t,0))),e.b("</a>"),e.b(`
`+n),e.b('      <span class="d2h-file-stats">'),e.b(`
`+n),e.b('          <span class="d2h-lines-added">'),e.b(e.v(e.f("addedLines",i,t,0))),e.b("</span>"),e.b(`
`+n),e.b('          <span class="d2h-lines-deleted">'),e.b(e.v(e.f("deletedLines",i,t,0))),e.b("</span>"),e.b(`
`+n),e.b("      </span>"),e.b(`
`+n),e.b("    </span>"),e.b(`
`+n),e.b("</li>"),e.fl()},partials:{"<fileIcon0":{name:"fileIcon",partials:{},subs:{}}},subs:{}});P["file-summary-wrapper"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<div class="d2h-file-list-wrapper '),e.b(e.v(e.f("colorScheme",i,t,0))),e.b('">'),e.b(`
`+n),e.b('    <div class="d2h-file-list-header">'),e.b(`
`+n),e.b('        <span class="d2h-file-list-title">Files changed ('),e.b(e.v(e.f("filesNumber",i,t,0))),e.b(")</span>"),e.b(`
`+n),e.b('        <a class="d2h-file-switch d2h-hide">hide</a>'),e.b(`
`+n),e.b('        <a class="d2h-file-switch d2h-show">show</a>'),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b('    <ol class="d2h-file-list">'),e.b(`
`+n),e.b("    "),e.b(e.t(e.f("files",i,t,0))),e.b(`
`+n),e.b("    </ol>"),e.b(`
`+n),e.b("</div>"),e.fl()},partials:{},subs:{}});P["generic-block-header"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b("<tr>"),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.f("lineClass",i,t,0))),e.b(" "),e.b(e.v(e.d("CSSLineClass.INFO",i,t,0))),e.b('"></td>'),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.d("CSSLineClass.INFO",i,t,0))),e.b('">'),e.b(`
`+n),e.b('        <div class="'),e.b(e.v(e.f("contentClass",i,t,0))),e.b('">'),e.s(e.f("blockHeader",i,t,1),i,t,0,156,173,"{{ }}")&&(e.rs(i,t,function(s,r,o){o.b(o.t(o.f("blockHeader",s,r,0)))}),i.pop()),e.s(e.f("blockHeader",i,t,1),i,t,1,0,0,"")||e.b("&nbsp;"),e.b("</div>"),e.b(`
`+n),e.b("    </td>"),e.b(`
`+n),e.b("</tr>"),e.fl()},partials:{},subs:{}});P["generic-empty-diff"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b("<tr>"),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.d("CSSLineClass.INFO",i,t,0))),e.b('">'),e.b(`
`+n),e.b('        <div class="'),e.b(e.v(e.f("contentClass",i,t,0))),e.b('">'),e.b(`
`+n),e.b("            File without changes"),e.b(`
`+n),e.b("        </div>"),e.b(`
`+n),e.b("    </td>"),e.b(`
`+n),e.b("</tr>"),e.fl()},partials:{},subs:{}});P["generic-file-path"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-file-name-wrapper">'),e.b(`
`+n),e.b(e.rp("<fileIcon0",i,t,"    ")),e.b('    <span class="d2h-file-name">'),e.b(e.v(e.f("fileDiffName",i,t,0))),e.b("</span>"),e.b(`
`+n),e.b(e.rp("<fileTag1",i,t,"    ")),e.b("</span>"),e.b(`
`+n),e.b('<label class="d2h-file-collapse">'),e.b(`
`+n),e.b('    <input class="d2h-file-collapse-input" type="checkbox" name="viewed" value="viewed">'),e.b(`
`+n),e.b("    Viewed"),e.b(`
`+n),e.b("</label>"),e.fl()},partials:{"<fileIcon0":{name:"fileIcon",partials:{},subs:{}},"<fileTag1":{name:"fileTag",partials:{},subs:{}}},subs:{}});P["generic-line"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b("<tr>"),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.f("lineClass",i,t,0))),e.b(" "),e.b(e.v(e.f("type",i,t,0))),e.b('">'),e.b(`
`+n),e.b("      "),e.b(e.t(e.f("lineNumber",i,t,0))),e.b(`
`+n),e.b("    </td>"),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.f("type",i,t,0))),e.b('">'),e.b(`
`+n),e.b('        <div class="'),e.b(e.v(e.f("contentClass",i,t,0))),e.b('">'),e.b(`
`+n),e.s(e.f("prefix",i,t,1),i,t,0,162,238,"{{ }}")&&(e.rs(i,t,function(s,r,o){o.b('            <span class="d2h-code-line-prefix">'),o.b(o.t(o.f("prefix",s,r,0))),o.b("</span>"),o.b(`
`+n)}),i.pop()),e.s(e.f("prefix",i,t,1),i,t,1,0,0,"")||(e.b('            <span class="d2h-code-line-prefix">&nbsp;</span>'),e.b(`
`+n)),e.s(e.f("content",i,t,1),i,t,0,371,445,"{{ }}")&&(e.rs(i,t,function(s,r,o){o.b('            <span class="d2h-code-line-ctn">'),o.b(o.t(o.f("content",s,r,0))),o.b("</span>"),o.b(`
`+n)}),i.pop()),e.s(e.f("content",i,t,1),i,t,1,0,0,"")||(e.b('            <span class="d2h-code-line-ctn"><br></span>'),e.b(`
`+n)),e.b("        </div>"),e.b(`
`+n),e.b("    </td>"),e.b(`
`+n),e.b("</tr>"),e.fl()},partials:{},subs:{}});P["generic-wrapper"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<div class="d2h-wrapper '),e.b(e.v(e.f("colorScheme",i,t,0))),e.b('">'),e.b(`
`+n),e.b("    "),e.b(e.t(e.f("content",i,t,0))),e.b(`
`+n),e.b("</div>"),e.fl()},partials:{},subs:{}});P["icon-file-added"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-added" height="16" title="added" version="1.1" viewBox="0 0 14 16"'),e.b(`
`+n),e.b('     width="14">'),e.b(`
`+n),e.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM6 9H3V7h3V4h2v3h3v2H8v3H6V9z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});P["icon-file-changed"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-changed" height="16" title="modified" version="1.1"'),e.b(`
`+n),e.b('     viewBox="0 0 14 16" width="14">'),e.b(`
`+n),e.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM4 8c0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3-3-1.34-3-3z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});P["icon-file-deleted"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-deleted" height="16" title="removed" version="1.1"'),e.b(`
`+n),e.b('     viewBox="0 0 14 16" width="14">'),e.b(`
`+n),e.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM11 9H3V7h8v2z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});P["icon-file-renamed"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-moved" height="16" title="renamed" version="1.1"'),e.b(`
`+n),e.b('     viewBox="0 0 14 16" width="14">'),e.b(`
`+n),e.b('    <path d="M6 9H3V7h3V4l5 4-5 4V9z m8-7v12c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h12c0.55 0 1 0.45 1 1z m-1 0H1v12h12V2z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});P["icon-file"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">'),e.b(`
`+n),e.b('    <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});P["line-by-line-file-diff"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<div id="'),e.b(e.v(e.f("fileHtmlId",i,t,0))),e.b('" class="d2h-file-wrapper" data-lang="'),e.b(e.v(e.d("file.language",i,t,0))),e.b('">'),e.b(`
`+n),e.b('    <div class="d2h-file-header">'),e.b(`
`+n),e.b("    "),e.b(e.t(e.f("filePath",i,t,0))),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b('    <div class="d2h-file-diff">'),e.b(`
`+n),e.b('        <div class="d2h-code-wrapper">'),e.b(`
`+n),e.b('            <table class="d2h-diff-table">'),e.b(`
`+n),e.b('                <tbody class="d2h-diff-tbody">'),e.b(`
`+n),e.b("                "),e.b(e.t(e.f("diffs",i,t,0))),e.b(`
`+n),e.b("                </tbody>"),e.b(`
`+n),e.b("            </table>"),e.b(`
`+n),e.b("        </div>"),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b("</div>"),e.fl()},partials:{},subs:{}});P["line-by-line-numbers"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<div class="line-num1">'),e.b(e.v(e.f("oldNumber",i,t,0))),e.b("</div>"),e.b(`
`+n),e.b('<div class="line-num2">'),e.b(e.v(e.f("newNumber",i,t,0))),e.b("</div>"),e.fl()},partials:{},subs:{}});P["side-by-side-file-diff"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<div id="'),e.b(e.v(e.f("fileHtmlId",i,t,0))),e.b('" class="d2h-file-wrapper" data-lang="'),e.b(e.v(e.d("file.language",i,t,0))),e.b('">'),e.b(`
`+n),e.b('    <div class="d2h-file-header">'),e.b(`
`+n),e.b("      "),e.b(e.t(e.f("filePath",i,t,0))),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b('    <div class="d2h-files-diff">'),e.b(`
`+n),e.b('        <div class="d2h-file-side-diff">'),e.b(`
`+n),e.b('            <div class="d2h-code-wrapper">'),e.b(`
`+n),e.b('                <table class="d2h-diff-table">'),e.b(`
`+n),e.b('                    <tbody class="d2h-diff-tbody">'),e.b(`
`+n),e.b("                    "),e.b(e.t(e.d("diffs.left",i,t,0))),e.b(`
`+n),e.b("                    </tbody>"),e.b(`
`+n),e.b("                </table>"),e.b(`
`+n),e.b("            </div>"),e.b(`
`+n),e.b("        </div>"),e.b(`
`+n),e.b('        <div class="d2h-file-side-diff">'),e.b(`
`+n),e.b('            <div class="d2h-code-wrapper">'),e.b(`
`+n),e.b('                <table class="d2h-diff-table">'),e.b(`
`+n),e.b('                    <tbody class="d2h-diff-tbody">'),e.b(`
`+n),e.b("                    "),e.b(e.t(e.d("diffs.right",i,t,0))),e.b(`
`+n),e.b("                    </tbody>"),e.b(`
`+n),e.b("                </table>"),e.b(`
`+n),e.b("            </div>"),e.b(`
`+n),e.b("        </div>"),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b("</div>"),e.fl()},partials:{},subs:{}});P["tag-file-added"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-tag d2h-added d2h-added-tag">ADDED</span>'),e.fl()},partials:{},subs:{}});P["tag-file-changed"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-tag d2h-changed d2h-changed-tag">CHANGED</span>'),e.fl()},partials:{},subs:{}});P["tag-file-deleted"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-tag d2h-deleted d2h-deleted-tag">DELETED</span>'),e.fl()},partials:{},subs:{}});P["tag-file-renamed"]=new I.Template({code:function(i,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-tag d2h-moved d2h-moved-tag">RENAMED</span>'),e.fl()},partials:{},subs:{}});class Vt{constructor({compiledTemplates:t={},rawTemplates:n={}}){const e=Object.entries(n).reduce((s,[r,o])=>{const a=I.compile(o,{asString:!1});return Object.assign(Object.assign({},s),{[r]:a})},{});this.preCompiledTemplates=Object.assign(Object.assign(Object.assign({},P),t),e)}static compile(t){return I.compile(t,{asString:!1})}render(t,n,e,s,r){const o=this.templateKey(t,n);try{return this.preCompiledTemplates[o].render(e,s,r)}catch{throw new Error(`Could not find template to render '${o}'`)}}template(t,n){return this.preCompiledTemplates[this.templateKey(t,n)]}templateKey(t,n){return`${t}-${n}`}}const Ut=Object.assign(Object.assign(Object.assign({},et),tt),{outputFormat:ct.LINE_BY_LINE,drawFileList:!0});function Gt(i,t={}){const n=Object.assign(Object.assign({},Ut),t),e=typeof i=="string"?vt(i,n):i,s=new Vt(n),{colorScheme:r}=n,o={colorScheme:r},a=n.drawFileList?new Pt(s,o).render(e):"",l=n.outputFormat==="side-by-side"?new Bt(s,n).render(e):new Mt(s,n).render(e);return a+l}class Te{static normalize(t){return{info:{name:t.info.name,version:t.info.version},items:this.normalizeItems(t.item)}}static normalizeItems(t){return t.map(n=>this.normalizeItem(n))}static normalizeItem(t){const n={id:t.id||this.generateId(t.name),name:t.name};return t.request&&(n.method=t.request.method,n.url=this.normalizeUrl(t.request.url),n.headers=this.normalizeHeaders(t.request.header),n.body=this.normalizeBody(t.request.body)),t.item&&Array.isArray(t.item)&&(n.children=this.normalizeItems(t.item)),t.event&&(n.tests=this.normalizeEvents(t.event)),n}static normalizeUrl(t){return typeof t=="string"?t:t?.raw||""}static normalizeHeaders(t){return t?t.filter(n=>!n.disabled).reduce((n,e)=>(n[e.key]=e.value,n),{}):{}}static normalizeBody(t){if(!t)return"";switch(t.mode){case"raw":return t.raw||"";case"urlencoded":return this.formatUrlEncoded(t.urlencoded);case"formdata":return this.formatFormData(t.formdata);default:return JSON.stringify(t)}}static normalizeEvents(t){return t.filter(n=>n.script?.exec).map(n=>n.script.exec.join(`
`))}static formatUrlEncoded(t){return t?t.filter(n=>!n.disabled).map(n=>`${n.key}=${n.value}`).join("&"):""}static formatFormData(t){return t?t.filter(n=>!n.disabled).map(n=>`${n.key}: ${n.value}`).join(`
`):""}static generateId(t){return t.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")}}class nt{diff(t,n,e={}){let s;typeof e=="function"?(s=e,e={}):"callback"in e&&(s=e.callback);const r=this.castInput(t,e),o=this.castInput(n,e),a=this.removeEmpty(this.tokenize(r,e)),l=this.removeEmpty(this.tokenize(o,e));return this.diffWithOptionsObj(a,l,e,s)}diffWithOptionsObj(t,n,e,s){var r;const o=E=>{if(E=this.postProcess(E,e),s){setTimeout(function(){s(E)},0);return}else return E},a=n.length,l=t.length;let d=1,h=a+l;e.maxEditLength!=null&&(h=Math.min(h,e.maxEditLength));const b=(r=e.timeout)!==null&&r!==void 0?r:1/0,z=Date.now()+b,c=[{oldPos:-1,lastComponent:void 0}];let f=this.extractCommon(c[0],n,t,0,e);if(c[0].oldPos+1>=l&&f+1>=a)return o(this.buildValues(c[0].lastComponent,n,t));let g=-1/0,p=1/0;const C=()=>{for(let E=Math.max(g,-d);E<=Math.min(p,d);E+=2){let w;const N=c[E-1],T=c[E+1];N&&(c[E-1]=void 0);let S=!1;if(T){const u=T.oldPos-E;S=T&&0<=u&&u<a}const M=N&&N.oldPos+1<l;if(!S&&!M){c[E]=void 0;continue}if(!M||S&&N.oldPos<T.oldPos?w=this.addToPath(T,!0,!1,0,e):w=this.addToPath(N,!1,!0,1,e),f=this.extractCommon(w,n,t,E,e),w.oldPos+1>=l&&f+1>=a)return o(this.buildValues(w.lastComponent,n,t))||!0;c[E]=w,w.oldPos+1>=l&&(p=Math.min(p,E-1)),f+1>=a&&(g=Math.max(g,E+1))}d++};if(s)(function E(){setTimeout(function(){if(d>h||Date.now()>z)return s(void 0);C()||E()},0)})();else for(;d<=h&&Date.now()<=z;){const E=C();if(E)return E}}addToPath(t,n,e,s,r){const o=t.lastComponent;return o&&!r.oneChangePerToken&&o.added===n&&o.removed===e?{oldPos:t.oldPos+s,lastComponent:{count:o.count+1,added:n,removed:e,previousComponent:o.previousComponent}}:{oldPos:t.oldPos+s,lastComponent:{count:1,added:n,removed:e,previousComponent:o}}}extractCommon(t,n,e,s,r){const o=n.length,a=e.length;let l=t.oldPos,d=l-s,h=0;for(;d+1<o&&l+1<a&&this.equals(e[l+1],n[d+1],r);)d++,l++,h++,r.oneChangePerToken&&(t.lastComponent={count:1,previousComponent:t.lastComponent,added:!1,removed:!1});return h&&!r.oneChangePerToken&&(t.lastComponent={count:h,previousComponent:t.lastComponent,added:!1,removed:!1}),t.oldPos=l,d}equals(t,n,e){return e.comparator?e.comparator(t,n):t===n||!!e.ignoreCase&&t.toLowerCase()===n.toLowerCase()}removeEmpty(t){const n=[];for(let e=0;e<t.length;e++)t[e]&&n.push(t[e]);return n}castInput(t,n){return t}tokenize(t,n){return Array.from(t)}join(t){return t.join("")}postProcess(t,n){return t}get useLongestToken(){return!1}buildValues(t,n,e){const s=[];let r;for(;t;)s.push(t),r=t.previousComponent,delete t.previousComponent,t=r;s.reverse();const o=s.length;let a=0,l=0,d=0;for(;a<o;a++){const h=s[a];if(h.removed)h.value=this.join(e.slice(d,d+h.count)),d+=h.count;else{if(!h.added&&this.useLongestToken){let b=n.slice(l,l+h.count);b=b.map(function(z,c){const f=e[d+c];return f.length>z.length?f:z}),h.value=this.join(b)}else h.value=this.join(n.slice(l,l+h.count));l+=h.count,h.added||(d+=h.count)}}return s}}class Jt extends nt{constructor(){super(...arguments),this.tokenize=it}equals(t,n,e){return e.ignoreWhitespace?((!e.newlineIsToken||!t.includes(`
`))&&(t=t.trim()),(!e.newlineIsToken||!n.includes(`
`))&&(n=n.trim())):e.ignoreNewlineAtEof&&!e.newlineIsToken&&(t.endsWith(`
`)&&(t=t.slice(0,-1)),n.endsWith(`
`)&&(n=n.slice(0,-1))),super.equals(t,n,e)}}const _t=new Jt;function _e(i,t,n){return _t.diff(i,t,n)}function it(i,t){t.stripTrailingCr&&(i=i.replace(/\r\n/g,`
`));const n=[],e=i.split(/(\n|\r\n)/);e[e.length-1]||e.pop();for(let s=0;s<e.length;s++){const r=e[s];s%2&&!t.newlineIsToken?n[n.length-1]+=r:n.push(r)}return n}class Xt extends nt{constructor(){super(...arguments),this.tokenize=it}get useLongestToken(){return!0}castInput(t,n){const{undefinedReplacement:e,stringifyReplacer:s=(r,o)=>typeof o>"u"?e:o}=n;return typeof t=="string"?t:JSON.stringify(ze(t,null,null,s),null,"  ")}equals(t,n,e){return super.equals(t.replace(/,([\r\n])/g,"$1"),n.replace(/,([\r\n])/g,"$1"),e)}}const Yt=new Xt;function Qt(i,t,n){return Yt.diff(i,t,n)}function ze(i,t,n,e,s){t=t||[],n=n||[],e&&(i=e(s===void 0?"":s,i));let r;for(r=0;r<t.length;r+=1)if(t[r]===i)return n[r];let o;if(Object.prototype.toString.call(i)==="[object Array]"){for(t.push(i),o=new Array(i.length),n.push(o),r=0;r<i.length;r+=1)o[r]=ze(i[r],t,n,e,String(r));return t.pop(),n.pop(),o}if(i&&i.toJSON&&(i=i.toJSON()),typeof i=="object"&&i!==null){t.push(i),o={},n.push(o);const a=[];let l;for(l in i)Object.prototype.hasOwnProperty.call(i,l)&&a.push(l);for(a.sort(),r=0;r<a.length;r+=1)l=a[r],o[l]=ze(i[l],t,n,e,l);t.pop(),n.pop()}else o=i;return o}function Zt(i,t,n,e,s,r,o){let a;a={},typeof a.context>"u"&&(a.context=4);const l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){const{callback:h}=a;_e(n,e,Object.assign(Object.assign({},a),{callback:b=>{const z=d(b);h(z)}}))}else return d(_e(n,e,a));function d(h){if(!h)return;h.push({value:"",lines:[]});function b(E){return E.map(function(w){return" "+w})}const z=[];let c=0,f=0,g=[],p=1,C=1;for(let E=0;E<h.length;E++){const w=h[E],N=w.lines||tn(w.value);if(w.lines=N,w.added||w.removed){if(!c){const T=h[E-1];c=p,f=C,T&&(g=l>0?b(T.lines.slice(-l)):[],c-=g.length,f-=g.length)}for(const T of N)g.push((w.added?"+":"-")+T);w.added?C+=N.length:p+=N.length}else{if(c)if(N.length<=l*2&&E<h.length-2)for(const T of b(N))g.push(T);else{const T=Math.min(N.length,l);for(const M of b(N.slice(0,T)))g.push(M);const S={oldStart:c,oldLines:p-c+T,newStart:f,newLines:C-f+T,lines:g};z.push(S),c=0,f=0,g=[]}p+=N.length,C+=N.length}}for(const E of z)for(let w=0;w<E.lines.length;w++)E.lines[w].endsWith(`
`)?E.lines[w]=E.lines[w].slice(0,-1):(E.lines.splice(w+1,0,"\\ No newline at end of file"),w++);return{oldFileName:i,newFileName:t,oldHeader:s,newHeader:r,hunks:z}}}function st(i){if(Array.isArray(i))return i.map(st).join(`
`);const t=[];i.oldFileName==i.newFileName&&t.push("Index: "+i.oldFileName),t.push("==================================================================="),t.push("--- "+i.oldFileName+(typeof i.oldHeader>"u"?"":"	"+i.oldHeader)),t.push("+++ "+i.newFileName+(typeof i.newHeader>"u"?"":"	"+i.newHeader));for(let n=0;n<i.hunks.length;n++){const e=i.hunks[n];e.oldLines===0&&(e.oldStart-=1),e.newLines===0&&(e.newStart-=1),t.push("@@ -"+e.oldStart+","+e.oldLines+" +"+e.newStart+","+e.newLines+" @@");for(const s of e.lines)t.push(s)}return t.join(`
`)+`
`}function Kt(i,t,n,e,s,r,o){{const a=Zt(i,t,n,e,s,r);return a?st(a):void 0}}function en(i,t,n,e,s,r){return Kt(i,i,t,n,e,s)}function tn(i){const t=i.endsWith(`
`),n=i.split(`
`).map(e=>e+`
`);return t?n.pop():n.push(n.pop().slice(0,-1)),n}class Xe{options;constructor(t={}){this.options={ignoreOrder:!1,ignoreWhitespace:!0,normalizeJson:!0,sortKeys:!0,...t}}diff(t,n){const e=Te.normalize(t),s=Te.normalize(n),r=this.serializeForComparison(e),o=this.serializeForComparison(s),a=Qt(r,o),l=en(t.info.name||"Old Collection",n.info.name||"New Collection",r,o),d=Gt(l,{drawFileList:!1,matching:"lines",outputFormat:"side-by-side"});return{oldCollection:r,newCollection:o,patches:a,htmlDiff:d}}serializeForComparison(t){let n={...t};this.options.sortKeys&&(n=this.sortObjectKeys(n)),this.options.ignoreOrder&&n.items&&(n.items=this.sortItems(n.items));let e=JSON.stringify(n,null,2);return this.options.ignoreWhitespace&&(e=this.normalizeWhitespace(e)),e}sortObjectKeys(t){if(t===null||typeof t!="object")return t;if(Array.isArray(t))return t.map(e=>this.sortObjectKeys(e));const n={};return Object.keys(t).sort().forEach(e=>{n[e]=this.sortObjectKeys(t[e])}),n}sortItems(t){return t.map(n=>({...n,children:n.children?this.sortItems(n.children):void 0})).sort((n,e)=>n.name.localeCompare(e.name))}normalizeWhitespace(t){return t.replace(/\s+/g," ").replace(/\s*([{}[\],:])\s*/g,"$1").trim()}getChangeSummary(t){let n=0,e=0,s=0;return t.forEach(r=>{r.added?n++:r.removed?e++:s++}),{added:n,removed:e,modified:s}}}class nn{state={};components={};differ={};constructor(){this.initializeState(),this.initializeComponents(),this.setupEventHandlers(),console.log("Postman Diff App initialized")}initializeState(){this.state={oldCollection:null,newCollection:null,normalizedOld:null,normalizedNew:null,diffResult:null,diffOptions:{ignoreOrder:!1,ignoreWhitespace:!0,normalizeJson:!0,sortKeys:!0},isProcessing:!1,error:null}}initializeComponents(){try{this.createFileInputContainer(),this.components={oldFileInput:new Pe("old-file-input","Old Collection"),newFileInput:new Pe("new-file-input","New Collection"),diffViewer:new rt("diff-container"),treeView:new ot("tree-view-container",{onNodeSelect:t=>this.handleNodeSelection(t),onNodeToggle:t=>this.handleNodeToggle(t)}),optionToggles:new at("option-toggles-container",{onOptionsChange:t=>this.handleOptionsChange(t)}),exportControls:new lt("export-controls-container",{onExport:(t,n)=>this.handleExport(t,n)})},this.differ=new Xe(this.state.diffOptions),console.log("All components initialized successfully")}catch(t){this.handleError("Failed to initialize components: "+t.message)}}createFileInputContainer(){const t=document.getElementById("file-inputs-container");t&&(t.innerHTML=`
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 min-w-0 lg:min-w-[500px]">
          <div id="old-file-input"></div>
          <div id="new-file-input"></div>
        </div>
      `)}setupEventHandlers(){this.components.oldFileInput.onLoad(t=>{this.handleFileLoad("old",t)}),this.components.newFileInput.onLoad(t=>{this.handleFileLoad("new",t)}),this.components.optionToggles.setOptions(this.state.diffOptions)}async handleFileLoad(t,n){try{this.setProcessing(!0),this.clearError(),t==="old"?this.state.oldCollection=n:this.state.newCollection=n;const e=Te.normalize(n);t==="old"?this.state.normalizedOld=e:this.state.normalizedNew=e,this.components.treeView.loadCollection(e,t),await this.tryGenerateDiff()}catch(e){this.handleError(`Failed to load ${t} collection: `+e.message)}finally{this.setProcessing(!1)}}async handleOptionsChange(t){try{this.state.diffOptions=t,this.differ=new Xe(t),this.state.oldCollection&&this.state.newCollection&&await this.tryGenerateDiff()}catch(n){this.handleError("Failed to update options: "+n.message)}}handleNodeSelection(t){console.log("Node selected:",t)}handleNodeToggle(t){console.log("Node toggled:",t)}handleExport(t,n){console.log(`Exporting as ${t}:`,n)}async tryGenerateDiff(){if(!(!this.state.oldCollection||!this.state.newCollection))try{this.setProcessing(!0),this.clearError();const t=this.differ.diff(this.state.oldCollection,this.state.newCollection);this.state.diffResult=t,this.components.diffViewer.showDiff(t),this.state.normalizedOld&&this.state.normalizedNew&&this.components.treeView.updateWithDiff(this.state.normalizedOld,this.state.normalizedNew),this.components.exportControls.updateData({oldCollection:this.state.normalizedOld||void 0,newCollection:this.state.normalizedNew||void 0,diffResult:t,options:this.state.diffOptions}),console.log("Diff generated successfully")}catch(t){this.handleError("Failed to generate diff: "+t.message)}finally{this.setProcessing(!1)}}setProcessing(t){this.state.isProcessing=t;const n=document.getElementById("loading-indicator");n&&(t?n.classList.remove("hidden"):n.classList.add("hidden")),this.components.optionToggles.setEnabled(!t),this.components.exportControls.setEnabled(!t)}handleError(t){this.state.error=t,console.error("App Error:",t),this.showErrorMessage(t)}clearError(){this.state.error=null,this.hideErrorMessage()}showErrorMessage(t){let n=document.getElementById("error-message");if(!n){n=document.createElement("div"),n.id="error-message",n.className="error-message";const e=document.querySelector(".right-panel .panel-content");e&&e.insertBefore(n,e.firstChild)}n.innerHTML=`
      <div class="error-content">
        <span class="error-icon">‚ö†Ô∏è</span>
        <span class="error-text">${t}</span>
        <button class="error-close" onclick="this.parentElement.parentElement.style.display='none'">√ó</button>
      </div>
    `,n.style.display="block"}hideErrorMessage(){const t=document.getElementById("error-message");t&&(t.style.display="none")}getState(){return{...this.state}}reset(){this.initializeState(),this.components.diffViewer.clear(),this.components.treeView.clear(),this.components.optionToggles.setOptions(this.state.diffOptions),this.components.exportControls.updateData({}),this.clearError(),this.setProcessing(!1)}}const sn=new nn;window.postmanDiffApp=sn;
