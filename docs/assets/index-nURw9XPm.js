(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();class fe{element;onFileLoad;constructor(t,n){const e=document.getElementById(t);if(!e)throw new Error(`Container with id "${t}" not found`);this.element=this.createElement(n),e.appendChild(this.element)}createElement(t){const n=document.createElement("div");n.className="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg p-3 transition-all duration-300 hover:border-blue-500 dark:hover:border-blue-400",n.innerHTML=`
      <div class="flex flex-col gap-4">
        <label class="text-sm font-semibold text-zinc-900 dark:text-zinc-100">${t}</label>
        <input 
          type="file" 
          accept=".json" 
          class="w-full p-4 border-2 border-dashed border-zinc-300 dark:border-zinc-600 rounded-md bg-zinc-50 dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100 cursor-pointer transition-all duration-300 hover:border-blue-500 dark:hover:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
        />
        <div class="file-status text-xs text-zinc-600 dark:text-zinc-400">No file selected</div>
      </div>
    `;const e=n.querySelector('input[type="file"]'),s=n.querySelector(".file-status");return e.addEventListener("change",a=>{const i=a.target.files?.[0];if(!i){s.textContent="No file selected",s.className="file-status text-zinc-600 dark:text-zinc-400";return}s.textContent=`Loading ${i.name}...`,s.className="file-status loading",this.loadFile(i).then(l=>{s.textContent=`‚úì ${i.name}`,s.className="file-status success",this.onFileLoad?.(l)}).catch(l=>{s.textContent=`‚úó Error: ${l.message}`,s.className="file-status error"})}),n}async loadFile(t){return new Promise((n,e)=>{const s=new FileReader;s.onload=a=>{try{const i=a.target?.result,l=JSON.parse(i);if(!l.info||!l.info.name)throw new Error("Invalid Postman collection format");n(l)}catch{e(new Error("Failed to parse JSON file"))}},s.onerror=()=>{e(new Error("Failed to read file"))},s.readAsText(t)})}onLoad(t){this.onFileLoad=t}}class $e{element;constructor(t){const n=document.getElementById(t);if(!n)throw new Error(`Container with id "${t}" not found`);this.element=this.createElement(),n.appendChild(this.element)}createElement(){const t=document.createElement("div");return t.className="diff-viewer",t.innerHTML=`
      <div class="diff-header">
        <div class="diff-stats"></div>
      </div>
      <div class="diff-content">
        <div class="diff-placeholder">
          Select two Postman collections to see the differences
        </div>
      </div>
    `,t}showDiff(t){const n=this.element.querySelector(".diff-content"),e=this.element.querySelector(".diff-stats"),s=this.calculateStats(t);e.innerHTML=`
      <a href="#added-section" class="stat added" style="text-decoration: none; cursor: pointer;">+${s.added} added</a>
      <a href="#removed-section" class="stat removed" style="text-decoration: none; cursor: pointer;">-${s.removed} removed</a>
      <a href="#modified-section" class="stat modified" style="text-decoration: none; cursor: pointer;">~${s.modified} modified</a>
    `,n.innerHTML=t.htmlDiff,this.enhanceDiffDisplay(n),e.querySelectorAll("a").forEach(a=>{a.addEventListener("click",i=>{i.preventDefault();const l=document.querySelector(a.getAttribute("href"));l&&l.scrollIntoView({behavior:"smooth",block:"start"})})})}calculateStats(t){const n={added:0,removed:0,modified:0};return t.patches.forEach(e=>{e.added?n.added++:e.removed?n.removed++:e.value.trim()&&n.modified++}),n}enhanceDiffDisplay(t){t.querySelectorAll("code").forEach(e=>{e.classList.contains("enhanced")||(e.classList.add("enhanced"),this.addLineNumbers(e))}),this.addCollapseFeature(t)}addLineNumbers(t){const e=t.innerHTML.split(`
`).map((s,a)=>`<span class="line-number">${a+1}</span>${s}`);t.innerHTML=e.join(`
`)}addCollapseFeature(t){t.querySelectorAll(".d2h-file-wrapper").forEach(e=>{const s=e.querySelector(".d2h-file-header");s&&s.addEventListener("click",()=>{const a=e.querySelector(".d2h-file-diff");a&&a.classList.toggle("collapsed")})})}clear(){const t=this.element.querySelector(".diff-content"),n=this.element.querySelector(".diff-stats");t.innerHTML='<div class="diff-placeholder">Select two Postman collections to see the differences</div>',n.innerHTML=""}}class Ne{element;options;tree=[];selectedNode=null;constructor(t,n={}){const e=document.getElementById(t);if(!e)throw new Error(`Container with id "${t}" not found`);this.options={showChangeIndicators:!0,expandAll:!1,...n},this.element=this.createElement(),e.appendChild(this.element)}createElement(){const t=document.createElement("div");return t.className="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg overflow-hidden transition-colors duration-300",t.innerHTML=`
      <div class="bg-zinc-50 dark:bg-zinc-800 border-b border-zinc-200 dark:border-zinc-700 px-4 py-3 flex justify-between items-center transition-colors duration-300">
        <h3 class="font-semibold text-zinc-900 dark:text-zinc-100">Collection Structure</h3>
        <div class="flex gap-2">
          <button class="tree-control-btn px-2 py-1 text-xs bg-transparent border border-zinc-300 dark:border-zinc-600 text-zinc-600 dark:text-zinc-400 rounded hover:bg-zinc-100 dark:hover:bg-zinc-700 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors duration-200" data-action="expand-all" title="Expand All">
            <span class="icon">‚äû</span>
          </button>
          <button class="tree-control-btn px-2 py-1 text-xs bg-transparent border border-zinc-300 dark:border-zinc-600 text-zinc-600 dark:text-zinc-400 rounded hover:bg-zinc-100 dark:hover:bg-zinc-700 hover:text-zinc-900 dark:hover:text-zinc-100 transition-colors duration-200" data-action="collapse-all" title="Collapse All">
            <span class="icon">‚äü</span>
          </button>
        </div>
      </div>
      <div class="max-h-96 overflow-y-auto p-2">
        <div class="tree-placeholder text-center text-zinc-500 dark:text-zinc-400 py-8 italic">
          Load collections to see structure
        </div>
      </div>
    `,this.setupEventListeners(t),t}setupEventListeners(t){t.addEventListener("click",n=>{const e=n.target,s=e.closest(".tree-control-btn");if(s){const i=s.dataset.action;i==="expand-all"?this.expandAll():i==="collapse-all"&&this.collapseAll()}const a=e.closest(".tree-node");if(a){const i=a.dataset.nodeId,l=this.findNodeById(i);l&&(e.classList.contains("tree-toggle")?this.toggleNode(l):this.selectNode(l))}})}loadCollection(t,n="diff"){this.tree=this.buildTree(t,n),this.render()}updateWithDiff(t,n){const e=this.flattenItems(t.items),s=this.flattenItems(n.items),a=new Map(e.map(o=>[o.id,o])),i=new Map(s.map(o=>[o.id,o])),l=[];a.forEach((o,f)=>{i.has(f)||l.push({...o,changeType:"removed"})}),i.forEach((o,f)=>{if(!a.has(f))l.push({...o,changeType:"added"});else{const p=a.get(f);if(this.hasItemChanged(p,o)){const C=this.getItemChanges(p,o);l.push({...o,changeType:"modified",changeDetails:C})}}}),this.tree=this.buildTreeFromChangedItems(l,n.info.name),this.render()}buildTreeFromChangedItems(t,n){if(t.length===0)return[{id:"no-changes",name:"No changes detected",type:"collection",expanded:!0}];const e=new Map;t.forEach(o=>{const f=o.parentPath||"";e.has(f)||e.set(f,[]),e.get(f).push(o)});const s=t.filter(o=>o.changeType==="added").length,a=t.filter(o=>o.changeType==="removed").length,i=t.filter(o=>o.changeType==="modified").length,l={id:"changed-items",name:`${n} (+${s} -${a} ~${i})`,type:"collection",expanded:!0,children:[],changeType:"modified"};return e.forEach((o,f)=>{if(f){const p={id:`folder-${f}`,name:f,type:"folder",expanded:!0,children:o.map(C=>this.createTreeNode(C)),changeType:"modified"};l.children.push(p)}else o.forEach(p=>{l.children.push(this.createTreeNode(p))})}),[l]}createTreeNode(t){return{id:t.id,name:t.name,type:t.children?"folder":"request",method:t.method,changeType:t.changeType,changeDetails:t.changeDetails,expanded:!1}}flattenItems(t,n=""){const e=[];return t.forEach(s=>{const a=n?`${n}/${s.name}`:s.name;e.push({...s,path:a,parentPath:n}),s.children&&e.push(...this.flattenItems(s.children,a))}),e}hasItemChanged(t,n){const e=Array.isArray(t.tests)?t.tests.join(`
`):t.tests||"",s=Array.isArray(n.tests)?n.tests.join(`
`):n.tests||"",a=Array.isArray(t.prerequest)?t.prerequest.join(`
`):t.prerequest||"",i=Array.isArray(n.prerequest)?n.prerequest.join(`
`):n.prerequest||"";return t.children&&n.children?e!==s||a!==i:t.method!==n.method||t.url!==n.url||t.body!==n.body||JSON.stringify(t.headers||{})!==JSON.stringify(n.headers||{})||e!==s||a!==i}getItemChanges(t,n){const e=[],s=Array.isArray(t.tests)?t.tests.join(`
`):t.tests||"",a=Array.isArray(n.tests)?n.tests.join(`
`):n.tests||"",i=Array.isArray(t.prerequest)?t.prerequest.join(`
`):t.prerequest||"",l=Array.isArray(n.prerequest)?n.prerequest.join(`
`):n.prerequest||"";return t.url!==n.url&&e.push("URL"),t.method!==n.method&&e.push("Method"),t.body!==n.body&&e.push("Body"),JSON.stringify(t.headers||{})!==JSON.stringify(n.headers||{})&&e.push("Headers"),s!==a&&e.push("Tests"),i!==l&&e.push("Pre-request"),e.join(", ")}buildTree(t,n){return[{id:"collection-"+t.info.name.replace(/[^a-zA-Z0-9]/g,"-"),name:t.info.name,type:"collection",expanded:!0,children:this.buildItemNodes(t.items,n),changeType:n==="diff"?"unchanged":void 0}]}buildItemNodes(t,n){return t.map(e=>({id:e.id,name:e.name,type:e.children?"folder":"request",method:e.method,expanded:this.options.expandAll,children:e.children?this.buildItemNodes(e.children,n):void 0,changeType:n==="diff"?"unchanged":void 0}))}render(){const t=this.element.querySelector(".max-h-96");if(this.tree.length===0){t.innerHTML='<div class="tree-placeholder text-center text-zinc-500 dark:text-zinc-400 py-8 italic">Load collections to see structure</div>';return}t.innerHTML=this.renderNodes(this.tree)}renderNodes(t,n=0){return t.map(e=>this.renderNode(e,n)).join("")}renderNode(t,n){const e=t.children&&t.children.length>0,s=t.expanded,a=t.selected?"bg-blue-100 dark:bg-blue-900/30":"hover:bg-zinc-100 dark:hover:bg-zinc-800",i=n*16;let l="",o="";t.type==="collection"?(l="üìä",o="text-blue-600 dark:text-blue-400"):t.type==="folder"?(l="üìÅ",o="text-zinc-600 dark:text-zinc-400"):t.changeType==="added"?(o="text-green-600 dark:text-green-400",l="‚ûï"):t.changeType==="removed"?(o="text-red-600 dark:text-red-400",l="‚ûñ"):t.changeType==="modified"&&(o="text-yellow-600 dark:text-yellow-400",l="üîÑ");let f="";e&&(f=`<button class="tree-toggle w-4 h-4 flex items-center justify-center text-zinc-500 dark:text-zinc-400 hover:text-zinc-700 dark:hover:text-zinc-200 mr-2 text-xs transition-colors duration-200">${s?"‚ñº":"‚ñ∂"}</button>`);let p="";t.changeDetails&&(p=`<span class="text-xs text-zinc-500 dark:text-zinc-400 ml-2">(${t.changeDetails})</span>`);let C="";t.type==="request"&&t.method&&(C=`<span class="text-xs font-mono text-zinc-600 dark:text-zinc-400 ml-2">[${t.method}]</span>`);let E="";e&&s&&(E=`<div class="border-l border-zinc-200 dark:border-zinc-700 ml-3">${this.renderNodes(t.children,n+1)}</div>`);const c=t.changeType==="added"?"added-section":t.changeType==="removed"?"removed-section":t.changeType==="modified"?"modified-section":"";return`
      <div class="tree-node my-0.5 rounded transition-colors duration-150 ${a}" data-node-id="${t.id}" data-section="${c}">
        <div class="flex items-center py-1 px-2 cursor-pointer min-h-[28px]" style="padding-left: ${i+8}px">
          ${f}
          <span class="mr-2 text-sm flex-shrink-0 ${o}">${l}</span>
          <span class="flex-1 text-zinc-900 dark:text-zinc-100 text-sm truncate">${t.name}</span>
          ${C}
          ${p}
        </div>
        ${E}
      </div>
    `}findNodeById(t){const n=e=>{for(const s of e){if(s.id===t)return s;if(s.children){const a=n(s.children);if(a)return a}}return null};return n(this.tree)}toggleNode(t){t.expanded=!t.expanded,this.render(),this.options.onNodeToggle?.(t)}selectNode(t){let n="";if(t.changeType==="added"?n=`added-${t.id}`:t.changeType==="removed"?n=`removed-${t.id}`:t.changeType==="modified"&&(n=`modified-${t.id}`),n){const e=document.getElementById(n);e&&(e.scrollIntoView({behavior:"smooth",block:"start"}),e.style.backgroundColor="#fbbf24",setTimeout(()=>{e.style.backgroundColor=""},1e3))}this.selectedNode&&(this.selectedNode.selected=!1),t.selected=!0,this.selectedNode=t,this.render(),this.options.onNodeSelect?.(t)}expandAll(){const t=n=>{n.forEach(e=>{e.expanded=!0,e.children&&t(e.children)})};t(this.tree),this.render()}collapseAll(){const t=n=>{n.forEach(e=>{e.expanded=!1,e.children&&t(e.children)})};t(this.tree),this.render()}getSelectedNode(){return this.selectedNode}clear(){this.tree=[],this.selectedNode=null,this.render()}}class Le{element;currentData={};onExport;onImportFromPr;constructor(t,n={}){const e=document.getElementById(t);if(!e)throw new Error(`Container with id "${t}" not found`);this.onExport=n.onExport,this.onImportFromPr=n.onImportFromPr,this.element=this.createElement(),e.appendChild(this.element)}createElement(){const t=document.createElement("div");return t.className="bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg overflow-hidden min-w-[200px] transition-colors duration-300",t.innerHTML=`
      <div class="bg-zinc-50 dark:bg-zinc-800 border-b border-zinc-200 dark:border-zinc-700 px-4 py-3 transition-colors duration-300">
        <h3 class="font-semibold text-zinc-900 dark:text-zinc-100 text-sm">Export Results</h3>
      </div>
      <div class="p-4">
        <div class="flex flex-col gap-2 mb-4">
          <button class="export-btn flex items-center gap-2 bg-zinc-100 dark:bg-zinc-800 hover:bg-zinc-200 dark:hover:bg-zinc-700 border border-zinc-300 dark:border-zinc-600 text-zinc-900 dark:text-zinc-100 px-3 py-2 rounded-md cursor-pointer transition-all duration-200 text-sm disabled:opacity-50 disabled:cursor-not-allowed" data-format="markdown" title="Export as Markdown Report">
            <span class="text-base">üìÑ</span>
            <span class="font-medium">Markdown Report</span>
          </button>
          <button class="pr-fetch-btn flex items-center gap-2 bg-zinc-100 dark:bg-zinc-800 hover:bg-zinc-200 dark:hover:bg-zinc-700 border border-blue-300 dark:border-blue-600 text-blue-700 dark:text-blue-300 px-3 py-2 rounded-md cursor-pointer transition-all duration-200 text-sm" title="Fetch collections from a GitHub PR">
            <span class="text-base">üîé</span>
            <span class="font-medium">Fetch from PR</span>
          </button>
        </div>
        <div class="export-status info text-zinc-600 dark:text-zinc-400 text-xs">
          Ready to export when diff is available
        </div>
      </div>
    `,this.setupEventListeners(t),t}setupEventListeners(t){t.addEventListener("click",n=>{const e=n.target,s=e.closest(".export-btn");if(s){const i=s.dataset.format;i&&this.handleExport(i)}e.closest(".pr-fetch-btn")&&this.openPrModal()})}handleExport(t){if(!this.currentData.diffResult){this.showStatus("No diff data available to export","error");return}this.showStatus("Preparing export...","loading");try{this.onExport?.(t,this.currentData),this.exportMarkdown(),this.showStatus("Export completed successfully","success")}catch(n){this.showStatus("Export failed: "+n.message,"error")}}exportMarkdown(){const t=this.generateMarkdownReport();this.downloadFile(t,"postman-diff-report.md","text/markdown")}generateMarkdownReport(){const{oldCollection:t,newCollection:n}=this.currentData;if(!t||!n)return`# Postman Collection Diff Report

Please load both collections to generate a report.`;const e=t?.info.name||"Old Collection",s=n?.info.name||"New Collection";let i=`# Postman Collection Diff Report

**Generated:** ${new Date().toISOString()}
**Comparing:** ${e} ‚Üí ${s}

## Summary

`;const l=this.compareCollections(t,n);return i+=`
- **Added:** ${l.added.length} items
- **Removed:** ${l.removed.length} items  
- **Modified:** ${l.modified.length} items

`,l.added.length>0&&(i+=`## ‚úÖ Added Items

`,l.added.forEach(o=>{const p=!!o.children&&o.children.length>0?"üìÅ ":"";i+=`- ${p}**${o.name}**`,o.method&&o.url&&(i+=` - \`${o.method} ${o.url}\``),i+=`
`}),i+=`
`),l.removed.length>0&&(i+=`## ‚ùå Removed Items

`,l.removed.forEach(o=>{const p=!!o.children&&o.children.length>0?"üìÅ ":"";i+=`- ${p}**${o.name}**`,o.method&&o.url&&(i+=` - \`${o.method} ${o.url}\``),i+=`
`}),i+=`
`),l.modified.length>0&&(i+=`## üîÑ Modified Items

`,l.modified.forEach(o=>{const p=!!o.children&&o.children.length>0?"üìÅ ":"";i+=`- ${p}**${o.name}**`,o.method&&o.url&&(i+=` - \`${o.method} ${o.url}\``),o.changes&&o.changes.length>0&&(i+=`
  Changes:
`,o.changes.forEach(C=>{i+=`  - ${C}
`})),i+=`
`}),i+=`
`),i+=`
---
*Report generated by Postman Collection Diff Viewer*
`,i}compareCollections(t,n){const e=[],s=[],a=[];if(!t||!n)return{added:e,removed:s,modified:a};const i=this.flattenItems(t.items||[]),l=this.flattenItems(n.items||[]),o=new Map(i.map(p=>[p.id,p])),f=new Map(l.map(p=>[p.id,p]));return o.forEach((p,C)=>{f.has(C)||s.push(p)}),f.forEach((p,C)=>{if(!o.has(C))e.push(p);else{const E=o.get(C),c=this.getItemChanges(E,p);c.length>0&&a.push({...p,changes:c})}}),{added:e,removed:s,modified:a}}flattenItems(t,n=[]){return t.forEach(e=>{n.push(e),e.children&&this.flattenItems(e.children,n)}),n}getItemChanges(t,n){const e=[];return t.method!==n.method&&e.push(`Method changed from ${t.method} to ${n.method}`),t.url!==n.url&&e.push(`URL changed from "${t.url}" to "${n.url}"`),JSON.stringify(t.headers)!==JSON.stringify(n.headers)&&e.push("Headers modified"),t.body!==n.body&&e.push("Body modified"),JSON.stringify(t.tests)!==JSON.stringify(n.tests)&&e.push("Tests modified"),e}downloadFile(t,n,e){const s=new Blob([t],{type:e}),a=URL.createObjectURL(s),i=document.createElement("a");i.href=a,i.download=n,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)}openPrModal(){const t=document.createElement("div");t.className="fixed inset-0 bg-black/40 flex items-center justify-center z-[1000]";const n=document.createElement("div");n.className="bg-white dark:bg-zinc-900 rounded-lg shadow-xl w-[95vw] max-w-xl p-4 border border-zinc-200 dark:border-zinc-700",n.innerHTML=`
      <h3 class="text-lg font-semibold mb-3 text-zinc-900 dark:text-zinc-100">Fetch Collections from GitHub PR</h3>
      <div class="space-y-3">
        <input id="pr-url" type="url" placeholder="https://github.com/owner/repo/pull/123" class="w-full px-3 py-2 bg-zinc-50 dark:bg-zinc-800 border border-zinc-300 dark:border-zinc-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"/>
        <div class="flex gap-2">
          <button id="load-pr" class="px-3 py-2 bg-blue-600 text-white rounded disabled:opacity-50">Load</button>
          <button id="cancel-pr" class="px-3 py-2 bg-zinc-200 dark:bg-zinc-700 rounded">Cancel</button>
        </div>
        <div id="pr-status" class="text-sm text-zinc-600 dark:text-zinc-400"></div>
        <div id="pr-files" class="max-h-60 overflow-auto space-y-2"></div>
      </div>
    `,t.appendChild(n),document.body.appendChild(t);const e=()=>document.body.removeChild(t);n.querySelector("#cancel-pr").addEventListener("click",e);const s=n.querySelector("#load-pr"),a=n.querySelector("#pr-url"),i=n.querySelector("#pr-status"),l=n.querySelector("#pr-files"),o=E=>{const c=E.match(/github\.com\/([^/]+)\/([^/]+)\/(pull|pulls)\/([0-9]+)/);return c?{owner:c[1],repo:c[2],number:c[4]}:null},f=async E=>{const h=await fetch(E,{headers:{Accept:"application/vnd.github+json"}});if(!h.ok)throw new Error(`GitHub API ${h.status}`);return h.json()},p=async E=>{const h=await fetch(E,{headers:{Accept:"application/vnd.github.v3.raw"}});if(!h.ok)throw new Error(`GitHub raw ${h.status}`);return h.text()},C=E=>!!E?.info?.schema?.includes("collection/v2.1");s.addEventListener("click",async()=>{const E=o(a.value.trim());if(!E){i.textContent="Invalid PR URL";return}l.innerHTML="",i.textContent="Loading PR files‚Ä¶",s.disabled=!0;try{const c=await f(`https://api.github.com/repos/${E.owner}/${E.repo}/pulls/${E.number}`);let h=1,g=[];for(;;){const v=await f(`https://api.github.com/repos/${E.owner}/${E.repo}/pulls/${E.number}/files?per_page=100&page=${h}`);if(!Array.isArray(v)||v.length===0||(g=g.concat(v),v.length<100)||(h++,h>10))break}const b=c?.base?.sha,y=c?.head?.sha,z=(g||[]).filter(v=>typeof v.filename=="string"&&v.filename.endsWith(".json")),x=[];for(const v of z)try{const w=encodeURIComponent(v.filename).replace(/%2F/g,"/");let $=null;try{const d=await p(`https://api.github.com/repos/${E.owner}/${E.repo}/contents/${w}?ref=${y}`),u=JSON.parse(d);C(u)&&($=u)}catch{}let k=null;try{const d=await p(`https://api.github.com/repos/${E.owner}/${E.repo}/contents/${w}?ref=${b}`),u=JSON.parse(d);C(u)&&(k=u)}catch{}($||k)&&x.push({path:v.filename,oldCol:k,newCol:$})}catch{}x.length===0?i.textContent="No Postman v2.1 collections found in PR":(i.textContent="Select a collection to load",l.innerHTML=x.map((v,w)=>{const $=v.oldCol?.info?.name||"‚Äî",k=v.newCol?.info?.name||"‚Äî";return`<div class="flex items-center justify-between gap-2 p-2 border border-zinc-200 dark:border-zinc-700 rounded"><div class="text-sm"><div class="font-medium">${v.path}</div><div class="text-zinc-500 dark:text-zinc-400">Old: ${$} ¬∑ New: ${k}</div></div><button data-idx="${w}" class="select-pr px-3 py-1.5 bg-blue-600 text-white rounded">Select</button></div>`}).join(""),l.querySelectorAll(".select-pr").forEach(v=>{v.addEventListener("click",()=>{const w=Number(v.getAttribute("data-idx")),$=x[w];this.onImportFromPr?.($.oldCol,$.newCol,{path:$.path,prNumber:E.number,repo:`${E.owner}/${E.repo}`}),e()})}))}catch(c){i.textContent=`Failed to load PR: ${c.message}`}finally{s.disabled=!1}})}showStatus(t,n="info"){const e=this.element.querySelector(".export-status");e&&(e.textContent=t,e.className=`export-status ${n}`,(n==="success"||n==="error")&&setTimeout(()=>{e.textContent="Ready to export when diff is available",e.className="export-status"},3e3))}updateData(t){this.currentData={...this.currentData,...t},this.updateButtonStates()}updateButtonStates(){const t=this.element.querySelectorAll(".export-btn"),n=!!this.currentData.diffResult;t.forEach(e=>{e.disabled=!n}),n?this.showStatus("Ready to export","success"):this.showStatus("Ready to export when diff is available","info")}setEnabled(t){this.element.querySelectorAll(".export-btn").forEach(e=>{e.disabled=!t||!this.currentData.diffResult}),t?this.element.classList.remove("opacity-50","pointer-events-none"):this.element.classList.add("opacity-50","pointer-events-none")}}var pe;(function(r){r.INSERT="insert",r.DELETE="delete",r.CONTEXT="context"})(pe||(pe={}));const Se={LINE_BY_LINE:"line-by-line"},ke={NONE:"none"},De={WORD:"word"};var re;(function(r){r.AUTO="auto",r.DARK="dark",r.LIGHT="light"})(re||(re={}));function M(){}M.prototype={diff:function(t,n){var e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=s.callback;typeof s=="function"&&(a=s,s={});var i=this;function l(v){return v=i.postProcess(v,s),a?(setTimeout(function(){a(v)},0),!0):v}t=this.castInput(t,s),n=this.castInput(n,s),t=this.removeEmpty(this.tokenize(t,s)),n=this.removeEmpty(this.tokenize(n,s));var o=n.length,f=t.length,p=1,C=o+f;s.maxEditLength!=null&&(C=Math.min(C,s.maxEditLength));var E=(e=s.timeout)!==null&&e!==void 0?e:1/0,c=Date.now()+E,h=[{oldPos:-1,lastComponent:void 0}],g=this.extractCommon(h[0],n,t,0,s);if(h[0].oldPos+1>=f&&g+1>=o)return l(me(i,h[0].lastComponent,n,t,i.useLongestToken));var b=-1/0,y=1/0;function z(){for(var v=Math.max(b,-p);v<=Math.min(y,p);v+=2){var w=void 0,$=h[v-1],k=h[v+1];$&&(h[v-1]=void 0);var d=!1;if(k){var u=k.oldPos-v;d=k&&0<=u&&u<o}var m=$&&$.oldPos+1<f;if(!d&&!m){h[v]=void 0;continue}if(!m||d&&$.oldPos<k.oldPos?w=i.addToPath(k,!0,!1,0,s):w=i.addToPath($,!1,!0,1,s),g=i.extractCommon(w,n,t,v,s),w.oldPos+1>=f&&g+1>=o)return l(me(i,w.lastComponent,n,t,i.useLongestToken));h[v]=w,w.oldPos+1>=f&&(y=Math.min(y,v-1)),g+1>=o&&(b=Math.max(b,v+1))}p++}if(a)(function v(){setTimeout(function(){if(p>C||Date.now()>c)return a();z()||v()},0)})();else for(;p<=C&&Date.now()<=c;){var x=z();if(x)return x}},addToPath:function(t,n,e,s,a){var i=t.lastComponent;return i&&!a.oneChangePerToken&&i.added===n&&i.removed===e?{oldPos:t.oldPos+s,lastComponent:{count:i.count+1,added:n,removed:e,previousComponent:i.previousComponent}}:{oldPos:t.oldPos+s,lastComponent:{count:1,added:n,removed:e,previousComponent:i}}},extractCommon:function(t,n,e,s,a){for(var i=n.length,l=e.length,o=t.oldPos,f=o-s,p=0;f+1<i&&o+1<l&&this.equals(e[o+1],n[f+1],a);)f++,o++,p++,a.oneChangePerToken&&(t.lastComponent={count:1,previousComponent:t.lastComponent,added:!1,removed:!1});return p&&!a.oneChangePerToken&&(t.lastComponent={count:p,previousComponent:t.lastComponent,added:!1,removed:!1}),t.oldPos=o,f},equals:function(t,n,e){return e.comparator?e.comparator(t,n):t===n||e.ignoreCase&&t.toLowerCase()===n.toLowerCase()},removeEmpty:function(t){for(var n=[],e=0;e<t.length;e++)t[e]&&n.push(t[e]);return n},castInput:function(t){return t},tokenize:function(t){return Array.from(t)},join:function(t){return t.join("")},postProcess:function(t){return t}};function me(r,t,n,e,s){for(var a=[],i;t;)a.push(t),i=t.previousComponent,delete t.previousComponent,t=i;a.reverse();for(var l=0,o=a.length,f=0,p=0;l<o;l++){var C=a[l];if(C.removed)C.value=r.join(e.slice(p,p+C.count)),p+=C.count;else{if(!C.added&&s){var E=n.slice(f,f+C.count);E=E.map(function(c,h){var g=e[p+h];return g.length>c.length?g:c}),C.value=r.join(E)}else C.value=r.join(n.slice(f,f+C.count));f+=C.count,C.added||(p+=C.count)}}return a}function be(r,t){var n;for(n=0;n<r.length&&n<t.length;n++)if(r[n]!=t[n])return r.slice(0,n);return r.slice(0,n)}function ge(r,t){var n;if(!r||!t||r[r.length-1]!=t[t.length-1])return"";for(n=0;n<r.length&&n<t.length;n++)if(r[r.length-(n+1)]!=t[t.length-(n+1)])return r.slice(-n);return r.slice(-n)}function se(r,t,n){if(r.slice(0,t.length)!=t)throw Error("string ".concat(JSON.stringify(r)," doesn't start with prefix ").concat(JSON.stringify(t),"; this is a bug"));return n+r.slice(t.length)}function ie(r,t,n){if(!t)return r+n;if(r.slice(-t.length)!=t)throw Error("string ".concat(JSON.stringify(r)," doesn't end with suffix ").concat(JSON.stringify(t),"; this is a bug"));return r.slice(0,-t.length)+n}function G(r,t){return se(r,t,"")}function W(r,t){return ie(r,t,"")}function ve(r,t){return t.slice(0,Pe(r,t))}function Pe(r,t){var n=0;r.length>t.length&&(n=r.length-t.length);var e=t.length;r.length<t.length&&(e=r.length);var s=Array(e),a=0;s[0]=0;for(var i=1;i<e;i++){for(t[i]==t[a]?s[i]=s[a]:s[i]=a;a>0&&t[i]!=t[a];)a=s[a];t[i]==t[a]&&a++}a=0;for(var l=n;l<r.length;l++){for(;a>0&&r[l]!=t[a];)a=s[a];r[l]==t[a]&&a++}return a}var Y="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",Ae=new RegExp("[".concat(Y,"]+|\\s+|[^").concat(Y,"]"),"ug"),Q=new M;Q.equals=function(r,t,n){return n.ignoreCase&&(r=r.toLowerCase(),t=t.toLowerCase()),r.trim()===t.trim()};Q.tokenize=function(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;if(t.intlSegmenter){if(t.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');n=Array.from(t.intlSegmenter.segment(r),function(a){return a.segment})}else n=r.match(Ae)||[];var e=[],s=null;return n.forEach(function(a){/\s/.test(a)?s==null?e.push(a):e.push(e.pop()+a):/\s/.test(s)?e[e.length-1]==s?e.push(e.pop()+a):e.push(s+a):e.push(a),s=a}),e};Q.join=function(r){return r.map(function(t,n){return n==0?t:t.replace(/^\s+/,"")}).join("")};Q.postProcess=function(r,t){if(!r||t.oneChangePerToken)return r;var n=null,e=null,s=null;return r.forEach(function(a){a.added?e=a:a.removed?s=a:((e||s)&&ye(n,s,e,a),n=a,e=null,s=null)}),(e||s)&&ye(n,s,e,null),r};function ye(r,t,n,e){if(t&&n){var s=t.value.match(/^\s*/)[0],a=t.value.match(/\s*$/)[0],i=n.value.match(/^\s*/)[0],l=n.value.match(/\s*$/)[0];if(r){var o=be(s,i);r.value=ie(r.value,i,o),t.value=G(t.value,o),n.value=G(n.value,o)}if(e){var f=ge(a,l);e.value=se(e.value,l,f),t.value=W(t.value,f),n.value=W(n.value,f)}}else if(n)r&&(n.value=n.value.replace(/^\s*/,"")),e&&(e.value=e.value.replace(/^\s*/,""));else if(r&&e){var p=e.value.match(/^\s*/)[0],C=t.value.match(/^\s*/)[0],E=t.value.match(/\s*$/)[0],c=be(p,C);t.value=G(t.value,c);var h=ge(G(p,c),E);t.value=W(t.value,h),e.value=se(e.value,p,h),r.value=ie(r.value,p,p.slice(0,p.length-h.length))}else if(e){var g=e.value.match(/^\s*/)[0],b=t.value.match(/\s*$/)[0],y=ve(b,g);t.value=W(t.value,y)}else if(r){var z=r.value.match(/\s*$/)[0],x=t.value.match(/^\s*/)[0],v=ve(z,x);t.value=G(t.value,v)}}var Oe=new M;Oe.tokenize=function(r){var t=new RegExp("(\\r?\\n)|[".concat(Y,"]+|[^\\S\\n\\r]+|[^").concat(Y,"]"),"ug");return r.match(t)||[]};var de=new M;de.tokenize=function(r,t){t.stripTrailingCr&&(r=r.replace(/\r\n/g,`
`));var n=[],e=r.split(/(\n|\r\n)/);e[e.length-1]||e.pop();for(var s=0;s<e.length;s++){var a=e[s];s%2&&!t.newlineIsToken?n[n.length-1]+=a:n.push(a)}return n};de.equals=function(r,t,n){return n.ignoreWhitespace?((!n.newlineIsToken||!r.includes(`
`))&&(r=r.trim()),(!n.newlineIsToken||!t.includes(`
`))&&(t=t.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(r.endsWith(`
`)&&(r=r.slice(0,-1)),t.endsWith(`
`)&&(t=t.slice(0,-1))),M.prototype.equals.call(this,r,t,n)};var Me=new M;Me.tokenize=function(r){return r.split(/(\S.+?[.!?])(?=\s+|$)/)};var qe=new M;qe.tokenize=function(r){return r.split(/([{}:;,]|\s+)/)};function ae(r){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(r)}var _=new M;_.useLongestToken=!0;_.tokenize=de.tokenize;_.castInput=function(r,t){var n=t.undefinedReplacement,e=t.stringifyReplacer,s=e===void 0?function(a,i){return typeof i>"u"?n:i}:e;return typeof r=="string"?r:JSON.stringify(oe(r,null,null,s),s,"  ")};_.equals=function(r,t,n){return M.prototype.equals.call(_,r.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"),n)};function oe(r,t,n,e,s){t=t||[],n=n||[],e&&(r=e(s,r));var a;for(a=0;a<t.length;a+=1)if(t[a]===r)return n[a];var i;if(Object.prototype.toString.call(r)==="[object Array]"){for(t.push(r),i=new Array(r.length),n.push(i),a=0;a<r.length;a+=1)i[a]=oe(r[a],t,n,e,s);return t.pop(),n.pop(),i}if(r&&r.toJSON&&(r=r.toJSON()),ae(r)==="object"&&r!==null){t.push(r),i={},n.push(i);var l=[],o;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&l.push(o);for(l.sort(),a=0;a<l.length;a+=1)o=l[a],i[o]=oe(r[o],t,n,e,o);t.pop(),n.pop()}else i=r;return i}var le=new M;le.tokenize=function(r){return r.slice()};le.join=le.removeEmpty=function(r){return r};const ce={matching:ke.NONE,matchWordsThreshold:.25,maxLineLengthHighlight:1e4,diffStyle:De.WORD,colorScheme:re.LIGHT};ce.colorScheme;const Re=Object.assign(Object.assign({},ce),{renderNothingWhenEmpty:!1,matchingMaxComparisons:2500,maxLineSizeInBlockForComparison:200}),Fe=Object.assign(Object.assign({},ce),{renderNothingWhenEmpty:!1,matchingMaxComparisons:2500,maxLineSizeInBlockForComparison:200});var ee={},xe;function He(){return xe||(xe=1,(function(r){(function(t){var n=/\S/,e=/\"/g,s=/\n/g,a=/\r/g,i=/\\/g,l=/\u2028/,o=/\u2029/;t.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},t.scan=function(u,m){var T=u.length,D=0,A=1,B=2,N=D,V=null,X=null,H="",P=[],j=!1,L=0,Z=0,I="{{",F="}}";function he(){H.length>0&&(P.push({tag:"_t",text:new String(H)}),H="")}function ze(){for(var q=!0,O=Z;O<P.length;O++)if(q=t.tags[P[O].tag]<t.tags._v||P[O].tag=="_t"&&P[O].text.match(n)===null,!q)return!1;return q}function ue(q,O){if(he(),q&&ze())for(var R=Z,J;R<P.length;R++)P[R].text&&((J=P[R+1])&&J.tag==">"&&(J.indent=P[R].text.toString()),P.splice(R,1));else O||P.push({tag:`
`});j=!1,Z=P.length}function Te(q,O){var R="="+F,J=q.indexOf(R,O),K=p(q.substring(q.indexOf("=",O)+1,J)).split(" ");return I=K[0],F=K[K.length-1],J+R.length-1}for(m&&(m=m.split(" "),I=m[0],F=m[1]),L=0;L<T;L++)N==D?C(I,u,L)?(--L,he(),N=A):u.charAt(L)==`
`?ue(j):H+=u.charAt(L):N==A?(L+=I.length-1,X=t.tags[u.charAt(L+1)],V=X?u.charAt(L+1):"_v",V=="="?(L=Te(u,L),N=D):(X&&L++,N=B),j=L):C(F,u,L)?(P.push({tag:V,n:p(H),otag:I,ctag:F,i:V=="/"?j-I.length:L+F.length}),H="",L+=F.length-1,N=D,V=="{"&&(F=="}}"?L++:f(P[P.length-1]))):H+=u.charAt(L);return ue(j,!0),P};function f(d){d.n.substr(d.n.length-1)==="}"&&(d.n=d.n.substring(0,d.n.length-1))}function p(d){return d.trim?d.trim():d.replace(/^\s*|\s*$/g,"")}function C(d,u,m){if(u.charAt(m)!=d.charAt(0))return!1;for(var T=1,D=d.length;T<D;T++)if(u.charAt(m+T)!=d.charAt(T))return!1;return!0}var E={_t:!0,"\n":!0,$:!0,"/":!0};function c(d,u,m,T){var D=[],A=null,B=null,N=null;for(B=m[m.length-1];d.length>0;){if(N=d.shift(),B&&B.tag=="<"&&!(N.tag in E))throw new Error("Illegal content in < super tag.");if(t.tags[N.tag]<=t.tags.$||h(N,T))m.push(N),N.nodes=c(d,N.tag,m,T);else if(N.tag=="/"){if(m.length===0)throw new Error("Closing tag without opener: /"+N.n);if(A=m.pop(),N.n!=A.n&&!g(N.n,A.n,T))throw new Error("Nesting error: "+A.n+" vs. "+N.n);return A.end=N.i,D}else N.tag==`
`&&(N.last=d.length==0||d[0].tag==`
`);D.push(N)}if(m.length>0)throw new Error("missing closing tag: "+m.pop().n);return D}function h(d,u){for(var m=0,T=u.length;m<T;m++)if(u[m].o==d.n)return d.tag="#",!0}function g(d,u,m){for(var T=0,D=m.length;T<D;T++)if(m[T].c==d&&m[T].o==u)return!0}function b(d){var u=[];for(var m in d)u.push('"'+x(m)+'": function(c,p,t,i) {'+d[m]+"}");return"{ "+u.join(",")+" }"}function y(d){var u=[];for(var m in d.partials)u.push('"'+x(m)+'":{name:"'+x(d.partials[m].name)+'", '+y(d.partials[m])+"}");return"partials: {"+u.join(",")+"}, subs: "+b(d.subs)}t.stringify=function(d,u,m){return"{code: function (c,p,i) { "+t.wrapMain(d.code)+" },"+y(d)+"}"};var z=0;t.generate=function(d,u,m){z=0;var T={code:"",subs:{},partials:{}};return t.walk(d,T),m.asString?this.stringify(T,u,m):this.makeTemplate(T,u,m)},t.wrapMain=function(d){return'var t=this;t.b(i=i||"");'+d+"return t.fl();"},t.template=t.Template,t.makeTemplate=function(d,u,m){var T=this.makePartials(d);return T.code=new Function("c","p","i",this.wrapMain(d.code)),new this.template(T,u,this,m)},t.makePartials=function(d){var u,m={subs:{},partials:d.partials,name:d.name};for(u in m.partials)m.partials[u]=this.makePartials(m.partials[u]);for(u in d.subs)m.subs[u]=new Function("c","p","t","i",d.subs[u]);return m};function x(d){return d.replace(i,"\\\\").replace(e,'\\"').replace(s,"\\n").replace(a,"\\r").replace(l,"\\u2028").replace(o,"\\u2029")}function v(d){return~d.indexOf(".")?"d":"f"}function w(d,u){var m="<"+(u.prefix||""),T=m+d.n+z++;return u.partials[T]={name:d.n,partials:{}},u.code+='t.b(t.rp("'+x(T)+'",c,p,"'+(d.indent||"")+'"));',T}t.codegen={"#":function(d,u){u.code+="if(t.s(t."+v(d.n)+'("'+x(d.n)+'",c,p,1),c,p,0,'+d.i+","+d.end+',"'+d.otag+" "+d.ctag+'")){t.rs(c,p,function(c,p,t){',t.walk(d.nodes,u),u.code+="});c.pop();}"},"^":function(d,u){u.code+="if(!t.s(t."+v(d.n)+'("'+x(d.n)+'",c,p,1),c,p,1,0,0,"")){',t.walk(d.nodes,u),u.code+="};"},">":w,"<":function(d,u){var m={partials:{},code:"",subs:{},inPartial:!0};t.walk(d.nodes,m);var T=u.partials[w(d,u)];T.subs=m.subs,T.partials=m.partials},$:function(d,u){var m={subs:{},code:"",partials:u.partials,prefix:d.n};t.walk(d.nodes,m),u.subs[d.n]=m.code,u.inPartial||(u.code+='t.sub("'+x(d.n)+'",c,p,i);')},"\n":function(d,u){u.code+=k('"\\n"'+(d.last?"":" + i"))},_v:function(d,u){u.code+="t.b(t.v(t."+v(d.n)+'("'+x(d.n)+'",c,p,0)));'},_t:function(d,u){u.code+=k('"'+x(d.text)+'"')},"{":$,"&":$};function $(d,u){u.code+="t.b(t.t(t."+v(d.n)+'("'+x(d.n)+'",c,p,0)));'}function k(d){return"t.b("+d+");"}t.walk=function(d,u){for(var m,T=0,D=d.length;T<D;T++)m=t.codegen[d[T].tag],m&&m(d[T],u);return u},t.parse=function(d,u,m){return m=m||{},c(d,"",[],m.sectionTags||[])},t.cache={},t.cacheKey=function(d,u){return[d,!!u.asString,!!u.disableLambda,u.delimiters,!!u.modelGet].join("||")},t.compile=function(d,u){u=u||{};var m=t.cacheKey(d,u),T=this.cache[m];if(T){var D=T.partials;for(var A in D)delete D[A].instance;return T}return T=this.generate(this.parse(this.scan(d,u.delimiters),d,u),d,u),this.cache[m]=T}})(r)})(ee)),ee}var te={},we;function Ie(){return we||(we=1,(function(r){(function(t){t.Template=function(c,h,g,b){c=c||{},this.r=c.code||this.r,this.c=g,this.options=b||{},this.text=h||"",this.partials=c.partials||{},this.subs=c.subs||{},this.buf=""},t.Template.prototype={r:function(c,h,g){return""},v:C,t:p,render:function(h,g,b){return this.ri([h],g||{},b)},ri:function(c,h,g){return this.r(c,h,g)},ep:function(c,h){var g=this.partials[c],b=h[g.name];if(g.instance&&g.base==b)return g.instance;if(typeof b=="string"){if(!this.c)throw new Error("No compiler available.");b=this.c.compile(b,this.options)}if(!b)return null;if(this.partials[c].base=b,g.subs){h.stackText||(h.stackText={});for(key in g.subs)h.stackText[key]||(h.stackText[key]=this.activeSub!==void 0&&h.stackText[this.activeSub]?h.stackText[this.activeSub]:this.text);b=e(b,g.subs,g.partials,this.stackSubs,this.stackPartials,h.stackText)}return this.partials[c].instance=b,b},rp:function(c,h,g,b){var y=this.ep(c,g);return y?y.ri(h,g,b):""},rs:function(c,h,g){var b=c[c.length-1];if(!E(b)){g(c,h,this);return}for(var y=0;y<b.length;y++)c.push(b[y]),g(c,h,this),c.pop()},s:function(c,h,g,b,y,z,x){var v;return E(c)&&c.length===0?!1:(typeof c=="function"&&(c=this.ms(c,h,g,b,y,z,x)),v=!!c,!b&&v&&h&&h.push(typeof c=="object"?c:h[h.length-1]),v)},d:function(c,h,g,b){var y,z=c.split("."),x=this.f(z[0],h,g,b),v=this.options.modelGet,w=null;if(c==="."&&E(h[h.length-2]))x=h[h.length-1];else for(var $=1;$<z.length;$++)y=n(z[$],x,v),y!==void 0?(w=x,x=y):x="";return b&&!x?!1:(!b&&typeof x=="function"&&(h.push(w),x=this.mv(x,h,g),h.pop()),x)},f:function(c,h,g,b){for(var y=!1,z=null,x=!1,v=this.options.modelGet,w=h.length-1;w>=0;w--)if(z=h[w],y=n(c,z,v),y!==void 0){x=!0;break}return x?(!b&&typeof y=="function"&&(y=this.mv(y,h,g)),y):b?!1:""},ls:function(c,h,g,b,y){var z=this.options.delimiters;return this.options.delimiters=y,this.b(this.ct(p(c.call(h,b)),h,g)),this.options.delimiters=z,!1},ct:function(c,h,g){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(c,this.options).render(h,g)},b:function(c){this.buf+=c},fl:function(){var c=this.buf;return this.buf="",c},ms:function(c,h,g,b,y,z,x){var v,w=h[h.length-1],$=c.call(w);return typeof $=="function"?b?!0:(v=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls($,w,g,v.substring(y,z),x)):$},mv:function(c,h,g){var b=h[h.length-1],y=c.call(b);return typeof y=="function"?this.ct(p(y.call(b)),b,g):y},sub:function(c,h,g,b){var y=this.subs[c];y&&(this.activeSub=c,y(h,g,this,b),this.activeSub=!1)}};function n(c,h,g){var b;return h&&typeof h=="object"&&(h[c]!==void 0?b=h[c]:g&&h.get&&typeof h.get=="function"&&(b=h.get(c))),b}function e(c,h,g,b,y,z){function x(){}x.prototype=c;function v(){}v.prototype=c.subs;var w,$=new x;$.subs=new v,$.subsText={},$.buf="",b=b||{},$.stackSubs=b,$.subsText=z;for(w in h)b[w]||(b[w]=h[w]);for(w in b)$.subs[w]=b[w];y=y||{},$.stackPartials=y;for(w in g)y[w]||(y[w]=g[w]);for(w in y)$.partials[w]=y[w];return $}var s=/&/g,a=/</g,i=/>/g,l=/\'/g,o=/\"/g,f=/[&<>\"\']/;function p(c){return String(c??"")}function C(c){return c=p(c),f.test(c)?c.replace(s,"&amp;").replace(a,"&lt;").replace(i,"&gt;").replace(l,"&#39;").replace(o,"&quot;"):c}var E=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"}})(r)})(te)),te}var ne,Ce;function Je(){if(Ce)return ne;Ce=1;var r=He();return r.Template=Ie().Template,r.template=r.Template,ne=r,ne}var S=Je();new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<li class="d2h-file-list-line">'),e.b(`
`+n),e.b('    <span class="d2h-file-name-wrapper">'),e.b(`
`+n),e.b(e.rp("<fileIcon0",r,t,"      ")),e.b('      <a href="#'),e.b(e.v(e.f("fileHtmlId",r,t,0))),e.b('" class="d2h-file-name">'),e.b(e.v(e.f("fileName",r,t,0))),e.b("</a>"),e.b(`
`+n),e.b('      <span class="d2h-file-stats">'),e.b(`
`+n),e.b('          <span class="d2h-lines-added">'),e.b(e.v(e.f("addedLines",r,t,0))),e.b("</span>"),e.b(`
`+n),e.b('          <span class="d2h-lines-deleted">'),e.b(e.v(e.f("deletedLines",r,t,0))),e.b("</span>"),e.b(`
`+n),e.b("      </span>"),e.b(`
`+n),e.b("    </span>"),e.b(`
`+n),e.b("</li>"),e.fl()},partials:{"<fileIcon0":{name:"fileIcon",partials:{},subs:{}}},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<div class="d2h-file-list-wrapper '),e.b(e.v(e.f("colorScheme",r,t,0))),e.b('">'),e.b(`
`+n),e.b('    <div class="d2h-file-list-header">'),e.b(`
`+n),e.b('        <span class="d2h-file-list-title">Files changed ('),e.b(e.v(e.f("filesNumber",r,t,0))),e.b(")</span>"),e.b(`
`+n),e.b('        <a class="d2h-file-switch d2h-hide">hide</a>'),e.b(`
`+n),e.b('        <a class="d2h-file-switch d2h-show">show</a>'),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b('    <ol class="d2h-file-list">'),e.b(`
`+n),e.b("    "),e.b(e.t(e.f("files",r,t,0))),e.b(`
`+n),e.b("    </ol>"),e.b(`
`+n),e.b("</div>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b("<tr>"),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.f("lineClass",r,t,0))),e.b(" "),e.b(e.v(e.d("CSSLineClass.INFO",r,t,0))),e.b('"></td>'),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.d("CSSLineClass.INFO",r,t,0))),e.b('">'),e.b(`
`+n),e.b('        <div class="'),e.b(e.v(e.f("contentClass",r,t,0))),e.b('">'),e.s(e.f("blockHeader",r,t,1),r,t,0,156,173,"{{ }}")&&(e.rs(r,t,function(s,a,i){i.b(i.t(i.f("blockHeader",s,a,0)))}),r.pop()),e.s(e.f("blockHeader",r,t,1),r,t,1,0,0,"")||e.b("&nbsp;"),e.b("</div>"),e.b(`
`+n),e.b("    </td>"),e.b(`
`+n),e.b("</tr>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b("<tr>"),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.d("CSSLineClass.INFO",r,t,0))),e.b('">'),e.b(`
`+n),e.b('        <div class="'),e.b(e.v(e.f("contentClass",r,t,0))),e.b('">'),e.b(`
`+n),e.b("            File without changes"),e.b(`
`+n),e.b("        </div>"),e.b(`
`+n),e.b("    </td>"),e.b(`
`+n),e.b("</tr>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-file-name-wrapper">'),e.b(`
`+n),e.b(e.rp("<fileIcon0",r,t,"    ")),e.b('    <span class="d2h-file-name">'),e.b(e.v(e.f("fileDiffName",r,t,0))),e.b("</span>"),e.b(`
`+n),e.b(e.rp("<fileTag1",r,t,"    ")),e.b("</span>"),e.b(`
`+n),e.b('<label class="d2h-file-collapse">'),e.b(`
`+n),e.b('    <input class="d2h-file-collapse-input" type="checkbox" name="viewed" value="viewed">'),e.b(`
`+n),e.b("    Viewed"),e.b(`
`+n),e.b("</label>"),e.fl()},partials:{"<fileIcon0":{name:"fileIcon",partials:{},subs:{}},"<fileTag1":{name:"fileTag",partials:{},subs:{}}},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b("<tr>"),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.f("lineClass",r,t,0))),e.b(" "),e.b(e.v(e.f("type",r,t,0))),e.b('">'),e.b(`
`+n),e.b("      "),e.b(e.t(e.f("lineNumber",r,t,0))),e.b(`
`+n),e.b("    </td>"),e.b(`
`+n),e.b('    <td class="'),e.b(e.v(e.f("type",r,t,0))),e.b('">'),e.b(`
`+n),e.b('        <div class="'),e.b(e.v(e.f("contentClass",r,t,0))),e.b('">'),e.b(`
`+n),e.s(e.f("prefix",r,t,1),r,t,0,162,238,"{{ }}")&&(e.rs(r,t,function(s,a,i){i.b('            <span class="d2h-code-line-prefix">'),i.b(i.t(i.f("prefix",s,a,0))),i.b("</span>"),i.b(`
`+n)}),r.pop()),e.s(e.f("prefix",r,t,1),r,t,1,0,0,"")||(e.b('            <span class="d2h-code-line-prefix">&nbsp;</span>'),e.b(`
`+n)),e.s(e.f("content",r,t,1),r,t,0,371,445,"{{ }}")&&(e.rs(r,t,function(s,a,i){i.b('            <span class="d2h-code-line-ctn">'),i.b(i.t(i.f("content",s,a,0))),i.b("</span>"),i.b(`
`+n)}),r.pop()),e.s(e.f("content",r,t,1),r,t,1,0,0,"")||(e.b('            <span class="d2h-code-line-ctn"><br></span>'),e.b(`
`+n)),e.b("        </div>"),e.b(`
`+n),e.b("    </td>"),e.b(`
`+n),e.b("</tr>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<div class="d2h-wrapper '),e.b(e.v(e.f("colorScheme",r,t,0))),e.b('">'),e.b(`
`+n),e.b("    "),e.b(e.t(e.f("content",r,t,0))),e.b(`
`+n),e.b("</div>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-added" height="16" title="added" version="1.1" viewBox="0 0 14 16"'),e.b(`
`+n),e.b('     width="14">'),e.b(`
`+n),e.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM6 9H3V7h3V4h2v3h3v2H8v3H6V9z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-changed" height="16" title="modified" version="1.1"'),e.b(`
`+n),e.b('     viewBox="0 0 14 16" width="14">'),e.b(`
`+n),e.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM4 8c0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3-3-1.34-3-3z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-deleted" height="16" title="removed" version="1.1"'),e.b(`
`+n),e.b('     viewBox="0 0 14 16" width="14">'),e.b(`
`+n),e.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM11 9H3V7h8v2z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-moved" height="16" title="renamed" version="1.1"'),e.b(`
`+n),e.b('     viewBox="0 0 14 16" width="14">'),e.b(`
`+n),e.b('    <path d="M6 9H3V7h3V4l5 4-5 4V9z m8-7v12c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h12c0.55 0 1 0.45 1 1z m-1 0H1v12h12V2z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">'),e.b(`
`+n),e.b('    <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>'),e.b(`
`+n),e.b("</svg>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<div id="'),e.b(e.v(e.f("fileHtmlId",r,t,0))),e.b('" class="d2h-file-wrapper" data-lang="'),e.b(e.v(e.d("file.language",r,t,0))),e.b('">'),e.b(`
`+n),e.b('    <div class="d2h-file-header">'),e.b(`
`+n),e.b("    "),e.b(e.t(e.f("filePath",r,t,0))),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b('    <div class="d2h-file-diff">'),e.b(`
`+n),e.b('        <div class="d2h-code-wrapper">'),e.b(`
`+n),e.b('            <table class="d2h-diff-table">'),e.b(`
`+n),e.b('                <tbody class="d2h-diff-tbody">'),e.b(`
`+n),e.b("                "),e.b(e.t(e.f("diffs",r,t,0))),e.b(`
`+n),e.b("                </tbody>"),e.b(`
`+n),e.b("            </table>"),e.b(`
`+n),e.b("        </div>"),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b("</div>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<div class="line-num1">'),e.b(e.v(e.f("oldNumber",r,t,0))),e.b("</div>"),e.b(`
`+n),e.b('<div class="line-num2">'),e.b(e.v(e.f("newNumber",r,t,0))),e.b("</div>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<div id="'),e.b(e.v(e.f("fileHtmlId",r,t,0))),e.b('" class="d2h-file-wrapper" data-lang="'),e.b(e.v(e.d("file.language",r,t,0))),e.b('">'),e.b(`
`+n),e.b('    <div class="d2h-file-header">'),e.b(`
`+n),e.b("      "),e.b(e.t(e.f("filePath",r,t,0))),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b('    <div class="d2h-files-diff">'),e.b(`
`+n),e.b('        <div class="d2h-file-side-diff">'),e.b(`
`+n),e.b('            <div class="d2h-code-wrapper">'),e.b(`
`+n),e.b('                <table class="d2h-diff-table">'),e.b(`
`+n),e.b('                    <tbody class="d2h-diff-tbody">'),e.b(`
`+n),e.b("                    "),e.b(e.t(e.d("diffs.left",r,t,0))),e.b(`
`+n),e.b("                    </tbody>"),e.b(`
`+n),e.b("                </table>"),e.b(`
`+n),e.b("            </div>"),e.b(`
`+n),e.b("        </div>"),e.b(`
`+n),e.b('        <div class="d2h-file-side-diff">'),e.b(`
`+n),e.b('            <div class="d2h-code-wrapper">'),e.b(`
`+n),e.b('                <table class="d2h-diff-table">'),e.b(`
`+n),e.b('                    <tbody class="d2h-diff-tbody">'),e.b(`
`+n),e.b("                    "),e.b(e.t(e.d("diffs.right",r,t,0))),e.b(`
`+n),e.b("                    </tbody>"),e.b(`
`+n),e.b("                </table>"),e.b(`
`+n),e.b("            </div>"),e.b(`
`+n),e.b("        </div>"),e.b(`
`+n),e.b("    </div>"),e.b(`
`+n),e.b("</div>"),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-tag d2h-added d2h-added-tag">ADDED</span>'),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-tag d2h-changed d2h-changed-tag">CHANGED</span>'),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-tag d2h-deleted d2h-deleted-tag">DELETED</span>'),e.fl()},partials:{},subs:{}});new S.Template({code:function(r,t,n){var e=this;return e.b(n=n||""),e.b('<span class="d2h-tag d2h-moved d2h-moved-tag">RENAMED</span>'),e.fl()},partials:{},subs:{}});Object.assign(Object.assign(Object.assign({},Re),Fe),{outputFormat:Se.LINE_BY_LINE,drawFileList:!0});class U{static normalize(t){return{info:{name:t.info.name,version:t.info.version},items:this.normalizeItems(t.item)}}static normalizeItems(t){return t.map(n=>this.normalizeItem(n))}static normalizeItem(t){const n={id:t.id||this.generateId(t.name),name:t.name};return t.request&&(n.method=t.request.method,n.url=this.normalizeUrl(t.request.url),n.headers=this.normalizeHeaders(t.request.header),n.body=this.normalizeBody(t.request.body)),t.item&&Array.isArray(t.item)&&(n.children=this.normalizeItems(t.item)),t.event&&(n.tests=this.normalizeEvents(t.event)),n}static normalizeUrl(t){return typeof t=="string"?t:t?.raw||""}static normalizeHeaders(t){return t?t.filter(n=>!n.disabled).reduce((n,e)=>(n[e.key]=e.value,n),{}):{}}static normalizeBody(t){if(!t)return"";switch(t.mode){case"raw":return t.raw||"";case"urlencoded":return this.formatUrlEncoded(t.urlencoded);case"formdata":return this.formatFormData(t.formdata);default:return JSON.stringify(t)}}static normalizeEvents(t){return t.filter(n=>n.script?.exec).map(n=>n.script.exec.join(`
`))}static formatUrlEncoded(t){return t?t.filter(n=>!n.disabled).map(n=>`${n.key}=${n.value}`).join("&"):""}static formatFormData(t){return t?t.filter(n=>!n.disabled).map(n=>`${n.key}: ${n.value}`).join(`
`):""}static generateId(t){return t.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")}}class Be{diff(t,n,e={}){let s;typeof e=="function"?(s=e,e={}):"callback"in e&&(s=e.callback);const a=this.castInput(t,e),i=this.castInput(n,e),l=this.removeEmpty(this.tokenize(a,e)),o=this.removeEmpty(this.tokenize(i,e));return this.diffWithOptionsObj(l,o,e,s)}diffWithOptionsObj(t,n,e,s){var a;const i=z=>{if(z=this.postProcess(z,e),s){setTimeout(function(){s(z)},0);return}else return z},l=n.length,o=t.length;let f=1,p=l+o;e.maxEditLength!=null&&(p=Math.min(p,e.maxEditLength));const C=(a=e.timeout)!==null&&a!==void 0?a:1/0,E=Date.now()+C,c=[{oldPos:-1,lastComponent:void 0}];let h=this.extractCommon(c[0],n,t,0,e);if(c[0].oldPos+1>=o&&h+1>=l)return i(this.buildValues(c[0].lastComponent,n,t));let g=-1/0,b=1/0;const y=()=>{for(let z=Math.max(g,-f);z<=Math.min(b,f);z+=2){let x;const v=c[z-1],w=c[z+1];v&&(c[z-1]=void 0);let $=!1;if(w){const d=w.oldPos-z;$=w&&0<=d&&d<l}const k=v&&v.oldPos+1<o;if(!$&&!k){c[z]=void 0;continue}if(!k||$&&v.oldPos<w.oldPos?x=this.addToPath(w,!0,!1,0,e):x=this.addToPath(v,!1,!0,1,e),h=this.extractCommon(x,n,t,z,e),x.oldPos+1>=o&&h+1>=l)return i(this.buildValues(x.lastComponent,n,t))||!0;c[z]=x,x.oldPos+1>=o&&(b=Math.min(b,z-1)),h+1>=l&&(g=Math.max(g,z+1))}f++};if(s)(function z(){setTimeout(function(){if(f>p||Date.now()>E)return s(void 0);y()||z()},0)})();else for(;f<=p&&Date.now()<=E;){const z=y();if(z)return z}}addToPath(t,n,e,s,a){const i=t.lastComponent;return i&&!a.oneChangePerToken&&i.added===n&&i.removed===e?{oldPos:t.oldPos+s,lastComponent:{count:i.count+1,added:n,removed:e,previousComponent:i.previousComponent}}:{oldPos:t.oldPos+s,lastComponent:{count:1,added:n,removed:e,previousComponent:i}}}extractCommon(t,n,e,s,a){const i=n.length,l=e.length;let o=t.oldPos,f=o-s,p=0;for(;f+1<i&&o+1<l&&this.equals(e[o+1],n[f+1],a);)f++,o++,p++,a.oneChangePerToken&&(t.lastComponent={count:1,previousComponent:t.lastComponent,added:!1,removed:!1});return p&&!a.oneChangePerToken&&(t.lastComponent={count:p,previousComponent:t.lastComponent,added:!1,removed:!1}),t.oldPos=o,f}equals(t,n,e){return e.comparator?e.comparator(t,n):t===n||!!e.ignoreCase&&t.toLowerCase()===n.toLowerCase()}removeEmpty(t){const n=[];for(let e=0;e<t.length;e++)t[e]&&n.push(t[e]);return n}castInput(t,n){return t}tokenize(t,n){return Array.from(t)}join(t){return t.join("")}postProcess(t,n){return t}get useLongestToken(){return!1}buildValues(t,n,e){const s=[];let a;for(;t;)s.push(t),a=t.previousComponent,delete t.previousComponent,t=a;s.reverse();const i=s.length;let l=0,o=0,f=0;for(;l<i;l++){const p=s[l];if(p.removed)p.value=this.join(e.slice(f,f+p.count)),f+=p.count;else{if(!p.added&&this.useLongestToken){let C=n.slice(o,o+p.count);C=C.map(function(E,c){const h=e[f+c];return h.length>E.length?h:E}),p.value=this.join(C)}else p.value=this.join(n.slice(o,o+p.count));o+=p.count,p.added||(f+=p.count)}}return s}}class Ve extends Be{constructor(){super(...arguments),this.tokenize=Ge}equals(t,n,e){return e.ignoreWhitespace?((!e.newlineIsToken||!t.includes(`
`))&&(t=t.trim()),(!e.newlineIsToken||!n.includes(`
`))&&(n=n.trim())):e.ignoreNewlineAtEof&&!e.newlineIsToken&&(t.endsWith(`
`)&&(t=t.slice(0,-1)),n.endsWith(`
`)&&(n=n.slice(0,-1))),super.equals(t,n,e)}}const je=new Ve;function Ee(r,t,n){return je.diff(r,t,n)}function Ge(r,t){t.stripTrailingCr&&(r=r.replace(/\r\n/g,`
`));const n=[],e=r.split(/(\n|\r\n)/);e[e.length-1]||e.pop();for(let s=0;s<e.length;s++){const a=e[s];s%2&&!t.newlineIsToken?n[n.length-1]+=a:n.push(a)}return n}class Ue{constructor(){}diff(t,n){const e=U.normalize(t),s=U.normalize(n),a=this.createItemDiffs(e,s),i=this.generateItemBasedHtml(a),l=[];return a.forEach(o=>{o.type==="added"?l.push({added:!0,removed:!1,value:o.item.name,count:1}):o.type==="removed"?l.push({added:!1,removed:!0,value:o.item.name,count:1}):o.type==="modified"&&l.push({added:!1,removed:!1,value:o.item.name,count:1})}),{oldCollection:JSON.stringify({name:e.info.name,itemCount:e.items?.length||0}),newCollection:JSON.stringify({name:s.info.name,itemCount:s.items?.length||0}),patches:l,htmlDiff:i}}createItemDiffs(t,n){const e=[],s=this.flattenItems(t.items||[]),a=this.flattenItems(n.items||[]),i=new Map(s.map(o=>[o.id,o])),l=new Map(a.map(o=>[o.id,o]));return i.forEach((o,f)=>{l.has(f)||e.push({type:"removed",item:o})}),l.forEach((o,f)=>{if(!i.has(f))e.push({type:"added",item:o});else{const p=i.get(f);this.hasItemChanged(p,o)&&e.push({type:"modified",item:o,oldItem:p,changes:this.getItemChanges(p,o)})}}),e}flattenItems(t,n=[],e=""){return t.forEach(s=>{const a=e?`${e}/${s.name}`:s.name,i={...s,path:a,parentPath:e};n.push(i),s.children&&this.flattenItems(s.children,n,a)}),n}hasItemChanged(t,n){return t.method!==n.method||t.url!==n.url||t.body!==n.body||JSON.stringify(t.headers)!==JSON.stringify(n.headers)||JSON.stringify(t.tests)!==JSON.stringify(n.tests)}getItemChanges(t,n){const e=[];return t.method!==n.method&&e.push(`Method: ${t.method} ‚Üí ${n.method}`),t.url!==n.url&&e.push(`URL: ${t.url} ‚Üí ${n.url}`),t.body!==n.body&&e.push("Body modified"),JSON.stringify(t.headers)!==JSON.stringify(n.headers)&&e.push("Headers modified"),JSON.stringify(t.tests)!==JSON.stringify(n.tests)&&e.push("Tests modified"),e}generateItemBasedHtml(t){let n='<div class="d2h-wrapper">';const e=t.filter(i=>i.type==="added"),s=t.filter(i=>i.type==="removed"),a=t.filter(i=>i.type==="modified");return s.length>0&&(n+=this.createSection("Removed Endpoints",s,"removed","removed-section")),e.length>0&&(n+=this.createSection("Added Endpoints",e,"added","added-section")),a.length>0&&(n+='<div class="d2h-file-wrapper" id="modified-section">',n+='<div class="d2h-file-header">',n+='<span class="d2h-file-name">Modified Endpoints</span>',n+="</div>",a.forEach(i=>{n+=`<div class="d2h-file-diff" id="modified-${i.item.id}">`,n+='<div class="modified-endpoint-header">',i.item.parentPath&&(n+=`<span class="path-hierarchy">${this.escapeHtml(i.item.parentPath)} ‚Ä∫ </span>`),n+=`<strong>${this.escapeHtml(i.item.name)}</strong>`,i.item.method&&i.item.url&&(n+=` <span class="endpoint-info">[${i.item.method} ${this.escapeHtml(i.item.url)}]</span>`);const l=this.getChangeTypes(i.oldItem,i.item);l.length>0&&(n+=` <span class="change-summary">(${l.join(", ")})</span>`),n+="</div>",i.oldItem&&i.item&&(n+=this.generateDetailedChanges(i.oldItem,i.item)),n+="</div>"}),n+="</div>"),n+="</div>",n}createSection(t,n,e,s){let a=`<div class="d2h-file-wrapper" id="${s}">`;return a+='<div class="d2h-file-header">',a+=`<span class="d2h-file-name">${t}</span>`,a+="</div>",a+='<div class="d2h-file-diff">',a+='<table class="d2h-diff-table">',a+='<tbody class="d2h-diff-tbody">',n.forEach(i=>{const l=e==="added"?"d2h-ins":"d2h-del",o=e==="added"?"+":"-",f=e==="added"?`added-${i.item.id}`:`removed-${i.item.id}`;this.getItemPath(i.item),a+=`<tr id="${f}">`,a+=`<td class="d2h-code-linenumber ${l}">${o}</td>`,a+=`<td class="${l}"><div class="d2h-code-line">`,i.item.parentPath&&(a+=`${this.escapeHtml(i.item.parentPath)} ‚Ä∫ `),a+=`<strong>${this.escapeHtml(i.item.name)}</strong>`,i.item.method&&i.item.url?a+=` <span style="opacity: 0.7;">[${i.item.method} ${this.escapeHtml(i.item.url)}]</span>`:i.item.children&&(a+=" üìÅ"),a+="</div></td>",a+="</tr>"}),a+="</tbody></table></div></div>",a}getItemPath(t){return t.path||t.name||"Unnamed"}getChangeTypes(t,n){const e=[];return t.url!==n.url&&e.push("URL"),t.method!==n.method&&e.push("Method"),JSON.stringify(t.headers)!==JSON.stringify(n.headers)&&e.push("Headers"),t.body!==n.body&&e.push("Body"),t.prerequest!==n.prerequest&&e.push("Pre-request"),t.tests!==n.tests&&e.push("Tests"),e}generateDetailedChanges(t,n){let e='<table class="d2h-diff-table"><tbody class="d2h-diff-tbody">';return t.url!==n.url&&(e+=this.createDiffRow("URL",t.url,n.url)),t.method!==n.method&&(e+=this.createDiffRow("Method",t.method,n.method)),JSON.stringify(t.headers)!==JSON.stringify(n.headers)&&(e+=this.createHeadersDiff(t.headers,n.headers)),t.body!==n.body&&(e+=this.createBodyDiff(t.body,n.body)),t.prerequest!==n.prerequest&&(e+=this.createScriptDiff("Pre-request Script",t.prerequest,n.prerequest)),t.tests!==n.tests&&(e+=this.createScriptDiff("Test Script",t.tests,n.tests)),e+="</tbody></table>",e}createDiffRow(t,n,e){let s="";return n&&e?(s+="<tr>",s+='<td class="d2h-code-linenumber d2h-del">-</td>',s+=`<td class="d2h-del"><div class="d2h-code-line">- ${t}: ${n}</div></td>`,s+="</tr>",s+="<tr>",s+='<td class="d2h-code-linenumber d2h-ins">+</td>',s+=`<td class="d2h-ins"><div class="d2h-code-line">+ ${t}: ${e}</div></td>`,s+="</tr>"):n?(s+="<tr>",s+='<td class="d2h-code-linenumber d2h-del">-</td>',s+=`<td class="d2h-del"><div class="d2h-code-line">- ${t}: ${n}</div></td>`,s+="</tr>"):e&&(s+="<tr>",s+='<td class="d2h-code-linenumber d2h-ins">+</td>',s+=`<td class="d2h-ins"><div class="d2h-code-line">+ ${t}: ${e}</div></td>`,s+="</tr>"),s}createHeadersDiff(t,n){let e="";const s=t||{},a=n||{};return new Set([...Object.keys(s),...Object.keys(a)]).forEach(l=>{s[l]!==a[l]&&(e+=this.createDiffRow(`Header[${l}]`,s[l],a[l]))}),e}createBodyDiff(t,n){if(!t&&!n)return"";let e='<tr><td colspan="2" style="background: #f8f8f8; padding: 4px; font-weight: bold;">Request Body:</td></tr>',s=t,a=n;try{t&&(s=JSON.stringify(JSON.parse(t),null,2))}catch{}try{n&&(a=JSON.stringify(JSON.parse(n),null,2))}catch{}const i=Ee(s||"",a||"");return e+=this.renderDiffWithContext(i,3),e}createScriptDiff(t,n,e){if(!n&&!e)return"";let s=`<tr><td colspan="2" style="background: #f8f8f8; padding: 4px; font-weight: bold;">${t}:</td></tr>`;const a=Array.isArray(n)?n.join(`
`):n||"",i=Array.isArray(e)?e.join(`
`):e||"",l=Ee(a,i);return s+=this.renderDiffWithContext(l,3),s}renderDiffWithContext(t,n=3){let e="",s=1,a=1;return t.forEach(i=>{if(!i.added&&!i.removed){const l=i.value.split(`
`).filter(o=>o!=="");if(l.length>n*2){for(let f=0;f<n;f++)l[f]&&(e+="<tr>",e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">${s++}</td>`,e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">${a++}</td>`,e+=`<td><div class="d2h-code-line">${this.highlightCode(l[f])}</div></td>`,e+="</tr>");const o=l.length-n*2;if(o>0){e+='<tr class="d2h-context-control">',e+='<td class="d2h-code-linenumber" style="text-align: center;">...</td>',e+='<td class="d2h-code-linenumber" style="text-align: center;">...</td>',e+=`<td><div class="d2h-code-line" style="color: #999; cursor: pointer;" onclick="this.parentElement.parentElement.classList.toggle('expanded')">`,e+=`‚Üï ${o} unchanged lines hidden (click to expand)`,e+="</div></td>",e+="</tr>",e+='<tr class="d2h-context-hidden" style="display: none;">',e+='<td colspan="3"><div style="max-height: 200px; overflow-y: auto;">';for(let f=n;f<l.length-n;f++)l[f]&&(e+=`<div class="d2h-code-line"><span style="color: #999; margin-right: 10px;">${s++}</span>${this.highlightCode(l[f])}</div>`,a++);e+="</div></td></tr>"}for(let f=Math.max(0,l.length-n);f<l.length;f++)l[f]&&(e+="<tr>",e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">${s++}</td>`,e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">${a++}</td>`,e+=`<td><div class="d2h-code-line">${this.highlightCode(l[f])}</div></td>`,e+="</tr>")}else l.forEach(o=>{o&&(e+="<tr>",e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">${s++}</td>`,e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">${a++}</td>`,e+=`<td><div class="d2h-code-line">${this.highlightCode(o)}</div></td>`,e+="</tr>")})}else i.removed?i.value.split(`
`).filter(o=>o!=="").forEach(o=>{e+='<tr class="d2h-del">',e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right;">${s++}</td>`,e+='<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">-</td>',e+=`<td><div class="d2h-code-line">${this.highlightCode(o)}</div></td>`,e+="</tr>"}):i.added&&i.value.split(`
`).filter(o=>o!=="").forEach(o=>{e+='<tr class="d2h-ins">',e+='<td class="d2h-code-linenumber" style="width: 40px; text-align: right; color: #999;">-</td>',e+=`<td class="d2h-code-linenumber" style="width: 40px; text-align: right;">${a++}</td>`,e+=`<td><div class="d2h-code-line">${this.highlightCode(o)}</div></td>`,e+="</tr>"})}),e}highlightCode(t){return this.escapeHtml(t)}escapeHtml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}getChangeSummary(t){let n=0,e=0,s=0;return t.forEach(a=>{a.added?n++:a.removed?e++:s++}),{added:n,removed:e,modified:s}}}class _e{state={};components={};differ={};constructor(){this.initializeState(),this.initializeComponents(),this.setupEventHandlers(),console.log("Postman Diff App initialized")}initializeState(){this.state={oldCollection:null,newCollection:null,normalizedOld:null,normalizedNew:null,diffResult:null,diffOptions:{ignoreOrder:!1,ignoreWhitespace:!0,normalizeJson:!0,sortKeys:!0},isProcessing:!1,error:null}}initializeComponents(){try{this.createFileInputContainer(),this.components={oldFileInput:new fe("old-file-input","Old Collection"),newFileInput:new fe("new-file-input","New Collection"),diffViewer:new $e("diff-container"),treeView:new Ne("tree-view-container",{onNodeSelect:t=>this.handleNodeSelection(t),onNodeToggle:t=>this.handleNodeToggle(t)}),exportControls:new Le("export-controls-container",{onExport:(t,n)=>this.handleExport(t,n),onImportFromPr:async(t,n)=>{try{this.setProcessing(!0),this.clearError(),t?(this.state.oldCollection=t,this.state.normalizedOld=U.normalize(t)):(this.state.oldCollection=null,this.state.normalizedOld=null),n?(this.state.newCollection=n,this.state.normalizedNew=U.normalize(n)):(this.state.newCollection=null,this.state.normalizedNew=null),await this.tryGenerateDiff()}finally{this.setProcessing(!1)}}})},this.differ=new Ue,console.log("All components initialized successfully")}catch(t){this.handleError("Failed to initialize components: "+t.message)}}createFileInputContainer(){const t=document.getElementById("file-inputs-container");t&&(t.innerHTML=`
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 min-w-0 lg:min-w-[500px]">
          <div id="old-file-input"></div>
          <div id="new-file-input"></div>
        </div>
      `)}setupEventHandlers(){this.components.oldFileInput.onLoad(t=>{this.handleFileLoad("old",t)}),this.components.newFileInput.onLoad(t=>{this.handleFileLoad("new",t)})}async handleFileLoad(t,n){try{this.setProcessing(!0),this.clearError(),t==="old"?this.state.oldCollection=n:this.state.newCollection=n;const e=U.normalize(n);t==="old"?this.state.normalizedOld=e:this.state.normalizedNew=e,this.components.treeView.loadCollection(e,t),await this.tryGenerateDiff()}catch(e){this.handleError(`Failed to load ${t} collection: `+e.message)}finally{this.setProcessing(!1)}}handleNodeSelection(t){console.log("Node selected:",t)}handleNodeToggle(t){console.log("Node toggled:",t)}handleExport(t,n){console.log(`Exporting as ${t}:`,n)}async tryGenerateDiff(){if(!(!this.state.oldCollection||!this.state.newCollection))try{this.setProcessing(!0),this.clearError();const t=this.differ.diff(this.state.oldCollection,this.state.newCollection);this.state.diffResult=t,this.components.diffViewer.showDiff(t),this.state.normalizedOld&&this.state.normalizedNew&&this.components.treeView.updateWithDiff(this.state.normalizedOld,this.state.normalizedNew),this.components.exportControls.updateData({oldCollection:this.state.normalizedOld||void 0,newCollection:this.state.normalizedNew||void 0,diffResult:t,options:this.state.diffOptions}),console.log("Diff generated successfully")}catch(t){this.handleError("Failed to generate diff: "+t.message)}finally{this.setProcessing(!1)}}setProcessing(t){this.state.isProcessing=t;const n=document.getElementById("loading-indicator");n&&(t?n.classList.remove("hidden"):n.classList.add("hidden")),this.components.exportControls.setEnabled(!t)}handleError(t){this.state.error=t,console.error("App Error:",t),this.showErrorMessage(t)}clearError(){this.state.error=null,this.hideErrorMessage()}showErrorMessage(t){let n=document.getElementById("error-message");if(!n){n=document.createElement("div"),n.id="error-message",n.className="error-message";const e=document.querySelector(".right-panel .panel-content");e&&e.insertBefore(n,e.firstChild)}n.innerHTML=`
      <div class="error-content">
        <span class="error-icon">‚ö†Ô∏è</span>
        <span class="error-text">${t}</span>
        <button class="error-close" onclick="this.parentElement.parentElement.style.display='none'">√ó</button>
      </div>
    `,n.style.display="block"}hideErrorMessage(){const t=document.getElementById("error-message");t&&(t.style.display="none")}getState(){return{...this.state}}reset(){this.initializeState(),this.components.diffViewer.clear(),this.components.treeView.clear(),this.components.exportControls.updateData({}),this.clearError(),this.setProcessing(!1)}}const We=new _e;window.postmanDiffApp=We;
